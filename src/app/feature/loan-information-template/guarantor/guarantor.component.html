<div class="col-md-12">
    <div class="d-flex justify-content-end">
        <nb-radio-group [(ngModel)]="calendarType" class="d-inline-flex"
                        name="guarantorCalendarType">
            <nb-radio value="AD">AD</nb-radio>
            <nb-radio value="BS">BS</nb-radio>
        </nb-radio-group>
    </div>
</div>
<nb-card>
    <nb-card-header><h1>  {{customerInfo?.customerType === 'INSTITUTION'?'SHAREHOLDER/GUARANTOR':'GUARANTOR'}} Details</h1></nb-card-header>
    <nb-card-body>
        <div class="form-group" [nbSpinner]="spinner">
            <form [formGroup]="form" class="form-horizontal">
                <!--START ROW-->
                <div formArrayName="guarantorDetails">
                    <div
                        *ngFor="let guarantorDetails of form.get('guarantorDetails')['controls']; let i = index">
                        <div [formGroupName]="i">
                            <div class="row">
                                <div class="col-md-10">
                                    <h5>{{i + 1}})   {{customerInfo?.customerType === 'INSTITUTION'?'SHAREHOLDER/GUARANTOR':'GUARANTOR'}} Information</h5>
                                </div>
                                <div *ngIf="form.get('guarantorDetails')['length']>1" class="col-md-2 ">
                                    <button (click)="removeGuarantorDetails(i)"
                                            class="float-right btn tbn-sm btn-flat btn-danger"
                                            value="Delete">
                                        <em class="fa fa-trash" style="color: white;"></em>

                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
<!--                                    <nb-checkbox formControlName="consentOfLegalHeirs" (change)="legalChange($event?.target?.checked, i)">Consent of Legal Heirs</nb-checkbox>-->
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class = "form-group">
                                        <label for="name"><strong>Type</strong></label>
                                        <select
                                                class="form-control" formControlName="guarantorType"
                                                name="guarantorType">
                                            <option [value]="null">Select type</option>
                                            <option *ngFor="let designations of designation"
                                                    [ngValue]="designations.id">{{designations.name}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong> Name</strong></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('name').errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="name"
                                               id="name"
                                               name="name"
                                               placeholder="Name of Guarantor"
                                               type="text">
                                        <div *ngIf="(submitted) && guarantorDetails.get('name').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('name').errors.required">Name is
                                                required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('name').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('name').errors.required">
                                                Please fill name
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <ng-container *ngIf="guarantorDetails?.get('consentOfLegalHeirs').value; else nonIlegal">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Legal Status</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails?.get('legalStatus')?.errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="legalStatus"
                                                   id="legalStatus"
                                                   name="legalStatus"
                                                   placeholder="Legal Status"
                                                   type="text">
                                            <div *ngIf="(submitted) && guarantorDetails?.get('legalStatus')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('legalStatus')?.errors?.required">
                                                    Legal Status is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('legalStatus')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('legalStatus')?.errors?.required">
                                                    Please fill Legal Status
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Registration Number</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails?.get('registrationNumber')?.errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="registrationNumber"
                                                   id="registrationNumber"
                                                   name="registrationNumber"
                                                   placeholder="Registration Number"
                                                   type="text">
                                            <div *ngIf="(submitted) && guarantorDetails?.get('registrationNumber')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('registrationNumber')?.errors?.required">
                                                    Registration Number is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('registrationNumber')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('registrationNumber')?.errors?.required">
                                                    Please fill Registration Number
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Registration Date</strong></label>
                                            <input [nbDatepicker]="registrationDate"
                                                   *ngIf="calendarType === 'AD'"
                                                   [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('registrationDate').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="registrationDate"
                                                   id="registrationDate"
                                                   name="registrationDate"
                                                   placeholder="Registration Date"
                                                   type="text">
                                            <app-calendar
                                                    [ePreDate]="form.get(['guarantorDetails', i, 'registrationDate']).value"
                                                    *ngIf="calendarType === 'BS'"
                                                    (messageToEmit)="form.get(['guarantorDetails', i, 'issuedYear']).patchValue($event?.eDate)"></app-calendar>

                                            <nb-datepicker #registrationDate></nb-datepicker>
                                            <div *ngIf="(submitted) && guarantorDetails.get('registrationDate').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('registrationDate').errors.required">
                                                    Registration Date is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('registrationDate').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('registrationDate').errors.required">
                                                    Please fill Registration Date
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Registration With</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails?.get('registrationWith')?.errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="registrationWith"
                                                   id="registrationWith"
                                                   name="registrationWith"
                                                   placeholder="Registration With"
                                                   type="text">
                                            <div *ngIf="(submitted) && guarantorDetails?.get('registrationWith')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('registrationWith')?.errors?.required">
                                                    Registration With is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('registrationWith')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('registrationWith')?.errors?.required">
                                                    Please fill Registration With
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Group Name <em class="sb-medium">(if any)</em></strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails?.get('groupName')?.errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="groupName"
                                                   id="groupName"
                                                   name="groupName"
                                                   placeholder="Group Name"
                                                   type="text">
                                            <div *ngIf="(submitted) && guarantorDetails?.get('groupName')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('groupName')?.errors?.required">
                                                    Group Name is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('groupName')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('groupName')?.errors?.required">
                                                    Please fill Group Name
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                                <ng-template #nonIlegal>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Gender</strong></label>
                                            <nb-radio-group class="d-flex" formControlName="gender" name="gender{{i}}">
                                                <nb-radio *ngFor="let gender of genderPairs"
                                                          [value]="gender?.key">{{gender?.value}}</nb-radio>
                                            </nb-radio-group>
                                            <div *ngIf="(submitted) && guarantorDetails?.get('gender')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('gender')?.errors?.required">
                                                    Gender is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('gender')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('gender')?.errors?.required">
                                                    Please select gender
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Citizenship Number</strong></label>
                                            <input (change)="checkBlackListByCitizenshipNo(guarantorDetails.get('citizenNumber').value, i)"
                                                   [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('citizenNumber').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="citizenNumber"
                                                   id="citizenNumber"
                                                   name="citizenNumber"
                                                   placeholder="Number"
                                                   type="text">
                                            <div *ngIf="(submitted) && guarantorDetails.get('citizenNumber').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('citizenNumber').errors.required">
                                                    Citizenship Number is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('citizenNumber').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('citizenNumber').errors.required">
                                                    Please add Citizenship Number
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Citizenship Issued Date</strong></label>
                                            <input [nbDatepicker]="issuedYear"
                                                   *ngIf="calendarType === 'AD'"
                                                   [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('issuedYear').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="issuedYear"
                                                   id="citizenIssuedYear"
                                                   name="citizenIssuedYear"
                                                   placeholder="Citizenship Issued Date"
                                                   type="text">
                                            <app-calendar
                                                    [ePreDate]="form.get(['guarantorDetails', i, 'issuedYear']).value"
                                                    *ngIf="calendarType === 'BS'"
                                                    (messageToEmit)="form.get(['guarantorDetails', i, 'issuedYear']).patchValue($event?.eDate)"></app-calendar>

                                            <nb-datepicker #issuedYear></nb-datepicker>
                                            <div *ngIf="(submitted) && guarantorDetails.get('issuedYear').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('issuedYear').errors.required">
                                                    Citizenship issued Date is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('issuedYear').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('issuedYear').errors.required">
                                                    Please fill Citizenship issued Date
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Citizenship Issued District</strong></label>
                                            <select [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('issuedPlace').errors }"
                                                    class="custom-select"
                                                    formControlName="issuedPlace">
                                                <option [value]="null">--Select Citizenship Issued District-- </option>
                                                <option *ngFor="let district of allDistrict" [value]="district?.name">
                                                    {{district?.name}}
                                                </option>
                                            </select>
                                            <div *ngIf="(submitted) && guarantorDetails.get('issuedPlace').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('issuedPlace').errors.required">
                                                    Citizenship issued Place is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('issuedPlace').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('issuedPlace').errors.required">
                                                    Please add Citizenship issued Place
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Passport Number</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails?.get('passNumber')?.errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="passNumber"
                                                   name="passNUmber"
                                                   placeholder="Passport Number"
                                                   type="text">
                                            <div *ngIf="(submitted) && guarantorDetails?.get('passNumber')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('passNumber').errors?.required">
                                                    Passport Number is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('passNumber')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('passNumber')?.errors?.required">
                                                    Please add Citizenship Number
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Passport Issued Date</strong></label>
                                            <input [nbDatepicker]="passIssueDate"
                                                   *ngIf="calendarType === 'AD'"
                                                   [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.get('passIssueDate')?.errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="passIssueDate"
                                                   name="passIssueDate"
                                                   placeholder="Passport Issued Date"
                                                   type="text">
                                            <app-calendar
                                                    [ePreDate]="form?.get(['guarantorDetails', i, 'passIssueDate'])?.value"
                                                    *ngIf="calendarType === 'BS'"
                                                    (messageToEmit)="form?.get(['guarantorDetails', i, 'passIssueDate'])?.patchValue($event?.eDate)"></app-calendar>

                                            <nb-datepicker #passIssueDate></nb-datepicker>
                                            <div *ngIf="(submitted) && guarantorDetails.get('passIssueDate').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('passIssueDate')?.errors?.required">
                                                    Passport issued Date is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('passIssueDate')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('passIssueDate')?.errors?.required">
                                                    Please fill passport issued Date
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Passport Issued District</strong></label>
                                            <select [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.get('passIssuedPlace')?.errors }"
                                                    class="custom-select"
                                                    formControlName="passIssuedPlace">
                                                <option [value]="null">--Select Passport Issued District-- </option>
                                                <option *ngFor="let district of allDistrict" [value]="district?.name">
                                                    {{district?.name}}
                                                </option>
                                            </select>
                                            <div *ngIf="(submitted) && guarantorDetails?.get('passIssuedPlace')?.invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails?.get('passIssuedPlace')?.errors?.required">
                                                    Passport issued Place is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails?.get('passIssuedPlace')?.invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails?.get('passIssuedPlace')?.errors?.required">
                                                    Please add passport issued Place
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Date Of Birth</strong></label>
                                            <input [nbDatepicker]="dob"
                                                   *ngIf="calendarType === 'AD'"
                                                   [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('dateOfBirth').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="dateOfBirth"
                                                   id="dateOfBirth"
                                                   name="dateOfBirth"
                                                   placeholder="Date of Birth"
                                                   type="text">
                                            <app-calendar
                                                    [ePreDate]="form.get(['guarantorDetails', i, 'dateOfBirth']).value"
                                                    *ngIf="calendarType === 'BS'"
                                                    (messageToEmit)="form.get(['guarantorDetails', i, 'dateOfBirth']).patchValue($event?.eDate)"></app-calendar>

                                            <nb-datepicker #dob></nb-datepicker>
                                            <div *ngIf="(submitted) && guarantorDetails.get('dateOfBirth').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('dateOfBirth').errors.required">
                                                    Date of birth is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('dateOfBirth').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('dateOfBirth').errors.required">
                                                    Please fill  Date of birth
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Father's Name</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('fatherName').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="fatherName"
                                                   id="fatherName"
                                                   name="fatherName"
                                                   placeholder="Father's Name"
                                                   type="text"/>
                                            <div *ngIf="(submitted) && guarantorDetails.get('fatherName').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('fatherName').errors.required">
                                                    Father's name is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('fatherName').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('fatherName').errors.required">
                                                    Please fill Guarantors Father's name
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong> Grandfather Name</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('grandFatherName').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="grandFatherName"
                                                   id="grandFatherName"
                                                   name="grandFatherName"
                                                   placeholder="Grandfather's Name"
                                                   type="text"/>
                                            <div *ngIf="(submitted) && guarantorDetails.get('grandFatherName').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('grandFatherName').errors.required">
                                                    Guarantors Grandfathers name is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('grandFatherName').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('grandFatherName').errors.required">
                                                    Please fill Guarantors Grandfathers name
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong> Mother's Name</strong></label>
                                            <input class="form-control form-control-sm-error rounded"
                                                   formControlName="motherName"
                                                   id="motherName"
                                                   name="motherName"
                                                   placeholder="Mother's Name"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong> Spouse's Name</strong></label>
                                            <input class="form-control form-control-sm-error rounded"
                                                   formControlName="spouseName"
                                                   id="spouseName"
                                                   name="spouseName"
                                                   placeholder="Spouse's Name"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong> Father-in-Law's Name </strong></label>
                                            <input
                                                    class="form-control form-control-sm-error rounded"
                                                    formControlName="fatherInLaw"
                                                    id="fatherInLaw"
                                                    name="fatherInLaw"
                                                    placeholder="Father-in-Law's Name "
                                                    type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Nationality</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('nationality').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="nationality"
                                                   id="nationality"
                                                   name="nationality{{i}}"
                                                   placeholder="Nationality"
                                                   type="text"/>
                                            <div *ngIf="(submitted) && guarantorDetails.get('nationality').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('nationality').errors.required">
                                                    Nationality is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('nationality').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('nationality').errors.required">
                                                    Please fill Nationality
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4" *ngIf="customerInfo?.customerType === 'INSTITUTION'">
                                        <div class="form-group">
                                            <label><strong>Member of Management Team</strong></label>
                                            <select class="form-control form-control-sm-error rounded"
                                                    formControlName="managementTeam"
                                                    id="managementTeam"
                                                    name="managementTeam">
                                                <option [value]="null">Select Yes/No</option>
                                                <option [value]="ans" *ngFor="let ans of question">{{ans}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4" *ngIf="guarantorDetails?.get('managementTeam').value === 'Yes'">
                                        <div class="form-group">
                                            <label><strong>Designation Management Team</strong></label>
                                            <select class="form-control form-control-sm-error rounded"
                                                    formControlName="managementDesignation"
                                                    id="managementDesignation"
                                                    name="managementDesignation">
                                                <option [value]="null">Select Designation</option>
                                                <option [value]="designation?.roleName" *ngFor="let designation of designationList">{{designation?.roleName}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4" *ngIf="customerInfo?.customerType === 'INSTITUTION'">
                                        <div class="form-group">
                                            <label><strong>Member of Board Director</strong></label>
                                            <select class="form-control form-control-sm-error rounded"
                                                    formControlName="boardDirector"
                                                    id="boardDirector"
                                                    name="boardDirector">
                                                <option [value]="null">Select Yes/No</option>
                                                <option [value]="ans" *ngFor="let ans of question">{{ans}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <ng-container *ngIf="guarantorDetails?.get('boardDirector').value === 'Yes'">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label><strong>No. of BOD Member</strong></label>
                                                <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('bodNumber').errors }"
                                                       class="form-control form-control-sm-error rounded"
                                                       formControlName="bodNumber"
                                                       id="bodNumber"
                                                       name="bodNumber"
                                                       placeholder="No. of BOD Member"
                                                       type="number"/>
                                                <div *ngIf="(submitted) && guarantorDetails.get('bodNumber').invalid"
                                                     class="invalid-feedback">
                                                    <div *ngIf="guarantorDetails.get('bodNumber').errors.required">
                                                        No. of BOD Member is required
                                                    </div>
                                                </div>
                                                <div *ngIf="(addMore) && guarantorDetails.get('bodNumber').invalid"
                                                     class="alert-warning">
                                                    <div *ngIf="guarantorDetails.get('bodNumber').errors.required">
                                                        Please fill No. of BOD Member
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label><strong>No. of Female Directors</strong></label>
                                                <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('bodFemaleDirector').errors }"
                                                       class="form-control form-control-sm-error rounded"
                                                       formControlName="bodFemaleDirector"
                                                       id="bodFemaleDirector"
                                                       name="bodFemaleDirector"
                                                       placeholder="No. of Female Directors"
                                                       type="number"/>
                                                <div *ngIf="(submitted) && guarantorDetails.get('bodFemaleDirector').invalid"
                                                     class="invalid-feedback">
                                                    <div *ngIf="guarantorDetails.get('bodFemaleDirector').errors.required">
                                                        No. of Female Directors is required
                                                    </div>
                                                </div>
                                                <div *ngIf="(addMore) && guarantorDetails.get('bodFemaleDirector').invalid"
                                                     class="alert-warning">
                                                    <div *ngIf="guarantorDetails.get('bodFemaleDirector').errors.required">
                                                        Please fill No. of Female Directors
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label><strong>No. of Directors from marginalized community group</strong></label>
                                                <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.get('marginalisedDirector')?.errors }"
                                                       class="form-control form-control-sm-error rounded"
                                                       formControlName="marginalisedDirector"
                                                       id="marginalisedDirector"
                                                       name="marginalisedDirector"
                                                       placeholder="Directors from marginalized community"
                                                       type="number"/>
                                                <div *ngIf="(submitted) && guarantorDetails?.get('marginalisedDirector')?.invalid"
                                                     class="invalid-feedback">
                                                    <div *ngIf="guarantorDetails?.get('marginalisedDirector')?.errors?.required">
                                                        Directors from marginalized community group is required
                                                    </div>
                                                </div>
                                                <div *ngIf="(addMore) && guarantorDetails?.get('marginalisedDirector')?.invalid"
                                                     class="alert-warning">
                                                    <div *ngIf="guarantorDetails?.get('marginalisedDirector')?.errors?.required">
                                                        Please fill Directors from marginalized community group
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label><strong>No. of Directors from marginalized community group</strong></label>
                                                <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('femaleMarDirector').errors }"
                                                       class="form-control form-control-sm-error rounded"
                                                       formControlName="femaleMarDirector"
                                                       id="femaleMarDirector"
                                                       name="femaleMarDirector"
                                                       placeholder="Directors from marginalized community group"
                                                       type="number"/>
                                                <div *ngIf="(submitted) && guarantorDetails.get('femaleMarDirector').invalid"
                                                     class="invalid-feedback">
                                                    <div *ngIf="guarantorDetails.get('femaleMarDirector').errors.required">
                                                        Directors from marginalized community group is required
                                                    </div>
                                                </div>
                                                <div *ngIf="(addMore) && guarantorDetails.get('femaleMarDirector').invalid"
                                                     class="alert-warning">
                                                    <div *ngIf="guarantorDetails.get('femaleMarDirector').errors.required">
                                                        Please fill Directors from marginalized community group
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                </ng-template>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Contact</strong></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('contactNumber').errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="contactNumber"
                                               id="contactNumber"
                                               name="contactNumber"
                                               placeholder="contact Number"
                                               type="text"/>
                                        <div *ngIf="(submitted) && guarantorDetails.get('contactNumber').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('contactNumber').errors.required">
                                                Contact Number is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('contactNumber').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('contactNumber').errors.required">
                                                Please fill Contact Number
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>PAN Number</strong></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails?.get('panNumber')?.errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="panNumber"
                                               name="panNumber"
                                               placeholder="PAN Number"
                                               type="text">
                                        <div *ngIf="(submitted) && guarantorDetails?.get('panNumber')?.invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails?.get('panNumber').errors?.required">
                                                PAN Number is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails?.get('panNumber')?.invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails?.get('panNumber')?.errors?.required">
                                                Please add PAN Number
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>PAN Issued Date</strong></label>
                                        <input [nbDatepicker]="passIssueDate"
                                               *ngIf="calendarType === 'AD'"
                                               [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.get('panIssueDate')?.errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="panIssueDate"
                                               name="panIssueDate"
                                               placeholder="PAN Issued Date"
                                               type="text">
                                        <app-calendar
                                                [ePreDate]="form?.get(['guarantorDetails', i, 'passIssueDate'])?.value"
                                                *ngIf="calendarType === 'BS'"
                                                (messageToEmit)="form?.get(['guarantorDetails', i, 'panIssueDate'])?.patchValue($event?.eDate)"></app-calendar>

                                        <nb-datepicker #passIssueDate></nb-datepicker>
                                        <div *ngIf="(submitted) && guarantorDetails.get('panIssueDate').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails?.get('panIssueDate')?.errors?.required">
                                                PAN issued Date is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails?.get('panIssueDate')?.invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails?.get('panIssueDate')?.errors?.required">
                                                Please fill PAN issued Date
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>PAN Issued District</strong></label>
                                        <select [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.get('panIssuedPlace')?.errors }"
                                                class="custom-select"
                                                formControlName="panIssuedPlace">
                                            <option [value]="null">--Select PAN Issued District-- </option>
                                            <option *ngFor="let district of allDistrict" [value]="district?.name">
                                                {{district?.name}}
                                            </option>
                                        </select>
                                        <div *ngIf="(submitted) && guarantorDetails?.get('panIssuedPlace')?.invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails?.get('panIssuedPlace')?.errors?.required">
                                                PAN issued Place is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails?.get('panIssuedPlace')?.invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails?.get('panIssuedPlace')?.errors?.required">
                                                Please add PAN issued Place
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Profession</strong></label>
                                        <select class="form-control form-control-sm-error rounded"
                                               formControlName="profession"
                                               id="profession"
                                                name="profession">
                                            <option [value]="null">Select Profession</option>
                                            <option [value]="profession.key" *ngFor="let profession of occupation">{{profession.value}}</option>

                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Email</strong></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('email').errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="email"
                                               name="email{{i}}"
                                               placeholder="Email"
                                               type="text"/>
                                        <div *ngIf="(submitted) && guarantorDetails.get('email').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('email').errors.required">
                                                Email is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('email').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('email').errors.required">
                                                Please fill Email
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4" *ngIf="customerInfo?.customerType === 'INSTITUTION'">
                                    <div class="form-group">
                                        <label><strong>Type of Shareholding</strong></label>
                                        <select class="form-control form-control-sm-error rounded"
                                                formControlName="shareHolding"
                                                name="shareHolding{{i}}">
                                            <option [value]="null">Select Type of Shareholding</option>
                                            <option value="PUBLIC">Public</option>
                                            <option value="PROMOTER">Promoter</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4" *ngIf="customerInfo?.customerType === 'INSTITUTION'">
                                    <div class="form-group">
                                        <label><strong> % Shareholding</strong></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('sharePercent').errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="sharePercent"
                                               id="sharePercent"
                                               name="sharePercent"
                                               placeholder="% ShareHolding"
                                               type="number"/>
                                        <div *ngIf="(submitted) && guarantorDetails.get('sharePercent').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('sharePercent').errors.required">
                                                % shareholding is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('sharePercent').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('sharePercent').errors.required">
                                                Please fill % Shareholding
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Guarantor</strong></label>
                                        <select class="form-control form-control-sm-error rounded"
                                                formControlName="guarantor"
                                                id="guarantor"
                                                name="guarantor">
                                            <option [value]="null">Select Yes/No</option>
                                            <option [value]="ans" *ngFor="let ans of question">{{ans}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Relationship with Borrower </strong></label>
                                        <select [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('relationship').errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="relationship"
                                               id="relationship"
                                               name="relationship">
                                            <option [value]="null">--Select Relationship with Borrower --</option>
                                            <option *ngFor="let relationship of relationList" [ngValue]="relationship.id">{{relationship.name}}</option>
                                        </select>
                                        <div *ngIf="(submitted) && guarantorDetails.get('relationship').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('relationship').errors.required">
                                                Relationship is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('relationship').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('relationship').errors.required">
                                                please fill relationship
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><b>Net Worth</b></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('netWorth').errors }" class="form-control" formControlName="netWorth" type="number" placeholder="Net Worth Amount">
                                        <div *ngIf="addMore && guarantorDetails.get('netWorth').invalid" class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('netWorth').errors.required">
                                                Net Worth Amount is required
                                            </div>
                                        </div>
                                        <div *ngIf="submitted && guarantorDetails.get('netWorth').invalid" class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('netWorth').errors.required">
                                                Net Worth Amount is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <h6><b>Permanent Address</b></h6>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label><strong>Address Line 1</strong></label>
                                        <input class="form-control"
                                               formControlName="permanentAddressLineOne"
                                               placeholder="Address Line 1 (optional)"
                                               type="text">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label><strong>Address Line 2</strong></label>
                                        <input class="form-control"
                                               formControlName="permanentAddressLineTwo"
                                               placeholder="Address Line 2 (optional)"
                                               type="text">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Province</strong></label>
                                        <select (change)="getDistrict(guarantorDetails.get('province').value,i)"
                                                [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('province').errors}"
                                                class="custom-select"
                                                formControlName="province"
                                                name="province">
                                            <option [value]="null" hidden>Select Province</option>
                                            <option *ngFor="let provinceVal of provinceList"
                                                    [ngValue]="provinceVal.id">
                                                {{provinceVal.name}}
                                        </select>
                                        <div *ngIf="(submitted) && guarantorDetails.get('province').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('province').errors.required">Province
                                                is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('province').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('province').errors.required">Please fill province
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>District</strong></label>
                                        <select (change)="getMunicipalities(guarantorDetails.get('district').value, i)"
                                                [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('district').errors}"
                                                class="custom-select"
                                                formControlName="district"
                                                name="district">
                                            <option [value]="null" hidden>Select District</option>
                                            <option *ngFor="let districtVal of addressList[i].districtList"
                                                    [ngValue]="districtVal.id">
                                                {{districtVal.name}}</option>
                                        </select>
                                        <div *ngIf="(submitted) && guarantorDetails.get('district').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('district').errors.required">District
                                                is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('district').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('district').errors.required">please add district
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong>Municipalities/VDC</strong></label>
                                        <select [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('municipalities').errors}"
                                                class="custom-select"
                                                formControlName="municipalities"
                                                name="municipalities">
                                            <option [value]="null" hidden>Select Municipalities/VDC</option>
                                            <option *ngFor="let municipalitiesVal of addressList[i].municipalityVdcList"
                                                    [ngValue]="municipalitiesVal.id">
                                                {{municipalitiesVal.name}}
                                        </select>
                                        <div *ngIf="(submitted) && guarantorDetails.get('municipalities').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('municipalities').errors.required">
                                                Municipality or VDC is required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('municipalities').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('municipalities').errors.required">
                                                Please add Municipality or VDC
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label><strong> Ward Number</strong></label>
                                        <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('wardNumber').errors }"
                                               class="form-control form-control-sm-error rounded"
                                               formControlName="wardNumber"
                                               id="wardNumber"
                                               name="wardNumber"
                                               placeholder="Ward Number"
                                               type="number">
                                        <div *ngIf="(submitted) && guarantorDetails.get('wardNumber').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('wardNumber').errors.required">Ward Number is
                                                required
                                            </div>
                                        </div>
                                        <div *ngIf="(addMore) && guarantorDetails.get('wardNumber').invalid"
                                             class="alert-warning">
                                            <div *ngIf="guarantorDetails.get('wardNumber').errors.required">
                                                Please fill Ward Number
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label for="guarantorLegalDocumentAddress"><strong>Address as per Legal Document</strong></label>
                                        <textarea [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('guarantorLegalDocumentAddress').errors }"
                                                  class="form-control"
                                                  formControlName="guarantorLegalDocumentAddress" id="guarantorLegalDocumentAddress"
                                                  name="guarantorLegalDocumentAddress" placeholder="Address as per Legal Document"
                                                  rows="2"
                                                  type="text" maxlength="256"></textarea>
                                        <div *ngIf="(submitted) && guarantorDetails.get('guarantorLegalDocumentAddress').invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="guarantorDetails.get('guarantorLegalDocumentAddress').errors.required">
                                                Address as per legal document is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <nb-checkbox #tempAddress (change)="sameAsAbove(i,tempAddress.checked)" formControlName="checkSameAddress"><i>Same as Permanent Address for Current Address</i></nb-checkbox>
                                </div>
                                <ng-container *ngIf="!form.get(['guarantorDetails', i, 'checkSameAddress']).value">
                                    <div class="col-md-12">
                                        <h6><b>Current Address</b></h6>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label><strong>Address Line 1</strong></label>
                                            <input class="form-control"
                                                   formControlName="temporaryAddressLineOne"
                                                   placeholder="Address Line 1 (optional)"
                                                   type="text">
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label><strong>Address Line 2</strong></label>
                                            <input class="form-control"
                                                   formControlName="temporaryAddressLineTwo"
                                                   placeholder="Address Line 2 (optional)"
                                                   type="text">
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Province</strong></label>
                                            <select (change)="getDistrictTemporary(guarantorDetails.get('provinceTemporary').value,i)"
                                                    [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('provinceTemporary').errors}"
                                                    class="custom-select"
                                                    formControlName="provinceTemporary"
                                                    name="province">
                                                <option [value]="null" hidden>Select Province</option>
                                                <option *ngFor="let provinceVal of provinceList"
                                                        [ngValue]="provinceVal.id">
                                                    {{provinceVal.name}}
                                            </select>
                                            <div *ngIf="(submitted) && guarantorDetails.get('provinceTemporary').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('provinceTemporary').errors.required">
                                                    Province is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('provinceTemporary').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('provinceTemporary').errors.required">
                                                    Please fill province
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>District</strong></label>
                                            <select (change)="getMunicipalitiesTemporary(guarantorDetails.get('districtTemporary').value, i)"
                                                    [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('districtTemporary').errors}"
                                                    class="custom-select"
                                                    formControlName="districtTemporary"
                                                    name="district">
                                                <option [value]="null" hidden>Select District</option>
                                                <option *ngFor="let districtVal of addressListTemporary[i].districtList"
                                                        [ngValue]="districtVal.id">
                                                    {{districtVal.name}}</option>
                                            </select>
                                            <div *ngIf="(submitted) && guarantorDetails.get('districtTemporary').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('districtTemporary').errors.required">District
                                                    is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('districtTemporary').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('districtTemporary').errors.required">
                                                    please add district
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong>Municipalities/VDC</strong></label>
                                            <select [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails.get('municipalitiesTemporary').errors}"
                                                    class="custom-select"
                                                    formControlName="municipalitiesTemporary"
                                                    name="municipalities">
                                                <option [value]="null" hidden>Select Municipalities/VDC</option>
                                                <option *ngFor="let municipalitiesVal of addressListTemporary[i].municipalityVdcList"
                                                        [ngValue]="municipalitiesVal.id">
                                                    {{municipalitiesVal.name}}
                                            </select>
                                            <div *ngIf="(submitted) && guarantorDetails.get('municipalitiesTemporary').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('municipalitiesTemporary').errors.required">
                                                    Municipality or VDC is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('municipalitiesTemporary').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('municipalitiesTemporary').errors.required">
                                                    Please add Municipality or VDC
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label><strong> Ward Number</strong></label>
                                            <input [ngClass]="{ 'is-invalid': (submitted ) && guarantorDetails.get('wardNumberTemporary').errors }"
                                                   class="form-control form-control-sm-error rounded"
                                                   formControlName="wardNumberTemporary"
                                                   id="wardNumberTemporary"
                                                   name="wardNumberTemporary"
                                                   placeholder="Ward Number"
                                                   type="number">
                                            <div *ngIf="(submitted) && guarantorDetails.get('wardNumberTemporary').invalid"
                                                 class="invalid-feedback">
                                                <div *ngIf="guarantorDetails.get('wardNumberTemporary').errors.required">
                                                    Ward Number is required
                                                </div>
                                            </div>
                                            <div *ngIf="(addMore) && guarantorDetails.get('wardNumberTemporary').invalid"
                                                 class="alert-warning">
                                                <div *ngIf="guarantorDetails.get('wardNumberTemporary').errors.required">
                                                    Please fill Ward Number
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                            <div class="row mb-1">
                                <div class="col-md-12">
                                    <label><b>Background</b></label>
                                    <textarea rows="3" class="form-control" formControlName="background" placeholder="Background Details"></textarea>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="successionPlanning"><strong>Succession Risk & Mitigation</strong></label>
                                        <ckeditor [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.successionPlanning?.errors }"
                                                  formControlName="successionPlanning" id="successionPlanning"
                                                  name="successionPlanning"
                                                  [config]="ckeConfig"></ckeditor>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="groupBackground"><strong>Group's Background and associated companies</strong></label>
                                    <ckeditor [ngClass]="{ 'is-invalid': (submitted) && guarantorDetails?.groupBackground?.errors }"
                                              formControlName="groupBackground" id="groupBackground"
                                              name="groupBackground" [config]="ckeConfig"
                                              type="text"></ckeditor>
                                    <div *ngIf="submitted && guarantorDetails?.groupBackground?.errors "
                                         class="invalid-feedback">
                                        <div *ngIf="guarantorDetails?.groupBackground?.errors?.required">
                                            Group's Background and associated companies is required
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" *ngIf="customerInfo?.customerType === 'INSTITUTION' " [formGroup]="guarantorDetails?.get('promoterData')">

                                <table  class="table table-sm table-bordered table-hover sb-small text-center">
                                    <thead>
                                    <tr class="sb-bg-dark text-white">
                                        <th>S.N</th>
                                        <th>Previous/Other Associations</th>
                                        <th>Nature Of Business/Work</th>
                                        <th>Capacity</th>
                                        <th>Tenure (Date)</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <ng-container formArrayName="background">
                                        <tr *ngFor="let background of guarantorDetails?.get('promoterData')?.get('background')['controls']; let j = index;" [formGroupName]="j">
                                            <td>{{j + 1}}</td>
                                            <td><input type="text" formControlName="previousAssociations"></td>
                                            <td><input type="text" formControlName="natureOfBusiness"></td>
                                            <td><input type="text" formControlName="capacity"></td>
                                            <td>
                                                <input type="text" formControlName="tenure" [nbDatepicker]="date">
                                            <nb-datepicker #date></nb-datepicker>
                                            </td>
                                            <td><a href="javascript:void(0)" (click)="removeBackground(i,j)"><i class="fa fa-times-circle px-3" nbTooltip="Delete Row"></i></a></td>
                                        </tr>

                                    </ng-container>
                                    </tbody>
                                </table>
                                <div class="text-right">
                                    <hr>
                                    <button (click)="addBackground(i)" class="btn btn-sm btn-flat btn-primary float-right">
                                        Add Background
                                    </button>
                                    <hr>
                                </div>
                                <table  class="table table-sm table-bordered table-hover sb-small text-center">
                                    <thead>
                                    <tr class="sb-bg-dark text-white">
                                        <th>S.N</th>
                                        <th>Undivided Adult Family Members</th>
                                        <th>Relation</th>
                                        <th>Age</th>
                                        <th>Profession</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <ng-container formArrayName="familyDetails">
                                        <tr *ngFor="let familyDetails of guarantorDetails?.get('promoterData')?.get('familyDetails')['controls']; let j = index;" [formGroupName]="j">
                                            <td>{{j + 1}}</td>
                                            <td><input type="text" formControlName="name"></td>
                                            <td><input type="text" formControlName="relation"></td>
                                            <td><input type="text" formControlName="age"></td>
                                            <td>
                                                <input type="text" formControlName="profession">
                                            </td>
                                            <td><a href="javascript:void(0)" (click)="removeFamily(i,j)"><i class="fa fa-times-circle px-3" nbTooltip="Delete Row"></i></a></td>
                                        </tr>

                                    </ng-container>
                                    </tbody>
                                </table>
                                <div class="text-right">
                                    <hr>
                                    <button (click)="addFamily(i)" class="btn btn-sm btn-flat btn-primary float-right">
                                        Add Family
                                    </button>
                                    <hr>

                                </div>

                            </div>
                            <app-template-document [customerInfo]="customerInfo" [docName]="guarantorDetails.get('citizenNumber').value" (docPathEmitter)="documentPath($event,i)" [pathValue]="guarantorDetails.get('docPath').value" [docTitle]="docTitle" [docFolderName]="docFolderName"></app-template-document>
                            <p><i><b>Note:</b></i></p>
                            <p>
                                <i>Guarantor Citizenship number is required to upload file <br></i>
                                <i>BOD refers to Management Team or Chief person in case of Sole Proprietorship and Partnership <br></i>
                                <i>Marginalized community group refers to females from Dalit, Janajaati, Muslim or Kalikot, Jumla, Humla, Jajarkot, Bajura, Acchham and Bajhang</i>
                            </p>
                        </div>
                        <hr>
                    </div>
                </div>

                <div class="text-right">
                    <button (click)="addEmptyGroup()" class="btn btn-sm btn-flat btn-primary">
                        Add Guarantor
                    </button>
                </div>
            </form>
        </div>
    </nb-card-body>
    <nb-card-footer>
        <div *ngIf="fromProfile" class="py-4 d-flex justify-content-end">
            <button (click)="onSubmit()" nbButton type="button">save</button>
        </div>
    </nb-card-footer>
</nb-card>
