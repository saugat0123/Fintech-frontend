<nb-card class="p-3">
    <div class="box-header with-border">
        <h2 class="box-title title">Hypothecation of Stock & Receivables</h2>
    </div>
    <form [formGroup]="hypothecationForm">
        <div *ngFor="let hypothecation of hypothecationForm.get('hypothecationOfStock')['controls']; let i = index"
             class="font-weight-bold"
             formArrayName="hypothecationOfStock">
            <div [formGroupName]="i.toString()">
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label class="title" for="description">Description</label>
                            <textarea class="form-control rounded" formControlName="description"
                                      placeholder="Description" rows="5"
                                      id="description"
                                      type="text"></textarea>
                        </div>
                    </div>
       <ng-container>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Stock Book Value</label>
                   <input class="form-control rounded" formControlName="bookValue"
                          placeholder="Book Value"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Stock Location</label>
                   <input class="form-control rounded" formControlName="stock"
                          placeholder="Stock Location"
                          type="text"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Stock Market Value</label>
                   <input class="form-control rounded" formControlName="stockMarketValue"
                          placeholder="Stock Market Value"
                          (change)="onChange(i,'stockMarketValue','receivableMarketValue','fairMarketValue')"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Stock Realizable Rate</label>
                   <input class="form-control rounded" formControlName="realiasableRate"
                          (change)="hypothecation.get('stockRealiasableValue').patchValue((hypothecation.get('stockMarketValue').value / 100) * hypothecation.get('realiasableRate').value); onChange(i,'stockRealiasableValue', 'receivableRealizableValue', 'realiasableValue')"
                          placeholder="Realizable Rate %"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Stock Realizable Value</label>
                   <input class="form-control rounded"  formControlName="stockRealiasableValue"
                          placeholder="Realizable Value"
                          type="number"/>
               </div>
           </div>

           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Average Stock To Recieveable Ratio</label>
                   <input class="form-control rounded"  formControlName="averageStock"
                          placeholder="Average Stock To Recieveable Ratio"
                          type="text"/>
               </div>
           </div>

           <div class="col-md-3" hidden>
               <div class="form-group">
                   <label class="title">Value</label>
                   <input class="form-control rounded" formControlName="distressValue"
                          placeholder="Value"
                          [(ngModel)]="hypothecation.get('realiasableValue').value"
                          type="number"/>
               </div>
           </div>

       </ng-container>
       <ng-container>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Receivable Book Value</label>
                   <input class="form-control rounded" formControlName="receivableBookValue"
                          placeholder="Receivable Book Value"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Receivable Market Value</label>
                   <input class="form-control rounded" formControlName="receivableMarketValue"
                          (change)="onChange(i,'stockMarketValue','receivableMarketValue','fairMarketValue')"
                          placeholder="Market Value"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3" hidden>
               <div class="form-group">
                   <label class="title">Considered Value</label>
                   <input class="form-control rounded" [(ngModel)]="hypothecation.get('fairMarketValue').value" formControlName="considerValue"
                          placeholder="Market Value"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Receivable Realizable Rate</label>
                   <input class="form-control rounded" formControlName="receivableRealizableRate"
                          (change)="hypothecation.get('receivableRealizableValue').patchValue((hypothecation.get('receivableMarketValue').value / 100) * hypothecation.get('receivableRealizableRate').value); onChange(i,'realiasableValue', 'receivableRealizableValue', 'realiasableValue')"
                          placeholder="Realizable Rate %"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Receivable Realizable Value</label>
                   <input class="form-control rounded"  formControlName="receivableRealizableValue"
                          placeholder="Realizable Value"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Total Market Value</label>
                   <input class="form-control rounded"  formControlName="fairMarketValue"
                          placeholder="Total Market Value"
                          type="number"/>
               </div>
           </div>
           <div class="col-md-3">
               <div class="form-group">
                   <label class="title">Total Realizable Value</label>
                   <input class="form-control rounded"  formControlName="realiasableValue"
                          placeholder="Total Market Value"
                          type="number"/>
               </div>
           </div>
       </ng-container>



                    <div class="col-md-12">
                        <div class="form-group">
                            <label>Remarks</label>
                            <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                        </div>
                    </div>

                    <div *ngIf="hypothecationForm.get('hypothecationOfStock') ['length'] > 1" class="col-md-1">
                        <input (click)="removeHypothecation(i)"
                               class="align-self-end btn btn-sm btn-danger btn-primary"
                               type="button" value="Delete"/>
                    </div>

                </div>

            </div>
            <hr>
        </div>
    </form>
    <div class="text-right" >
        <input (click)="addHypothecationOfStock()" class="btn btn-sm btn-flat btn-primary" type="button"
               value="Add More Hypothecation Of Stock"/>
    </div>
</nb-card>
