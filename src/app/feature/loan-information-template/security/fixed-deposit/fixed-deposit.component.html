<nb-card class="p-3">
    <div class="box-header with-border">
        <h2 class="box-title title">Fixed Deposit Receipt</h2>
    </div>
    <form [formGroup]="fixedDepositForm">
        <div *ngFor="let deposit of fixedDepositForm.get('fixedDepositDetails')['controls']; let i = index"
             class="font-weight-bold"
             formArrayName="fixedDepositDetails">
            <div [formGroupName]="i.toString()">
                <div class="row">
                    <div class="col-md-12">
                        <hr>
                        <div *ngIf="i > 0" class="float-right">
                            <input (click)="removeFixedDeposit(i)" class="btn btn-sm btn-flat btn-danger"
                                   type=button value="Delete"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">FD Receipt Number<strong></strong></label>
                            <input class="form-control" formControlName="receiptNumber" placeholder="FD Receipt Number">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">FD Account Holder Name<strong></strong></label>
                            <input class="form-control" formControlName="accountHolderName" placeholder="FD Account Holder Name">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">FD Account Number<strong></strong></label>
                            <input [ngClass]="{'is-invalid': (submitted) && (deposit.get('accountNumber').errors)}"
                                   class="form-control" formControlName="accountNumber" placeholder="FD Account Number"
                                   required />
                            <div *ngIf="(submitted) && (deposit.get('accountNumber').invalid)" class="invalid-feedback">
                                <div *ngIf="deposit.get('accountNumber').errors.required">
                                    Account no is required
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">FD Tenure Start Date<strong></strong></label>
                            <input *ngIf="calendarType === 'AD'" [nbDatepicker]="tenureStartDate"
                                   class="form-control" formControlName="tenureStartDate" placeholder="FD Tenure Start Date">
                            <app-calendar *ngIf="calendarType === 'BS'"
                                          (messageToEmit)="fixedDepositForm.get(['fixedDepositDetails',i,'tenureStartDate']).patchValue($event?.eDate)"
                                          [ePreDate]="fixedDepositForm.get(['fixedDepositDetails',i,'tenureStartDate']).value"></app-calendar>
                            <nb-datepicker #tenureStartDate></nb-datepicker>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Amount<strong></strong></label>
                            <input class="form-control"
                                   (change)="deposit.get('realizableValue').patchValue((deposit.get('considerValue').value / 100) * deposit.get('realizableRate').value)"
                                   [ngClass]="{'is-invalid': (submitted) && (deposit.get('fairMarketValue').errors)}"
                                   formControlName="fairMarketValue" placeholder="Amount" type="number">
                            <div *ngIf="(submitted) && (deposit.get('fairMarketValue').invalid)" class="invalid-feedback">
                                <div *ngIf="deposit.get('fairMarketValue').errors.required">
                                    Amount is required
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Consider Value<strong></strong></label>
                            <input class="form-control" disabled
                                   [(ngModel)]="deposit.get('fairMarketValue').value"
                                   [ngClass]="{'is-invalid': (submitted) && (deposit.get('considerValue').errors)}"
                                   formControlName="considerValue" placeholder="Consider Value" type="number">
                            <div *ngIf="(submitted) && (deposit.get('considerValue').invalid)" class="invalid-feedback">
                                <div *ngIf="deposit.get('considerValue').errors.required">
                                    Consider value is required
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Realizable Rate<strong></strong></label>
                            <input class="form-control"
                                   [ngClass]="{'is-invalid': (submitted) && (deposit.get('considerValue').errors)}"
                                   (change)="deposit.get('realizableValue').patchValue((deposit.get('considerValue').value / 100) * deposit.get('realizableRate').value)"
                                   formControlName="realizableRate" placeholder="Realizable Rate %" type="number">
                            <div *ngIf="(submitted) && (deposit.get('realizableRate').invalid)"
                                 class="invalid-feedback">
                                <div *ngIf="deposit.get('realizableRate').errors.required">
                                    value is required
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Realizable Value<strong></strong></label>
                            <input class="form-control" disabled
                                   [ngClass]="{'is-invalid': (submitted) && (deposit.get('realizableValue').errors)}"
                                   formControlName="realizableValue" placeholder="Realizable Value" type="number">
                            <div *ngIf="(submitted) && (deposit.get('realizableValue').invalid)"
                                 class="invalid-feedback">
                                <div *ngIf="deposit.get('realizableValue').errors.required">
                                    value is required
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Expiry Date<strong></strong></label>
                            <input *ngIf="calendarType === 'AD'" [nbDatepicker]="expiryDate"
                                   class="form-control rounded" formControlName="expiryDate"
                                   nbInput placeholder="Expiry Date">
                            <app-calendar *ngIf="calendarType === 'BS'"
                                          (messageToEmit)="fixedDepositForm.get(['fixedDepositDetails',i,'expiryDate']).patchValue($event?.eDate)"
                                          [ePreDate]="fixedDepositForm.get(['fixedDepositDetails',i,'expiryDate']).value"></app-calendar>
                            <nb-datepicker #expiryDate></nb-datepicker>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Coupon Rate<strong></strong></label>
                            <input class="form-control" formControlName="couponRate" placeholder="Coupon Rate" type="number">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Beneficiary<strong></strong></label>
                            <input class="form-control" formControlName="beneficiary" placeholder="Beneficiary">
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="title">Remarks<strong></strong></label>
                        <ckeditor [config]="ckeConfig"  formControlName="remarks" ></ckeditor>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <hr>
    <div class="text-right" >
        <input (click)="addFixedDeposit()" class="btn btn-sm btn-flat btn-primary"
               type="button"
               value="Add More"/>
    </div>
</nb-card>
