
<div class="form-group">
    <form [formGroup]="securityForm">
        <!--START ROW-->
        <div class="font-weight-bold" >
            <!--END ROW-->
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Choose Security Type</label>
                        <nb-select #combinedSecurityElement (selectedChange)="change(combinedSecurityElement.selected)"
                                   [selected]="selectedArray"
                                   multiple placeholder="Multiple Select">
                            <nb-option *ngFor="let type of getSecurities()" [value]="type?.key">
                                {{type?.value}}
                            </nb-option>
                        </nb-select>
                    </div>
                </div>
            </div>
            <hr>
        </div>
        <nb-checkbox (change)="otherBranch($event.target.checked)"
                     [checked]="otherBranchcheck">Property on another branch location
        </nb-checkbox>
        <!--Land Security-->
        <nb-card [hidden]="!landSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Details of Security Offered and Value Amount : LAND</h2>
            </div>
            <div *ngFor="let land of securityForm.get('landDetails')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="landDetails">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="owner">Owner</label>
                                <input class="form-control rounded" formControlName="owner"
                                       id="owner"
                                       name="owner" placeholder="Owner Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="location">Location</label>
                                <input class="form-control rounded" formControlName="location"
                                       id="location"
                                       name="location" placeholder="location"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="title" for="plotNumber">Plot No.</label>
                                <input class="form-control rounded" formControlName="plotNumber"
                                       id="plotNumber"
                                       name="plotNumber" placeholder="Plot No."
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="title" for="areaFormat">Area Format</label>
                              <!--  <input class="form-control rounded" formControlName="areaFormat"
                                       id="areaFormat"
                                       name="areaFormat" placeholder="area format"
                                       type="text"/>-->
                                <nb-select formControlName="areaFormat" placeholder="select area format" id="areaFormat" fullWidth>
                                    <nb-option *ngFor="let format of areaFormat" [value]="format">{{format}}</nb-option>
                                </nb-select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="title" for="area">Area</label>
                                <input class="form-control rounded" formControlName="area"
                                       id="ba"
                                       name="area" placeholder="area"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="landConsideredValue">Considered Value</label>
                                <input class="form-control" formControlName="landConsideredValue"
                                       id="landConsideredValue" name="total" placeholder="considered value">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="marketValue">Fair Market Value</label>
                                <input class="form-control rounded" formControlName="marketValue"
                                       id="marketValue"
                                       name="marketValue" placeholder="market value"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="distressValue">Distress Value</label>
                                <input class="form-control rounded" formControlName="distressValue"
                                       id="distressValue"
                                       name="distressValue" placeholder="distress value"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div *ngIf="otherBranchcheck">
                                <div class="form-group">
                                    <label>Select Branch</label>
                                    <ng-select
                                        (change)="valuator(securityForm.get(['landDetails',i,'landBranch']).value.id,'land',i)"
                                        [multiple]="false"
                                        bindLabel="name"
                                        formControlName="landBranch"
                                        placeholder="">
                                        <ng-option *ngFor="let branch of branchLists"
                                                   [value]="branch">{{branch.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Valuator Name</label>
                                <ng-select [multiple]="false"
                                           bindLabel="name"
                                           placeholder=""
                                           formControlName="landValuator" (click)="valuator(null,'land',i)">
                                    <ng-option *ngFor="let valuator of securityValuator.landValuator[i]" [value]="valuator">{{valuator.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landValuatorDate">Valuated Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded" formControlName="landValuatorDate"
                                       id="landValuatorDate"
                                       name="landValuatorDate" placeholder="Valuated Date"
                                       [nbDatepicker]="landValuatorDate"
                                       type="text"/>
                              <app-calendar
                                  (messageToEmit)="securityForm.get(['landDetails',i,'landValuatorDate']).patchValue($event?.eDate)"
                                  *ngIf="calendarType === 'BS'"
                                  [ePreDate]="securityForm.get(['landDetails',i,'landValuatorDate']).value"></app-calendar>
                              <nb-datepicker #landValuatorDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landValuatorRepresentative">Valuator Representative Name</label>
                                <input class="form-control rounded" formControlName="landValuatorRepresentative"
                                       id="landValuatorRepresentative"
                                       name="landValuatorRepresentative" placeholder="Valuator Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landStaffRepresentativeName">Staff Representative Name</label>
                                <input class="form-control rounded" formControlName="landStaffRepresentativeName"
                                       id="landStaffRepresentativeName"
                                       name="landStaffRepresentativeName" placeholder="Staff Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Type of property</label>
                                <select class="form-control rounded" formControlName="typeOfProperty"
                                       name="typeOfProperty">
                                    <option [value]="null" hidden>Select Type of property</option>
                                    <option *ngFor="let property of typeOfProperty" [value]="property">{{property}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landStaffRepresentativeName">Mode of transfer</label>
                                <input class="form-control rounded" formControlName="modeOfTransfer"
                                       name="modeOfTransfer" placeholder="Mode of transfer"
                                       type="text"/>
                            </div>
                        </div>
                        <div *ngIf="securityForm.get('landDetails') ['length'] > 1" class="col-md-1">
                            <input (click)="removeLandDetails(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addMoreLand()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add More Land"/>
            </div>
            <div class="row">
                <div class="form-group">
                    <label class="title ml-3" for="description">Description/Details of Security
                        Offered</label>
                    <textarea class="form-control ml-3" cols="150" formControlName="description"
                              id="description"
                              placeholder="details of security offered"
                              rows="5"></textarea>
                </div>
            </div>
        </nb-card>
        <!--Apartment Security-->
        <nb-card [hidden]="!apartmentSelected" class="p-5">
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <nb-checkbox (change)="underConstruction($event.target.checked)"
                                     [checked]="underConstructionChecked">Check if Under Construction
                        </nb-checkbox>
                    </div>
                </div>
            </div>
            <div class="box-header with-border">
                <h2 class="box-title title">Apartment  Details</h2>
            </div>
            <div>
                <div *ngFor="let building of securityForm.get('buildingDetails')['controls']; let i = index"
                     class="font-weight-bold"
                     formArrayName="buildingDetails">
                    <div [formGroupName]="i">
                        <ng-template #apartment>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingName">Apartment Name</label>
                                        <input class="form-control rounded" formControlName="buildingName"
                                               id="buildingName"
                                               name="buildingName" placeholder="name of Apartment"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingDescription">Apartment
                                            Description</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingDescription"
                                               id="buildingDescription"
                                               name="buildingDescription" placeholder="Apartment description"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                        <input (input)="calculateBuildUpAreaRate(i, 'building')" class="form-control rounded" formControlName="buildArea"
                                               id="buildArea"
                                               name="buildArea" placeholder="build up area"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildRate">Build Up Area Rate</label>
                                        <input (input)="calculateBuildUpAreaRate(i,'building')" class="form-control rounded" formControlName="buildRate"
                                               id="buildRate"
                                               name="buildRate" placeholder="build up rate"
                                               type="number"/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="totalCost">Total Cost</label>
                                        <input class="form-control rounded" formControlName="totalCost"
                                               id="totalCost"
                                               name="totalCost" placeholder="total cost"
                                               type="number" readonly/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="floorName">Floor Name</label>
                                        <input class="form-control rounded" formControlName="floorName"
                                               id="floorName"
                                               name="floorName" placeholder="First Floor,Second....."
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="valuationArea">Valuation Taken Area
                                            (Sq.ft)</label>
                                        <input (input)="calculateEstimatedCost(i,'building')" class="form-control rounded" formControlName="valuationArea"
                                               id="valuationArea"
                                               name="valuationArea" placeholder="Valuation Taken Area"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ratePerSquareFeet">Rate per Square
                                            Feet</label>
                                        <input (input)="calculateEstimatedCost(i,'building')" class="form-control rounded"
                                               formControlName="ratePerSquareFeet"
                                               id="ratePerSquareFeet"
                                               name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="estimatedCost">Estimated Cost</label>
                                        <input class="form-control rounded" formControlName="estimatedCost"
                                               id="estimatedCost"
                                               name="estimatedCost" placeholder="Estimated Cost"
                                               type="number" readonly/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="waterSupply">Water Supply</label>
                                        <input class="form-control rounded" formControlName="waterSupply"
                                               id="waterSupply"
                                               name="waterSupply" placeholder="Water Supply"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="sanitation">Sanitation</label>
                                        <input class="form-control rounded" formControlName="sanitation"
                                               id="sanitation"
                                               name="sanitation" placeholder="Sanitation"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="electrification">Electrification</label>
                                        <input class="form-control rounded"
                                               formControlName="electrification"
                                               id="electrification"
                                               name="electrification" placeholder="Electrification"
                                               type="text"/>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingTotalCost">Apartment Total
                                            Cost</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingTotalCost"
                                               id="buildingTotalCost"
                                               name="buildingTotalCost" placeholder="Apartment total cost"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingFairMarketValue">Apartment Fair
                                            Market
                                            Value</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingFairMarketValue"
                                               id="buildingFairMarketValue"
                                               name="buildingFairMarketValue" placeholder="Apartment FMV"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingDistressValue">Apartment Distress
                                            Value</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingDistressValue"
                                               id="buildingDistressValue"
                                               name="buildingDistressValue" placeholder="Apartment DV"
                                               type="text"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div *ngIf="otherBranchcheck">
                                        <div class="form-group">
                                            <label>Select Branch</label>
                                            <ng-select
                                                (change)="valuator(securityForm.get(['buildingDetails',i,'apartmentBranch']).value.id,'apartment',i)"
                                                [multiple]="false"
                                                bindLabel="name"
                                                formControlName="apartmentBranch"
                                                placeholder="">
                                                <ng-option *ngFor="let branch of branchLists"
                                                           [value]="branch">{{branch.name}}</ng-option>
                                            </ng-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Valuator Name</label>
                                        <ng-select [multiple]="false"
                                                   bindLabel="name"
                                                   placeholder=""
                                                   formControlName="ApartmentValuator" (click)="valuator(null,'apartment',i)">
                                            <ng-option *ngFor="let valuator of securityValuator.apartmentValuator[i]" [value]="valuator">{{valuator.name}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentValuatorDate">Valuated Date</label>
                                        <input *ngIf="calendarType === 'AD'" class="form-control rounded" formControlName="ApartmentValuatorDate"
                                               id="ApartmentValuatorDate"
                                               name="ApartmentValuatorDate" placeholder="Valuated Date"
                                               [nbDatepicker]="ApartmentValuatorDate"
                                               type="text"/>
                                        <app-calendar
                                            (messageToEmit)="securityForm.get(['buildingDetails',i,'ApartmentValuatorDate']).patchValue($event?.eDate)"
                                            *ngIf="calendarType === 'BS'"
                                            [ePreDate]="securityForm.get(['buildingDetails',i,'ApartmentValuatorDate']).value"></app-calendar>
                                        <nb-datepicker #ApartmentValuatorDate></nb-datepicker>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentValuatorRepresentative">Valuator Representative Name</label>
                                        <input class="form-control rounded" formControlName="ApartmentValuatorRepresentative"
                                               id="ApartmentValuatorRepresentative"
                                               name="ApartmentValuatorRepresentative" placeholder="Valuator Representative Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentStaffRepresentativeName">Staff Representative Name</label>
                                        <input class="form-control rounded" formControlName="ApartmentStaffRepresentativeName"
                                               id="ApartmentStaffRepresentativeName"
                                               name="ApartmentStaffRepresentativeName" placeholder="Staff Representative Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div *ngIf="securityForm.get('buildingDetails')['length'] > 1"
                                     class="col-md-1 pt-4">
                                    <input (click)="removeBuildingDetails(i)"
                                           class="align-self-end btn btn-sm btn-danger btn-primary"
                                           type="button" value="Delete"/>
                                </div>

                            </div>
                        </ng-template>
                        <ng-template [ngTemplateOutlet]="apartment"></ng-template>
                    </div>
                    <hr>
                </div>

            </div>
            <div class="text-right">
                <input (click)="addBuilding()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add Apartment"/>
            </div>

            <div class="row">
                <div class="form-group">
                    <label class="title ml-3" for="buildingDetailsDescription">Apartment Details
                        Description</label>
                    <textarea class="form-control ml-3 rounded" cols="95" formControlName="buildingDetailsDescription"
                              id="buildingDetailsDescription"
                              placeholder="Apartment Description"
                              rows="5"></textarea>
                </div>
            </div>

            <div [hidden]="!underConstructionChecked">
                <div *ngFor="let building of securityForm.get('buildingUnderConstructions')['controls']; let i = index"
                     class="font-weight-bold"
                     formArrayName="buildingUnderConstructions">
                    <div [formGroupName]="i">
                        <div class="box-header with-border">
                            <h2 class="box-title title">Apartment Details Before Completion</h2>
                        </div>
                        <div formGroupName="buildingDetailsBeforeCompletion">
                            <ng-template #build>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingName">Apartment Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="bname"
                                                   name="buildingName" placeholder="name of Apartment"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDescription">Apartment
                                                Description</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDescription"
                                                   id="descriptioin"
                                                   name="buildingDescription" placeholder="Apartment description"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'before')" class="form-control rounded" formControlName="buildArea"
                                                   id="area"
                                                   name="buildArea" placeholder="build up area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildRate">Build Up Area Rate</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'before')" class="form-control rounded" formControlName="buildRate"
                                                   id="rate"
                                                   name="buildRate" placeholder="build up rate"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="totalCost">Total Cost</label>
                                            <input class="form-control rounded" formControlName="totalCost"
                                                   id="cost"
                                                   name="totalCost" placeholder="total cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="floorName">Floor Name</label>
                                            <input class="form-control rounded" formControlName="floorName"
                                                   id="fname"
                                                   name="floorName" placeholder="First Floor,Second....."
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="valuationArea">Valuation Taken Area
                                                (Sq.ft)</label>
                                            <input (input)="calculateEstimatedCost(i,'before')" class="form-control rounded" formControlName="valuationArea"
                                                   id="vArea"
                                                   name="valuationArea" placeholder="Valuation Taken Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="ratePerSquareFeet">Rate per Square
                                                Feet</label>
                                            <input (input)="calculateEstimatedCost(i,'before')" class="form-control rounded" formControlName="ratePerSquareFeet"
                                                   id="ratepsf"
                                                   name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="estimatedCost">Estimated Cost</label>
                                            <input class="form-control rounded" formControlName="estimatedCost"
                                                   id="estCost"
                                                   name="estimatedCost" placeholder="Estimated Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply</label>
                                            <input class="form-control rounded" formControlName="waterSupply"
                                                   id="supply"
                                                   name="waterSupply" placeholder="Water Supply"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitation">Sanitation</label>
                                            <input class="form-control rounded" formControlName="sanitation"
                                                   id="san"
                                                   name="sanitation" placeholder="Sanitation"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrification">Electrification</label>
                                            <input class="form-control rounded" formControlName="electrification"
                                                   id="ele"
                                                   name="electrification" placeholder="Electrification"
                                                   type="text"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingTotalCost">Apartment Total Cost</label>
                                            <input class="form-control rounded" formControlName="buildingTotalCost"
                                                   id="tc"
                                                   name="buildingTotalCost" placeholder="Apartment total cost"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingFairMarketValue">Apartment Fair Market
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingFairMarketValue"
                                                   id="fmv"
                                                   name="buildingFairMarketValue" placeholder="Apartment FMV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDistressValue">Apartment Distress
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDistressValue"
                                                   id="dv"
                                                   name="buildingDistressValue" placeholder="Apartment DV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <hr>
                                </div>
                            </ng-template>
                            <ng-template [ngTemplateOutlet]="build"></ng-template>
                        </div>
                        <hr>

                        <div class="box-header with-border">
                            <h2 class="box-title title">Apartment Details After Completion</h2>
                            <div formGroupName="buildingDetailsAfterCompletion">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingName">Apartment Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="afterName"
                                                   name="buildingName" placeholder="name of Apartment"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDescription">Apartment
                                                Description</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDescription"
                                                   id="afterDesc"
                                                   name="buildingDescription" placeholder="Apartment description"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'after')" class="form-control rounded" formControlName="buildArea"
                                                   id="afterArea"
                                                   name="buildArea" placeholder="build up area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildRate">Build Up Area Rate</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'after')" class="form-control rounded" formControlName="buildRate"
                                                   id="afterbuildRate"
                                                   name="buildRate" placeholder="build up rate"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="totalCost">Total Cost</label>
                                            <input class="form-control rounded" formControlName="totalCost"
                                                   id="afterTc"
                                                   name="totalCost" placeholder="total cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="floorName">Floor Name</label>
                                            <input class="form-control rounded" formControlName="floorName"
                                                   id="afterFloorName"
                                                   name="floorName" placeholder="First Floor,Second....."
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="valuationArea">Valuation Taken Area
                                                (Sq.ft)</label>
                                            <input (input)="calculateEstimatedCost(i,'after')" class="form-control rounded" formControlName="valuationArea"
                                                   id="afterVA"
                                                   name="valuationArea" placeholder="Valuation Taken Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="ratePerSquareFeet">Rate per Square
                                                Feet</label>
                                            <input (input)="calculateEstimatedCost(i,'after')" class="form-control rounded" formControlName="ratePerSquareFeet"
                                                   id="afterRate"
                                                   name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="estimatedCost">Estimated Cost</label>
                                            <input class="form-control rounded" formControlName="estimatedCost"
                                                   id="afterEstCost"
                                                   name="estimatedCost" placeholder="Estimated Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply</label>
                                            <input class="form-control rounded" formControlName="waterSupply"
                                                   id="afterSupply"
                                                   name="waterSupply" placeholder="Water Supply"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitation">Sanitation</label>
                                            <input class="form-control rounded" formControlName="sanitation"
                                                   id="afterSanitation"
                                                   name="sanitation" placeholder="Sanitation"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrification">Electrification</label>
                                            <input class="form-control rounded" formControlName="electrification"
                                                   id="afterElectrification"
                                                   name="electrification" placeholder="Electrification"
                                                   type="text"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingTotalCost">Apartment Total Cost</label>
                                            <input class="form-control rounded" formControlName="buildingTotalCost"
                                                   id="afterbuildTc"
                                                   name="buildingTotalCost" placeholder="Apartment total cost"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingFairMarketValue">Apartment Fair Market
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingFairMarketValue"
                                                   id="afterFMV"
                                                   name="buildingFairMarketValue" placeholder="Apartment FMV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDistressValue">Apartment Distress
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDistressValue"
                                                   id="afterDV"
                                                   name="buildingDistressValue" placeholder="Apartment DV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div *ngIf="securityForm.get('buildingUnderConstructions')['length'] > 1"
                                         class="col-md-1 pt-4">
                                        <input (click)="removeBuildingUnderConstructions(i)"
                                               class="align-self-end btn btn-sm btn-danger btn-primary"
                                               type="button" value="Delete"/>
                                    </div>

                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <input (click)="addBuildingUnderConstructions()" class="btn btn-sm btn-flat btn-primary"
                           type="button"
                           value="Add Apartment"/>
                </div>
            </div>
        </nb-card>
<!--        Land Building security-->
        <nb-card [hidden]="!landBuilding" class="p-5">
            <div class="row">
                <div class="col-md-5">
                    <div class="form-group">
                        <nb-checkbox (change)="underBuildingConstruction($event.target.checked)"
                                     [checked]="underBuildingConstructionChecked">Check if Building is Under Construction
                        </nb-checkbox>
                    </div>
                </div>
            </div>
            <div class="box-header with-border">
                <h2 class="box-title title">Building  Details</h2>
            </div>
            <div>
                <div *ngFor="let building of securityForm.get('landBuilding')['controls']; let i = index"
                     class="font-weight-bold"
                     formArrayName="landBuilding">
                    <div [formGroupName]="i">
                        <ng-template #apartment>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingNameLandBuilding">Building Name</label>
                                        <input class="form-control rounded" formControlName="buildingName"
                                               id="buildingNameLandBuilding"
                                               name="buildingNameLandBuilding" placeholder="Name of building"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingDescriptionLandBuilding">Building
                                            Description</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingDescription"
                                               id="buildingDescriptionLandBuilding"
                                               name="buildingDescriptionLandBuilding" placeholder="Building description"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildAreaLandBuilding">Build Up Area (Sq.ft)</label>
                                        <input (input)="calculateBuildUpAreaRate(i, 'landBuilding')" class="form-control rounded" formControlName="buildArea"
                                               id="buildAreaLandBuilding"
                                               name="buildAreaLandBuilding" placeholder="build up area"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildRateLandBuilding">Build Up Area Rate</label>
                                        <input (input)="calculateBuildUpAreaRate(i,'landBuilding')" class="form-control rounded" formControlName="buildRate"
                                               id="buildRateLandBuilding"
                                               name="buildRateLandBuilding" placeholder="build up rate"
                                               type="number"/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="totalCostLandBuilding">Total Cost</label>
                                        <input class="form-control rounded" formControlName="totalCost"
                                               id="totalCostLandBuilding"
                                               name="totalCostLandBuilding" placeholder="total cost"
                                               type="number" readonly/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="floorNameLandBuilding">Floor Name</label>
                                        <input class="form-control rounded" formControlName="floorName"
                                               id="floorNameLandBuilding"
                                               name="floorNameLandBuilding" placeholder="First Floor,Second....."
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="valuationAreaLandBuilding">Valuation Taken Area
                                            (Sq.ft)</label>
                                        <input (input)="calculateEstimatedCost(i,'landBuilding')" class="form-control rounded" formControlName="valuationArea"
                                               id="valuationAreaLandBuilding"
                                               name="valuationAreaLandBuilding" placeholder="Valuation Taken Area"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ratePerSquareFeetLandBuilding">Rate per Square
                                            Feet</label>
                                        <input (input)="calculateEstimatedCost(i,'landBuilding')" class="form-control rounded"
                                               formControlName="ratePerSquareFeet"
                                               id="ratePerSquareFeetLandBuilding"
                                               name="ratePerSquareFeetLandBuilding" placeholder="Rate per Square Feet"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="estimatedCostLandBuilding">Estimated Cost</label>
                                        <input class="form-control rounded" formControlName="estimatedCost"
                                               id="estimatedCostLandBuilding"
                                               name="estimatedCostLandBuilding" placeholder="Estimated Cost"
                                               type="number" readonly/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="waterSupplyLandBuilding">Water Supply</label>
                                        <input class="form-control rounded" formControlName="waterSupply"
                                               id="waterSupplyLandBuilding"
                                               name="waterSupplyLandBuilding" placeholder="Water Supply"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="sanitationLandBuilding">Sanitation</label>
                                        <input class="form-control rounded" formControlName="sanitation"
                                               id="sanitationLandBuilding"
                                               name="sanitationLandBuilding" placeholder="Sanitation"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="electrificationLandBuilding">Electrification</label>
                                        <input class="form-control rounded"
                                               formControlName="electrification"
                                               id="electrificationLandBuilding"
                                               name="electrificationLandBuilding" placeholder="Electrification"
                                               type="text"/>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingTotalCostLandBuilding">Building Total
                                            Cost</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingTotalCost"
                                               id="buildingTotalCostLandBuilding"
                                               name="buildingTotalCostLandBuilding" placeholder="Building total cost"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingFairMarketValueLandBuilding">Building Fair
                                            Market
                                            Value</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingFairMarketValue"
                                               id="buildingFairMarketValueLandBuilding"
                                               name="buildingFairMarketValueLandBuilding" placeholder="Building FMV"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingDistressValueLandBuilding">Building Distress
                                            Value</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingDistressValue"
                                               id="buildingDistressValueLandBuilding"
                                               name="buildingDistressValueLandBuilding" placeholder="Building DV"
                                               type="text"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div *ngIf="otherBranchcheck">
                                        <div class="form-group">
                                            <label>Select Branch</label>
                                            <ng-select
                                                (change)="valuator(securityForm.get(['landBuilding',i,'apartmentBranch']).value.id,'building',i)"
                                                [multiple]="false"
                                                bindLabel="name"
                                                formControlName="apartmentBranch"
                                                placeholder="">
                                                <ng-option *ngFor="let branch of branchLists"
                                                           [value]="branch">{{branch.name}}</ng-option>
                                            </ng-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Valuator Name</label>
                                        <ng-select [multiple]="false"
                                                   bindLabel="name"
                                                   placeholder=""
                                                   formControlName="ApartmentValuator" (click)="valuator(null,'building',i)">
                                            <ng-option *ngFor="let valuator of securityValuator.buildingValuator[i]" [value]="valuator">{{valuator.name}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentValuatorDateLandBuilding">Valuated Date</label>
                                        <input *ngIf="calendarType === 'AD'" class="form-control rounded" formControlName="ApartmentValuatorDate"
                                               id="ApartmentValuatorDateLandBuilding"
                                               name="ApartmentValuatorDateLandBuilding" placeholder="Valuated Date"
                                               [nbDatepicker]="ApartmentValuatorDate"
                                               type="text"/>
                                        <app-calendar
                                            (messageToEmit)="securityForm.get(['landBuilding',i,'ApartmentValuatorDate']).patchValue($event?.eDate)"
                                            *ngIf="calendarType === 'BS'"
                                            [ePreDate]="securityForm.get(['landBuilding',i,'ApartmentValuatorDate']).value"></app-calendar>
                                        <nb-datepicker #ApartmentValuatorDate></nb-datepicker>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentValuatorRepresentativeLandBuilding">Valuator Representative Name</label>
                                        <input class="form-control rounded" formControlName="ApartmentValuatorRepresentative"
                                               id="ApartmentValuatorRepresentativeLandBuilding"
                                               name="ApartmentValuatorRepresentativeLandBuilding" placeholder="Valuator Representative Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentStaffRepresentativeNameLandBuilding">Staff Representative Name</label>
                                        <input class="form-control rounded" formControlName="ApartmentStaffRepresentativeName"
                                               id="ApartmentStaffRepresentativeNameLandBuilding"
                                               name="ApartmentStaffRepresentativeNameLandBuilding" placeholder="Staff Representative Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Type of property</label>
                                        <select class="form-control rounded" formControlName="typeOfProperty"
                                                name="typeOfProperty">
                                            <option [value]="null" hidden>Select Type of property</option>
                                            <option *ngFor="let property of typeOfProperty" [value]="property">{{property}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title" for="landStaffRepresentativeName">Mode of transfer</label>
                                        <input class="form-control rounded" formControlName="modeOfTransfer"
                                               name="modeOfTransfer" placeholder="Mode of transfer"
                                               type="text"/>
                                    </div>
                                </div>
                                <div *ngIf="securityForm.get('landBuilding')['length'] > 1"
                                     class="col-md-1 pt-4">
                                    <input (click)="removeLandBuildingDetails(i)"
                                           class="align-self-end btn btn-sm btn-danger btn-primary"
                                           type="button" value="Delete"/>
                                </div>

                            </div>
                        </ng-template>
                        <ng-template [ngTemplateOutlet]="apartment"></ng-template>
                    </div>
                    <hr>
                </div>

            </div>
            <div class="text-right">
                <input (click)="addLandBuilding()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add Building"/>
            </div>

            <div class="row">
                <div class="form-group">
                    <label class="title ml-3" for="landBuildingDescription">Building Details
                        Description</label>
                    <textarea class="form-control ml-3 rounded" cols="95" formControlName="landBuildingDescription"
                              id="landBuildingDescription"
                              placeholder="Buliding Description"
                              rows="5"></textarea>
                </div>
            </div>

            <div [hidden]="!underBuildingConstructionChecked">
                <div *ngFor="let building of securityForm.get('landBuildingUnderConstruction')['controls']; let i = index"
                     class="font-weight-bold"
                     formArrayName="landBuildingUnderConstruction">
                    <div [formGroupName]="i">
                        <div class="box-header with-border">
                            <h2 class="box-title title">Building Details Before Completion</h2>
                        </div>
                        <div formGroupName="buildingDetailsBeforeCompletion">
                            <ng-template #build>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="bNameLandBuilding">Building Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="bNameLandBuilding"
                                                   name="bNameLandBuilding" placeholder="name of building"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDescriptionLandBuilding">Building
                                                Description</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDescription"
                                                   id="descriptioinLandBuilding"
                                                   name="buildingDescriptionLandBuilding" placeholder="building description"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildAreaLandBuilding">Build Up Area (Sq.ft)</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'landBuildingBefore')" class="form-control rounded" formControlName="buildArea"
                                                   id="areaLandBuilding"
                                                   name="buildAreaLandBuilding" placeholder="build up area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildRateLandBuilding">Build Up Area Rate</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'landBuildingBefore')" class="form-control rounded" formControlName="buildRate"
                                                   id="rateLandBuilding"
                                                   name="buildRateLandBuilding" placeholder="build up rate"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="totalCostLandBuilding">Total Cost</label>
                                            <input class="form-control rounded" formControlName="totalCost"
                                                   id="costLandBuilding"
                                                   name="totalCostLandBuilding" placeholder="total cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="floorNameLandBuilding">Floor Name</label>
                                            <input class="form-control rounded" formControlName="floorName"
                                                   id="fnameLandBuilding"
                                                   name="floorNameLandBuilding" placeholder="First Floor,Second....."
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="valuationAreaLandBuilding">Valuation Taken Area
                                                (Sq.ft)</label>
                                            <input (input)="calculateEstimatedCost(i,'landBuildingBefore')" class="form-control rounded" formControlName="valuationArea"
                                                   id="vAreaLandBuilding"
                                                   name="valuationAreaLandBuilding" placeholder="Valuation Taken Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="ratePerSquareFeetLandBuilding">Rate per Square
                                                Feet</label>
                                            <input (input)="calculateEstimatedCost(i,'landBuildingBefore')" class="form-control rounded" formControlName="ratePerSquareFeet"
                                                   id="ratepsfLandBuilding"
                                                   name="ratePerSquareFeetLandBuilding" placeholder="Rate per Square Feet"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="estimatedCostLandBuilding">Estimated Cost</label>
                                            <input class="form-control rounded" formControlName="estimatedCost"
                                                   id="estCostLandBuilding"
                                                   name="estimatedCostLandBuilding" placeholder="Estimated Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply</label>
                                            <input class="form-control rounded" formControlName="waterSupply"
                                                   id="supplyLandBuilding"
                                                   name="waterSupply" placeholder="Water Supply"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitation">Sanitation</label>
                                            <input class="form-control rounded" formControlName="sanitation"
                                                   id="sanLandBuilding"
                                                   name="sanitation" placeholder="Sanitation"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrification">Electrification</label>
                                            <input class="form-control rounded" formControlName="electrification"
                                                   id="eleLandBuilding"
                                                   name="electrification" placeholder="Electrification"
                                                   type="text"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingTotalCost">Building Total Cost</label>
                                            <input class="form-control rounded" formControlName="buildingTotalCost"
                                                   id="tcLandBuilding"
                                                   name="buildingTotalCost" placeholder="Building total cost"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingFairMarketValue">Building Fair Market
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingFairMarketValue"
                                                   id="fmvLandBuilding"
                                                   name="buildingFairMarketValue" placeholder="Building FMV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDistressValue">Building Distress
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDistressValue"
                                                   id="dvLandBuilding"
                                                   name="buildingDistressValue" placeholder="Building DV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title">Type of property</label>
                                            <select class="form-control rounded" formControlName="typeOfProperty"
                                                    name="typeOfProperty">
                                                <option [value]="null" hidden>Select Type of property</option>
                                                <option *ngFor="let property of typeOfProperty" [value]="property">{{property}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="landStaffRepresentativeName">Mode of transfer</label>
                                            <input class="form-control rounded" formControlName="modeOfTransfer"
                                                   name="modeOfTransfer" placeholder="Mode of transfer"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <hr>
                                </div>
                            </ng-template>
                            <ng-template [ngTemplateOutlet]="build"></ng-template>
                        </div>
                        <hr>

                        <div class="box-header with-border">
                            <h2 class="box-title title">Building Details After Completion</h2>
                            <div formGroupName="buildingDetailsAfterCompletion">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingName">Building Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="afterNameLandBuilding"
                                                   name="buildingName" placeholder="name of building"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDescription">Building
                                                Description</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDescription"
                                                   id="afterDescLandBuilding"
                                                   name="buildingDescription" placeholder="building description"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'landBuildingAfter')" class="form-control rounded" formControlName="buildArea"
                                                   id="afterAreaLandBuilding"
                                                   name="buildArea" placeholder="build up area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildRate">Build Up Area Rate</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'landBuildingAfter')" class="form-control rounded" formControlName="buildRate"
                                                   id="afterbuildRateLandBuilding"
                                                   name="buildRate" placeholder="build up rate"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="totalCost">Total Cost</label>
                                            <input class="form-control rounded" formControlName="totalCost"
                                                   id="afterTcLandBuilding"
                                                   name="totalCost" placeholder="total cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="floorName">Floor Name</label>
                                            <input class="form-control rounded" formControlName="floorName"
                                                   id="afterFloorNameLandBuilding"
                                                   name="floorName" placeholder="First Floor,Second....."
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="valuationArea">Valuation Taken Area
                                                (Sq.ft)</label>
                                            <input (input)="calculateEstimatedCost(i,'landBuildingAfter')" class="form-control rounded" formControlName="valuationArea"
                                                   id="afterVALandBuilding"
                                                   name="valuationArea" placeholder="Valuation Taken Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="ratePerSquareFeet">Rate per Square
                                                Feet</label>
                                            <input (input)="calculateEstimatedCost(i,'landBuildingAfter')" class="form-control rounded" formControlName="ratePerSquareFeet"
                                                   id="afterRateLandBuilding"
                                                   name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="estimatedCost">Estimated Cost</label>
                                            <input class="form-control rounded" formControlName="estimatedCost"
                                                   id="afterEstCostLandBuilding"
                                                   name="estimatedCost" placeholder="Estimated Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply</label>
                                            <input class="form-control rounded" formControlName="waterSupply"
                                                   id="afterSupplyLandBuilding"
                                                   name="waterSupply" placeholder="Water Supply"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitation">Sanitation</label>
                                            <input class="form-control rounded" formControlName="sanitation"
                                                   id="afterSanitationLandBuilding"
                                                   name="sanitation" placeholder="Sanitation"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrification">Electrification</label>
                                            <input class="form-control rounded" formControlName="electrification"
                                                   id="afterElectrificationLandBuilding"
                                                   name="electrification" placeholder="Electrification"
                                                   type="text"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingTotalCost">Building Total Cost</label>
                                            <input class="form-control rounded" formControlName="buildingTotalCost"
                                                   id="afterbuildTcLandBuilding"
                                                   name="buildingTotalCost" placeholder="Building total cost"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingFairMarketValue">Building Fair Market
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingFairMarketValue"
                                                   id="afterFMVLandBuilding"
                                                   name="buildingFairMarketValue" placeholder="Building FMV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDistressValue">Building Distress
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDistressValue"
                                                   id="afterDVLandBuilding"
                                                   name="buildingDistressValue" placeholder="Building DV"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title">Type of property</label>
                                            <select class="form-control rounded" formControlName="typeOfProperty"
                                                    name="typeOfProperty">
                                                <option [value]="null" hidden>Select Type of property</option>
                                                <option *ngFor="let property of typeOfProperty" [value]="property">{{property}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="landStaffRepresentativeName">Mode of transfer</label>
                                            <input class="form-control rounded" formControlName="modeOfTransfer"
                                                   name="modeOfTransfer" placeholder="Mode of transfer"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div *ngIf="securityForm.get('landBuildingUnderConstruction')['length'] > 1"
                                         class="col-md-1 pt-4">
                                        <input (click)="removeLandBuildingUnderConstructions(i)"
                                               class="align-self-end btn btn-sm btn-danger btn-primary"
                                               type="button" value="Delete"/>
                                    </div>

                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <input (click)="addLandBuildingUnderConstruction()" class="btn btn-sm btn-flat btn-primary"
                           type="button"
                           value="Add Building Under Construction"/>
                </div>
            </div>
        </nb-card>

        <!--Plant and Machinery Security-->
        <nb-card [hidden]="!plantSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Details Of Plant And Machinery Security Before Completion</h2>
            </div>
            <div *ngFor="let plant of securityForm.get('plantDetails')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="plantDetails">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="model">Model No.</label>
                                <input class="form-control rounded" formControlName="model"
                                       name="model" placeholder="Model No."
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="quotation">Quotation Amount</label>
                                <input class="form-control rounded" formControlName="quotation"
                                       id="quotation"
                                       name="quotation" placeholder="Quotation Amount"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="supplier">Supplier</label>
                                <input class="form-control rounded" formControlName="supplier"
                                       id="supplier"
                                       name="supplier" placeholder="Supplier"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="downPay">Down payment</label>
                                <input class="form-control rounded" formControlName="downPay"
                                       id="downPay"
                                       name="downPay" placeholder="Down payment"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="loanExp">Loan Exposure</label>
                                <input class="form-control rounded" formControlName="loanExp"
                                       id="loanExp"
                                       name="loanExp" placeholder="0.00"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div *ngIf="otherBranchcheck">
                                <div class="form-group">
                                    <label>Select Branch</label>
                                    <ng-select
                                        (change)="valuator(securityForm.get(['plantDetails',i,'plantBranch']).value.id,'plant',i)"
                                        [multiple]="false"
                                        bindLabel="name"
                                        formControlName="plantBranch"
                                        placeholder="">
                                        <ng-option *ngFor="let branch of branchLists"
                                                   [value]="branch">{{branch.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Valuator Name</label>
                                <ng-select [multiple]="false"
                                           bindLabel="name"
                                           placeholder=""
                                           formControlName="plantMachineryValuator" (click)="valuator(null,'plant',i)">
                                    <ng-option *ngFor="let valuator of securityValuator.plantValuator[i]" [value]="valuator">{{valuator.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryValuatorDate">Valuated Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded" formControlName="plantMachineryValuatorDate"
                                       id="plantMachineryValuatorDate"
                                       name="plantMachineryValuatorDate" placeholder="Valuated Date"
                                       [nbDatepicker]="plantMachineryValuatorDate"
                                       type="text"/>
                                <app-calendar
                                    (messageToEmit)="securityForm.get(['plantDetails',i,'plantMachineryValuatorDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="securityForm.get(['plantDetails',i,'plantMachineryValuatorDate']).value"></app-calendar>
                                <nb-datepicker #plantMachineryValuatorDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryValuatorRepresentative">Valuator Representative Name</label>
                                <input class="form-control rounded" formControlName="plantMachineryValuatorRepresentative"
                                       id="plantMachineryValuatorRepresentative"
                                       name="plantMachineryValuatorRepresentative" placeholder="Valuator Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryStaffRepresentativeName">Staff Representative Name</label>
                                <input class="form-control rounded" formControlName="plantMachineryStaffRepresentativeName"
                                       id="plantMachineryStaffRepresentativeName"
                                       name="plantMachineryStaffRepresentativeName" placeholder="Staff Representative Name"
                                       type="text"/>
                            </div>
                        </div>

                        <div *ngIf="securityForm.get('plantDetails')['length'] > 1" class="col-md-1 pt-4">
                            <input (click)="removePlantDetails(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addPlantandMachinery()" class="btn btn-sm btn-flat btn-primary"
                       type="button"
                       value="Add Plant and Machine"/>
            </div>
        </nb-card>
        <!-- Vehicle Security -->
        <nb-card [hidden]="!vehicleSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Vehicle Security</h2>
            </div>
            <div
                *ngFor="let addMoreVehicle of securityForm.get('vehicleDetails')['controls']; let i = index"
                class="font-weight-bold"
                formArrayName="vehicleDetails">
                <div [formGroupName]="i">
                    <br>
                    <div class="row">
                        <div class="col-md-10">
                            <h5>{{i + 1}}) Details of Security Offered: Vehicle</h5>
                        </div>
                        <div *ngIf="securityForm.get('vehicleDetails')['length']>1"
                             class="col-md-2 ">
                            <button (click)="removeVehicleDetails(i)"
                                    class="float-right btn tbn-sm btn-flat btn-danger" value="Delete">
                                <em class="fa fa-trash" style="color: white;"></em>

                            </button>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="model"><strong>Model</strong></label>
                                <input
                                    class="form-control" formControlName="model" id="model" name="model"
                                    placeholder="Model"
                                    type="text">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="registrationNumber"><strong>Registration
                                    Number</strong></label>
                                <input
                                    class="form-control" formControlName="registrationNumber"
                                    id="registrationNumber"
                                    name="registrationNumber" placeholder="Registration Number"
                                    type="number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="registrationDate"><strong>Registration
                                    Date</strong></label>
                                <input
                                    [nbDatepicker]="registrationDate"
                                    class="form-control" formControlName="registrationDate" fullWidth
                                    id="registrationDate" name="registrationDate"
                                    nbInput placeholder="Registration Date">
                                <nb-datepicker #registrationDate></nb-datepicker>
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="engineNumber"><strong>Engine Number</strong></label>
                                <input
                                    class="form-control" formControlName="engineNumber" id="engineNumber"
                                    name="model"
                                    placeholder="Engine Number" type="text">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="chassisNumber"><strong>Chassis Number</strong></label>
                                <input
                                    class="form-control" formControlName="chassisNumber" id="chassisNumber"
                                    name="chassisNumber"
                                    placeholder="Chassis Number" type="text">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="valuationAmount"><strong>Valuation
                                    Amount</strong></label>
                                <input
                                    class="form-control" formControlName="valuationAmount" id="valuationAmount"
                                    name="valuationAmount"
                                    placeholder="Valuation Amount" type="number">
                            </div>
                        </div>


                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="downPayment"><strong>Down Payment</strong></label>
                                <input
                                    class="form-control" formControlName="downPayment" id="downPayment"
                                    name="downPayment"
                                    placeholder="Down Payment" type="text">
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="loanExposure"><strong>Loan Exposure(%)</strong></label>
                                <input
                                    class="form-control" formControlName="loanExposure" id="loanExposure"
                                    name="loanExposure"
                                    placeholder="Loan Exposure" type="number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="showroomCommission"><strong>Showroom
                                    Commission</strong></label>
                                <input
                                    class="form-control" formControlName="showroomCommission"
                                    id="showroomCommission"
                                    name="showroomCommission" placeholder="Showroom Commission"
                                    type="number">
                            </div>
                        </div>
                    </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div *ngIf="otherBranchcheck">
                                    <div class="form-group">
                                        <label>Select Branch</label>
                                        <ng-select
                                            (change)="valuator(securityForm.get(['vehicleDetails',i,'vehicalBranch']).value.id,'vehicle',i)"
                                            [multiple]="false"
                                            bindLabel="name"
                                            formControlName="vehicalBranch"
                                            placeholder="">
                                            <ng-option *ngFor="let branch of branchLists"
                                                       [value]="branch">{{branch.name}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Valuator Name</label>
                                <ng-select [multiple]="false"
                                           bindLabel="name"
                                           placeholder=""
                                           formControlName="vehicalValuator" (click)="valuator(null,'vehicle',i)">
                                    <ng-option *ngFor="let valuator of securityValuator.vehicalValuator[i]" [value]="valuator">{{valuator.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalValuatorDate">Valuated Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded" formControlName="vehicalValuatorDate"
                                       id="vehicalValuatorDate"
                                       name="vehicalValuatorDate" placeholder="Valuated Date"
                                       [nbDatepicker]="vehicalValuatorDate"
                                       type="text"/>
                                <app-calendar
                                    (messageToEmit)="securityForm.get(['vehicleDetails',i,'vehicalValuatorDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="securityForm.get(['vehicleDetails',i,'vehicalValuatorDate']).value"></app-calendar>
                                <nb-datepicker #vehicalValuatorDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalValuatorRepresentative">Valuator Representative Name</label>
                                <input class="form-control rounded" formControlName="vehicalValuatorRepresentative"
                                       id="vehicalValuatorRepresentative"
                                       name="vehicalValuatorRepresentative" placeholder="Valuator Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalStaffRepresentativeName">Staff Representative Name</label>
                                <input class="form-control rounded" formControlName="vehicalStaffRepresentativeName"
                                       id="vehicalStaffRepresentativeName"
                                       name="vehicalStaffRepresentativeName" placeholder="Staff Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <hr>
                </div>
            </div>
            <div class="text-right">
                <input (click)="addVehicleSecurity()" class="btn btn-sm btn-flat btn-primary"
                       type="button"
                       value="Add More"/>
            </div>
        </nb-card>
        <!-- Fixed Deposit Receipt -->
        <nb-card [hidden]="!depositSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Fixed Deposit Receipt</h2>
            </div>
            <div *ngFor="let deposit of securityForm.get('fixedDepositDetails')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="fixedDepositDetails">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-12">
                            <hr>
                            <div *ngIf="i > 0" class="float-right">
                                <input (click)="removeFixedDeposit(i)" class="btn btn-sm btn-flat btn-danger"
                                       type=button value="Delete"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">FD Receipt Number<strong></strong></label>
                                <input class="form-control" formControlName="receiptNumber">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Amount<strong></strong></label>
                                <input class="form-control" formControlName="amount" type="number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Expiry Date<strong></strong></label>
                                <input *ngIf="calendarType === 'AD'" [nbDatepicker]="expiryDate"
                                       class="form-control rounded" formControlName="expiryDate"
                                       nbInput placeholder="Expiry Date">
                                <app-calendar *ngIf="calendarType === 'BS'"
                                              (messageToEmit)="securityForm.get(['fixedDepositDetails',i,'expiryDate']).patchValue($event?.eDate)"
                                              [ePreDate]="securityForm.get(['fixedDepositDetails',i,'expiryDate']).value"></app-calendar>
                                <nb-datepicker #expiryDate></nb-datepicker>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Coupon Rate<strong></strong></label>
                                <input class="form-control" formControlName="couponRate" type="number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Beneficiary<strong></strong></label>
                                <input class="form-control" formControlName="beneficiary">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Remarks<strong></strong></label>
                                <input class="form-control" formControlName="remarks">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-right">
                <input (click)="addFixedDeposit()" class="btn btn-sm btn-flat btn-primary"
                       type="button"
                       value="Add More"/>
            </div>
        </nb-card>

        <!-- Share Security -->
        <nb-card [hidden]="!shareSelected" class="p-3" [formGroup]="shareSecurityForm">
            <nb-card-header>
                <h6 class="box-title title">Details of security offered and valuation amount</h6>
            </nb-card-header>
            <nb-card-body>
                <div class="row">
                    <div class="col-md-3">
                        <label for="promoter"><b>Loan Promoter Percent</b></label>
                        <input [(ngModel)]="activeNepseMaster.promoter"
                               [ngModelOptions]="{standalone: true}" class="form-control"
                               disabled id="promoter">
                    </div>

                    <div class="col-md-3">
                        <label for="ordinary"><b>Loan Ordinary Percent</b></label>
                        <input [(ngModel)]="activeNepseMaster.ordinary"
                               [ngModelOptions]="{standalone: true}" class="form-control"
                               disabled id="ordinary">
                    </div>
                </div>
                <br>
                <div
                        *ngFor="let shareField of shareSecurityForm.get('shareSecurityDetails')['controls'];  let shareFieldIndex = index"
                        formArrayName="shareSecurityDetails">
                    <div [formGroupName]="shareFieldIndex">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="companyName">Select Company Name :: Company Code</label>
                                    <select (change)="setShareValueByCompany(shareFieldIndex)"
                                            [ngClass]="{ 'is-invalid': (submitted) && shareField.get('companyName').errors }"
                                            class="custom-select"
                                            formControlName="companyName" id="companyName"
                                            name="companyName">
                                        <option [value]="null" disabled selected>--Select Company Name--
                                        </option>
                                        <option *ngFor="let nepse of nepseList"
                                                value="{{nepse.companyName }}">{{nepse.companyName}}
                                            :: {{nepse.companyCode}}</option>
                                    </select>
                                    <div *ngIf="submitted && shareField.get('companyName').errors"
                                         class="invalid-feedback">
                                        <div *ngIf="shareField.get('companyName').errors.required">
                                            Company name is required
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="shareType">Select Share Type</label>
                                    <input class="form-control" formControlName="shareType" id="shareType"
                                           name="shareType" readonly type="text">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="totalShareUnit">Number of Share Unit</label>
                                    <input (change)="calculateShareFieldsValues(shareFieldIndex)"
                                           [ngClass]="{ 'is-invalid': (submitted) && shareField.get('totalShareUnit').errors }"
                                           class="form-control" formControlName="totalShareUnit"
                                           id="totalShareUnit"
                                           name="totalShareUnit"
                                           type="number">
                                    <div *ngIf="submitted && shareField.get('totalShareUnit').errors"
                                         class="invalid-feedback">
                                        <div *ngIf="shareField.get('totalShareUnit').errors.required">
                                            No. of share unit is required
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="shareRate">Rate of Each Unit</label>
                                    <input
                                            (change)="calculateShareFieldsValues(shareFieldIndex)"
                                            class="form-control" formControlName="amountPerUnit"
                                            id="shareRate" name="shareRate" readonly
                                            type="number">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="total">Total</label>
                                    <input class="form-control" formControlName="total" id="total"
                                           name="total" readonly type="number">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="consideredValue">Considered Value</label>
                                    <input class="form-control" formControlName="consideredValue"
                                           id="consideredValue" name="total" readonly>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="shareSecurityForm.get('shareSecurityDetails')['length'] > 1"
                             class="d-flex justify-content-sm-end">
                            <button (click)="removeShareList(shareFieldIndex)"
                                    class="btn btn-sm btn-flat btn-danger">
                                <em class="fa fa-trash bg-transparent"></em>
                            </button>
                        </div>
                        <hr/>
                    </div>
                </div>
                <div class="d-flex justify-content-sm-end">
                    <p class="font-weight-bolder">Total Considered
                        Value: {{totalConsideredValue}}</p>
                </div>
                <div class="d-flex justify-content-end">
                    <button (click)="addShareSecurity()" class="btn btn-sm btn-flat btn-primary"><i
                            class="fa fa-plus"></i></button>
                </div>
            </nb-card-body>
            <nb-card>
                <nb-card-body>
                    <div class="row">
                        <div class="col-md-12">
                            <label for="securityOffered">Description/Details of security offered</label>
                            <textarea class="form-control text-area" formControlName="securityOffered"
                                      id="securityOffered"></textarea>
                        </div>
                    </div>
                </nb-card-body>
            </nb-card>
        </nb-card>

        <nb-card [hidden]="!hypothecation" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Hypothecation of Stock</h2>
            </div>
            <div *ngFor="let hypothecation of securityForm.get('hypothecationOfStock')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="hypothecationOfStock">
                <div [formGroupName]="i">
                    <div class="row">

                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="title" for="description">Description</label>
                                <textarea class="form-control rounded" formControlName="description"
                                          placeholder="Description" rows="5"
                                          type="text"></textarea>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Owner</label>
                                <input class="form-control rounded" formControlName="owner"
                                       placeholder="Owner"
                                       type="text"/>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Stock Location</label>
                                <input class="form-control rounded" formControlName="stock"
                                       placeholder="Stock Location"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Value</label>
                                <input class="form-control rounded" formControlName="value"
                                       placeholder="Value"
                                       type="number"/>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>

                        <div *ngIf="securityForm.get('hypothecationOfStock') ['length'] > 1" class="col-md-1">
                            <input (click)="removeHypothecation(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addHypothecationOfStock()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add More Hypothecation Of Stock"/>
            </div>
        </nb-card>

        <nb-card [hidden]="!corporate" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Corporate Guarantee</h2>
            </div>
            <div *ngFor="let corporate of securityForm.get('corporateGuarantee')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="corporateGuarantee">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Name of Guarantor</label>
                                <input class="form-control rounded" formControlName="name"
                                       placeholder="Name of Guarantor"
                                       type="text"/>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Address</label>
                                <input class="form-control rounded" formControlName="address"
                                       placeholder="Address"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Key person </label>
                                <input class="form-control rounded" formControlName="keyPerson"
                                       placeholder="Key person "
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Email address </label>
                                <input class="form-control rounded" formControlName="email"
                                       placeholder="Email address"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="description">Phone number</label>
                                <input class="form-control rounded" formControlName="phoneNumber"
                                       placeholder="Phone number"
                                       type="number"/>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>

                        <div *ngIf="securityForm.get('corporateGuarantee') ['length'] > 1" class="col-md-1">
                            <input (click)="removeCorporate(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addCorporateGuarantee()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add More Corporate Guarantee"/>
            </div>
        </nb-card>

        <nb-card [hidden]="!personal" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Personal Guarantee</h2>
            </div>
            <div *ngFor="let personalGuarantee of securityForm.get('personalGuarantee')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="personalGuarantee">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Name of Guarantor</label>
                                <input class="form-control rounded" formControlName="name"
                                       placeholder="Name of Guarantor"
                                       type="text"/>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Address </label>
                                <input class="form-control rounded" formControlName="address"
                                       placeholder="Address "
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Email address</label>
                                <input class="form-control rounded" formControlName="email"
                                       placeholder="Email address"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="description">Phone number</label>
                                <input class="form-control rounded" formControlName="phoneNumber"
                                       placeholder="Phone number"
                                       type="number"/>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>
                        <div *ngIf="securityForm.get('personalGuarantee') ['length'] > 1" class="col-md-1">
                            <input (click)="removePersonal(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addPersonalGuarantee()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add MorePersonal Guarantee"/>
            </div>
        </nb-card>

        <div class="row">
            <div class="col-md-12">
                <label><b>Remarks</b></label>
                <textarea class="form-control" formControlName="remark" rows="4" placeholder="Remarks Common to all Security"></textarea>
            </div>
        </div>
    </form>
</div>
