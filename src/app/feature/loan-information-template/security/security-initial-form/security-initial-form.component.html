<div *ngIf="formDataForEdit !== undefined" class="row col-md-12">
    <app-security-table [shareSecurity]="shareSecurity" [formDataForEdit]="this.formData['initialForm']"
                        (securityEmitter)="resetSecurityForm($event)" [selectedArray]="this.formData['selectedArray']"></app-security-table>
</div>
<div class="form-group" [nbSpinner]="spinner">
    <form [formGroup]="securityForm">
        <!--START ROW-->
        <div class="font-weight-bold">
            <!--END ROW-->
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Choose Security Type</label>
                        <select class="form-control" (change)="change(selectedSecurity)" [(ngModel)]="selectedSecurity"
                        (ngModelChange)="clearValidationState()"
                        [ngModelOptions]="{standalone: true}">
                            <option *ngFor="let type of getSecurities()" [value]="type?.key">
                                {{type?.value}}
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            <hr>
        </div>
        <!--        <nb-checkbox (change)="otherBranch($event.target.checked)"-->
        <!--                     [checked]="otherBranchcheck">Property on another branch location-->
        <!--        </nb-checkbox>-->
        <!--Land Security-->
        <nb-card [hidden]="!landSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Details of Security Offered and Value Amount : LAND</h2>
            </div>
            <div *ngFor="let land of securityForm.get('landDetails')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="landDetails">
                <div [formGroupName]="i">
                    <input type="checkbox" formControlName="landOtherBranchChecked"> Property on another branch location
                    <div class="row justify-content-end">
                        <button class="btn btn-primary sb-small mr-2"
                                (click)="openSiteVisitModel('Land Security'+' '+(i+1))">Inspect Site Visit</button>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="owner"><strong>Owner</strong></label>
                                <input [ngClass]="{ 'is-invalid': (landSelected) && (land.get('owner').errors || land.get('owner').invalid) }"
                                        class="form-control form-control-sm-error rounded" formControlName="owner"
                                        id="owner" name="owner" placeholder="Owner Name" type="text" required/>
                                <div *ngIf="(landSelected) && (land.get('owner').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="land.get('owner').errors.required">
                                        Owner name is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="location">Location</label>
                                <input class="form-control rounded" formControlName="location"
                                       id="location"
                                       name="location" placeholder="Location"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="title" for="plotNumber">Plot No.</label>
                                <input class="form-control rounded" formControlName="plotNumber"
                                       id="plotNumber"
                                       name="plotNumber" placeholder="Plot No."
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="title" for="areaFormat">Area Format</label>
                                <!--  <input class="form-control rounded" formControlName="areaFormat"
                                         id="areaFormat"
                                         name="areaFormat" placeholder="area format"
                                         type="text"/>-->
                                <nb-select formControlName="areaFormat" placeholder="select area format" id="areaFormat"
                                           fullWidth>
                                    <nb-option *ngFor="let format of areaFormat" [value]="format">{{format}}</nb-option>
                                </nb-select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label class="title" for="area">Area</label>
                                <input class="form-control rounded" formControlName="area"
                                       id="ba"
                                       name="area" placeholder="Area"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="landConsideredValue">Considered Value</label>
                                <input (change)="updateLandSecurityTotal()"
                                       [ngClass]="{ 'is-invalid': (landSelected) && (land.get('landConsideredValue').errors ||
                                    land.get('landConsideredValue').invalid) }"
                                       class="form-control"
                                       formControlName="landConsideredValue"
                                       id="landConsideredValue" name="total" placeholder="Considered Value">
                                <div *ngIf="(landSelected) && (land.get('landConsideredValue').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="land.get('landConsideredValue').errors.required">
                                        Considered value is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="marketValue">Fair Market Value</label>
                                <input (change)="updateLandSecurityTotal()"
                                       class="form-control rounded"
                                       formControlName="marketValue"
                                       id="marketValue"
                                       name="marketValue" placeholder="Fair Market Value"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="distressValue">{{client === clientName?.EXCEL ? 'Market Value' : 'Distress Value'}}</label>
                                <input (change)="updateLandSecurityTotal(i)"
                                       class="form-control rounded"
                                       formControlName="distressValue"
                                       id="distressValue"
                                       [placeholder]="(client === clientName?.EXCEL) ? 'Market Value' : 'Distress Value'"
                                       name="distressValue"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div *ngIf="securityForm.get(['landDetails',i,'landOtherBranchChecked']).value">
                                <div class="form-group">
                                    <label>Select Branch</label>
                                    <ng-select
                                            (change)="valuator(securityForm.get(['landDetails',i,'landBranch']).value.id,'land',i)"
                                            [multiple]="false"
                                            bindLabel="name"
                                            formControlName="landBranch"
                                            placeholder="">
                                        <ng-option *ngFor="let branch of branchLists"
                                                   [value]="branch">{{branch.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="title" for="landCollateralOwnerRelationship">Collateral Owner
                                    Relationship</label>
                                <select class="form-control rounded" formControlName="landCollateralOwnerRelationship"
                                        id="landCollateralOwnerRelationship"
                                        name="landCollateralOwnerRelationship">
                                    <option [ngValue]="null">--Select Relationship--</option>
                                    <option *ngFor="let relationship of collateralOwnerRelationshipList.relation"
                                            [ngValue]="relationship.id">{{relationship.name}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="title" for="roadAccessBluePrintLand">Is road access seen in blueprint or
                                    not</label>
                                <select class="form-control rounded"
                                        formControlName="roadAccessBluePrint"
                                        id="roadAccessBluePrintLand">
                                    <option [ngValue]="null">--Select Road Access--</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 form-group">
                            <label for="roadAccessDescribeLand"><strong>Briefly describe the road access</strong></label>
                            <textarea class="form-control"
                                      formControlName="roadAccessDescribe"
                                      id="roadAccessDescribeLand"
                                      placeholder="Briefly describe the road access"
                                      rows="5"
                                      type="text"></textarea>
                        </div>
                        <div class="col-md-6 form-group">
                            <label for="landSecurityLegalDocumentAddress"><strong>Address as per Legal Document</strong></label>
                            <textarea class="form-control"
                                      formControlName="landSecurityLegalDocumentAddress"
                                      id="landSecurityLegalDocumentAddress"
                                      name="landSecurityLegalDocumentAddress"
                                      placeholder="Address as per Legal Document"
                                      rows="5"
                                      type="text" maxlength="256"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group form-inline">
                                <nb-checkbox id="ownerKycInfoForLand{{i}}" class="ml-2"
                                             formControlName="kycCheckForLand"
                                             (checkedChange)="ownerKycRelationInfoCheck(securityForm.get(['landDetails', i,
                                              'kycCheckForLand']).value, 'land', i)">
                                    <h6>Owner KYC Applicable</h6>
                                </nb-checkbox>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" *ngIf="securityForm.get(['landDetails', i, 'kycCheckForLand']).value === true">
                        <label>
                            <mark><strong>Note</strong>: <em>Please write <strong>Late</strong> in front of the name if
                                relation person is deceased</em></mark>
                        </label>

                        <app-owner-kyc-applicable #ownerKycApplicable
                                                  [data]="formDataForEdit?.landDetails[i]?.ownerKycApplicableData"
                                                  [calendarType]="calendarType"
                                                  [kycId]="securityId.landId + i"></app-owner-kyc-applicable>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Valuator Name</label>
                                <ng-select [multiple]="false"
                                           bindLabel="name"
                                           placeholder=""
                                           formControlName="landValuator" (click)="valuator(null,'land',i)">
                                    <ng-option [value]="null">--Select Valuator Name--</ng-option>
                                    <ng-option *ngFor="let valuator of securityValuator.landValuator[i]"
                                               [value]="valuator">{{valuator.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landValuatorDate">Valuated Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                       formControlName="landValuatorDate"
                                       id="landValuatorDate"
                                       name="landValuatorDate" placeholder="Valuated Date"
                                       [nbDatepicker]="landValuatorDate"
                                       type="text"/>
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['landDetails',i,'landValuatorDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['landDetails',i,'landValuatorDate']).value"></app-calendar>
                                <nb-datepicker #landValuatorDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landValuatorRepresentative">Valuator Representative
                                    Name</label>
                                <input class="form-control rounded" formControlName="landValuatorRepresentative"
                                       id="landValuatorRepresentative"
                                       name="landValuatorRepresentative" placeholder="Valuator Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landStaffRepresentativeDesignation">Staff Representative
                                    Designation 1</label>
                                <select class="form-control rounded"
                                        formControlName="landStaffRepresentativeDesignation"
                                        id="landStaffRepresentativeDesignation"
                                        name="landStaffRepresentativeDesignation">
                                    <option [ngValue]="null" hidden>Staff Representative Designation 1</option>
                                    <option *ngFor="let designation of designationList"
                                            [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landStaffRepresentativeName">Staff Representative Name
                                    1</label>
                                <input class="form-control rounded" formControlName="landStaffRepresentativeName"
                                       id="landStaffRepresentativeName"
                                       name="landStaffRepresentativeName" placeholder="Staff Representative Name 1"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landStaffRepresentativeDesignation2">Staff Representative
                                    Designation 2</label>
                                <select class="form-control rounded"
                                        formControlName="landStaffRepresentativeDesignation2"
                                        id="landStaffRepresentativeDesignation2"
                                        name="landStaffRepresentativeDesignation2">
                                    <option [ngValue]="null">Staff Representative Designation 2</option>
                                    <option *ngFor="let designation of designationList"
                                            [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="landStaffRepresentativeName2">Staff Representative Name
                                    2</label>
                                <input class="form-control rounded" formControlName="landStaffRepresentativeName2"
                                       id="landStaffRepresentativeName2"
                                       name="landStaffRepresentativeName2" placeholder="Staff Representative Name 2"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">{{client === clientName?.SHINE_RESUNGA ? 'Ownership Type' : 'Type of property'}}</label>
                                <select class="form-control rounded" formControlName="typeOfProperty"
                                        name="typeOfProperty">
                                    <option [value]="null">Select {{client === clientName?.SHINE_RESUNGA ? 'Ownership Type' : 'Type of property'}}</option>
                                    <option *ngFor="let property of typeOfProperty"
                                            [value]="property">{{property}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Ownership transfer date</label>
                                <input class="form-control rounded" formControlName="ownershipTransferDate"
                                       name="ownershipTransferDate" placeholder="Ownership transfer date"
                                       [nbDatepicker]="ownershipDate"
                                       *ngIf="calendarType === 'AD'">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['landDetails',i,'ownershipTransferDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['landDetails',i,'ownershipTransferDate']).value"></app-calendar>
                                <nb-datepicker #ownershipDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Ownership transfer Through</label>
                                <select class="form-control rounded" formControlName="ownershipTransferThrough"
                                        name="ownershipTransferThrough"
                                        (change)="resetOtherTransferParameter('landDetails', i,false)">
                                    <option [value]="null">Select Ownership transfer through</option>
                                    <option *ngFor="let ownership of newOwnerShipTransfer"
                                            [ngValue]="ownership.key">{{ownership.value}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3"
                             *ngIf="securityForm.get(['landDetails',i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.OTHER)">
                            <div class="form-group">
                                <label class="title">Other</label>
                                <input class="form-control rounded" formControlName="otherOwnershipTransferValue"
                                       name="otherOwnershipTransferValue" placeholder="Other Ownership Transfer Mode"
                                       type="text"/>
                            </div>
                        </div>
                        <ng-container>
                            <div class="col-md-12"
                                 *ngIf="securityForm.get(['landDetails' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.SALE)">
                                <strong>Has transfer date elapsed by 6 months plus 35 days? </strong>
                                <input class="ml-md-3" type="radio" value="Yes" formControlName="saleOwnershipTransfer"
                                       (input)="resetOtherTransferParameter('landDetails', i,true)">
                                <label>Yes</label>
                                <input class="ml-md-3" type="radio" value="No" formControlName="saleOwnershipTransfer"
                                       (input)="resetOtherTransferParameter('landDetails', i,true)">
                                <label>No</label>
                            </div>
                            <div class="col-md-12"
                                 *ngIf="securityForm.get(['landDetails' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.FAMILY_SEPARATION)">
                                <strong>Has transfer date elapsed by 3 month? </strong>
                                <input class="ml-md-3" type="radio" value="Yes"
                                       formControlName="familyTransferOwnershipTransfer"
                                       (input)="resetOtherTransferParameter('landDetails', i,true)">
                                <label>Yes</label>
                                <input class="ml-md-3" type="radio" value="No"
                                       formControlName="familyTransferOwnershipTransfer"
                                       (input)="resetOtherTransferParameter('landDetails', i,true)">
                                <label>No</label>
                            </div>
                            <div class="col-md-12"
                                 *ngIf="securityForm.get(['landDetails' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.GIFT_BAKASPATRA)">
                                <strong>Has transfer date elapsed by 2 year plus 35 days? </strong>
                                <input class="ml-md-3" type="radio" value="Yes" formControlName="giftOwnershipTransfer"
                                       (input)="resetOtherTransferParameter('landDetails', i,true)">
                                <label>Yes</label>
                                <input class="ml-md-3" type="radio" value="No" formControlName="giftOwnershipTransfer"
                                       (input)="resetOtherTransferParameter('landDetails', i,true)">
                                <label>No</label>
                            </div>
                        </ng-container>
                        <ng-container>
                            <div class="col-md-12 d-inline-flex"
                                 *ngIf="securityForm.get(['landDetails' , i,'saleOwnershipTransfer']).value === 'No'">
                                <i>*Incase of No, specify registration amount in the transfer deed (as applicable)</i>
                                <input class="form-control col-md-3" formControlName="saleRegistrationAmount"
                                       type="number" placeholder="Amount">
                            </div>
                            <div class="col-md-12 d-inline-flex"
                                 *ngIf="securityForm.get(['landDetails' , i,'familyTransferOwnershipTransfer']).value === 'No'">
                                <i>*Incase of No, specify registration amount in the transfer deed (as applicable)</i>
                                <input class="form-control col-md-3" formControlName="familyRegistrationAmount"
                                       type="number" placeholder="Amount">
                            </div>
                            <div class="col-md-12 d-inline-flex"
                                 *ngIf="securityForm.get(['landDetails' , i,'giftOwnershipTransfer']).value === 'No'">
                                <i>*Incase of No, specify registration amount in the transfer deed (as applicable)</i>
                                <input class="form-control col-md-3" formControlName="giftRegistrationAmount"
                                       type="number" placeholder="Amount">
                            </div>
                        </ng-container>
                        <div class="col-md-12">
                            <app-security-revaluation #revaluationComponent
                                                      [valuators]="securityValuator?.landValuator[i]"
                                                      [oldValuation]="securityForm.get('landDetails').value"
                                                      [data]="formDataForEdit?.landDetails[i]?.revaluationData"
                                                      [revaluationId]="securityId.landId + i"
                                                      [calendarType]="calendarType"
                                                      [index]="i"
                                                      (revaluationDataEmitter)="eventLandSecurity($event, i)"
                            ></app-security-revaluation>
                        </div>
                        <div *ngIf="securityForm.get('landDetails') ['length'] > 1" class="col-md-1">
                            <input (click)="removeLandDetails(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addMoreLand()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add More Land"/>
            </div>
            <div class="row">
                <div class="form-group col-md-12">
                    <label class="title rounded" for="description">Description/Details of Security
                        Offered</label>
                    <textarea class="form-control rounded" cols="150" formControlName="description"
                              id="description"
                              placeholder="details of security offered"
                              rows="5"></textarea>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-12">
                    <table class="table table-bordered">
                        <thead class="thead-light">
                        <tr>
                            <th>Total Considered Value</th>
                            <th>Total Fair Market Value</th>
                            <th>Total {{client === clientName?.EXCEL ? 'Market Value' : 'Distress Value'}}</th>
                            <th>Remarks</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>{{totalcv }}</td>
                            <td>{{totalmv}}</td>
                            <td>{{totaldv}}</td>
                            <td><input type="text" class="form-control" id="totalLandValueRemarks"
                                       formControlName="totalLandValueRemarks"/></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </nb-card>
        <!--Apartment Security-->
        <nb-card [hidden]="!apartmentSelected" class="p-5">
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <nb-checkbox (change)="underConstruction($event.target.checked)"
                                     [checked]="underConstructionChecked">Check if Under Construction
                        </nb-checkbox>
                    </div>
                </div>
            </div>
            <div class="box-header with-border">
                <h2 class="box-title title">Apartment Details</h2>
            </div>
            <div>
                <div *ngFor="let building of securityForm.get('buildingDetails')['controls']; let i = index"
                     class="font-weight-bold"
                     formArrayName="buildingDetails">
                    <div [formGroupName]="i">
                        <div class="row justify-content-end">
                            <button class="btn btn-primary sb-small mr-2"
                                    (click)="openSiteVisitModel('Apartment Security'+' '+(i+1))">Inspect Site Visit</button>
                        </div>
                        <ng-template #apartment>
                            <input type="checkbox" formControlName="apartmentOtherBranchChecked"> Property on another
                            branch location
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingName">Apartment Name</label>
                                        <input class="form-control rounded" formControlName="buildingName"
                                               id="buildingName"
                                               name="buildingName" placeholder="Apartment Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingDescription">Apartment Description</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingDescription"
                                               id="buildingDescription"
                                               name="buildingDescription" placeholder="Apartment Description"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                        <input [ngClass]="{'is-invalid': (apartmentSelected) && (building.get('buildArea').errors)}"
                                                (input)="calculateBuildUpAreaRate(i, 'building')"
                                               class="form-control rounded" formControlName="buildArea"
                                               id="buildArea"
                                               name="buildArea" placeholder="Build Up Area (Sq.ft)"
                                               type="number" required/>
                                        <div *ngIf=" (apartmentSelected) && (building.get('buildArea').invalid)"
                                             class="invalid-feedback">
                                            <div *ngIf="building.get('buildArea').errors.required">
                                                Build up area is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildRate">Build Up Area Rate</label>
                                        <input (input)="calculateBuildUpAreaRate(i,'building')"
                                               class="form-control rounded" formControlName="buildRate"
                                               id="buildRate"
                                               name="buildRate" placeholder="Build Up Area Rate"
                                               type="number"/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="totalCost">Total Cost</label>
                                        <input (ngModelChange)="calculateWaterSupply(i,'building');calculateElectrification(i,'building');calculateSanitation(i,'building')"
                                               class="form-control rounded" formControlName="totalCost"
                                               id="totalCost"
                                               name="totalCost" placeholder="Total Cost"
                                               type="number" readonly/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="floorName">Floor Name</label>
                                        <input class="form-control rounded" formControlName="floorName"
                                               id="floorName"
                                               name="floorName" placeholder="First Floor,Second....."
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="valuationArea">Valuation Taken Area
                                            (Sq.ft)</label>
                                        <input (input)="calculateEstimatedCost(i,'building')"
                                               class="form-control rounded" formControlName="valuationArea"
                                               id="valuationArea"
                                               name="valuationArea" placeholder="Valuation Taken Area"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ratePerSquareFeet">Rate per Square Feet</label>
                                        <input (input)="calculateEstimatedCost(i,'building')"
                                               class="form-control rounded"
                                               formControlName="ratePerSquareFeet"
                                               id="ratePerSquareFeet"
                                               name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="estimatedCost">Estimated Cost</label>
                                        <input class="form-control rounded" formControlName="estimatedCost"
                                               id="estimatedCost"
                                               name="estimatedCost" placeholder="Estimated Cost"
                                               type="number" readonly
                                               (ngModelChange)="calculateTotalApartmentCost(i,'building')"/>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="waterSupply">Water Supply %</label>
                                        <input (input)="calculateWaterSupply(i,'building')" class="form-control rounded"
                                               formControlName="waterSupplyPercent"
                                               id="waterSupplyPercent"
                                               name="waterSupplyPercent" placeholder="Water Supply %"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="waterSupply">Water Supply</label>
                                        <input class="form-control rounded" formControlName="waterSupply"
                                               id="waterSupply"
                                               name="waterSupply" placeholder="Water Supply"
                                               type="number" readonly
                                               (ngModelChange)="calculateTotalApartmentCost(i,'building')"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="sanitationPercent">Sanitation %</label>
                                        <input (input)="calculateSanitation(i,'building')" class="form-control rounded"
                                               formControlName="sanitationPercent"
                                               id="sanitationPercent"
                                               name="sanitationPercent" placeholder="Sanitation %"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="sanitation">Sanitation</label>
                                        <input class="form-control rounded" formControlName="sanitation"
                                               id="sanitation"
                                               name="sanitation" placeholder="Sanitation"
                                               type="number" readonly
                                               (ngModelChange)="calculateTotalApartmentCost(i,'building')"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="electrificationPercent">Electrification %</label>
                                        <input (input)="calculateElectrification(i,'building')"
                                               class="form-control rounded"
                                               formControlName="electrificationPercent"
                                               id="electrificationPercent"
                                               name="electrificationPercent" placeholder="Electrification %"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="electrification">Electrification</label>
                                        <input class="form-control rounded"
                                               formControlName="electrification"
                                               id="electrification"
                                               name="electrification" placeholder="Electrification"
                                               type="number" readonly
                                               (ngModelChange)="calculateTotalApartmentCost(i, 'building')"/>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingTotalCost">Apartment Total Cost</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingTotalCost"
                                               id="buildingTotalCost"
                                               name="buildingTotalCost" placeholder="Apartment Total Cost"
                                               type="number" readonly/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingFairMarketValue">Apartment Fair Market Value</label>
                                        <input [ngClass]="{ 'is-invalid': (apartmentSelected) && (building.get('buildingFairMarketValue').errors ||
                                                building.get('buildingFairMarketValue').invalid) }"
                                                class="form-control rounded"
                                               formControlName="buildingFairMarketValue"
                                               id="buildingFairMarketValue"
                                               name="buildingFairMarketValue" placeholder="Apartment Fair Market Value"
                                               type="text"/>
                                        <div *ngIf="(apartmentSelected) && (building.get('buildingFairMarketValue').invalid)"
                                             class="invalid-feedback">
                                            <div *ngIf="building.get('buildingFairMarketValue').errors.required">
                                                Fair market value is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="buildingDistressValue">Apartment {{client === clientName?.EXCEL ? 'Market Value' : 'Distress Value'}}</label>
                                        <input class="form-control rounded"
                                               formControlName="buildingDistressValue"
                                               id="buildingDistressValue"
                                               [placeholder]="(client == clientName?.EXCEL) ? 'Apartment Market Value' : 'Apartment Distress Value'"
                                               name="buildingDistressValue"
                                               type="text"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div *ngIf="securityForm.get(['buildingDetails',i,'apartmentOtherBranchChecked']).value">
                                        <div class="form-group">
                                            <label>Select Branch</label>
                                            <ng-select
                                                    (change)="valuator(securityForm.get(['buildingDetails',i,'apartmentBranch']).value.id,'apartment',i)"
                                                    [multiple]="false"
                                                    bindLabel="name"
                                                    formControlName="apartmentBranch"
                                                    placeholder="">
                                                <ng-option *ngFor="let branch of branchLists"
                                                           [value]="branch">{{branch.name}}</ng-option>
                                            </ng-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Valuator Name</label>
                                        <ng-select [multiple]="false"
                                                   bindLabel="name"
                                                   placeholder=""
                                                   formControlName="ApartmentValuator"
                                                   (click)="valuator(null,'apartment',i)">
                                            <ng-option [value]="null">--Select Valuator Name--</ng-option>
                                            <ng-option *ngFor="let valuator of securityValuator.apartmentValuator[i]"
                                                       [value]="valuator">{{valuator.name}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentValuatorDate">Valuated Date</label>
                                        <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                               formControlName="ApartmentValuatorDate"
                                               id="ApartmentValuatorDate"
                                               name="ApartmentValuatorDate" placeholder="Valuated Date"
                                               [nbDatepicker]="ApartmentValuatorDate"
                                               type="text"/>
                                        <app-calendar
                                                (messageToEmit)="securityForm.get(['buildingDetails',i,'ApartmentValuatorDate']).patchValue($event?.eDate)"
                                                *ngIf="calendarType === 'BS'"
                                                [ePreDate]="securityForm.get(['buildingDetails',i,'ApartmentValuatorDate']).value"></app-calendar>
                                        <nb-datepicker #ApartmentValuatorDate></nb-datepicker>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentValuatorRepresentative">Valuator Representative Name</label>
                                        <input class="form-control rounded"
                                               formControlName="ApartmentValuatorRepresentative"
                                               id="ApartmentValuatorRepresentative"
                                               name="ApartmentValuatorRepresentative"
                                               placeholder="Valuator Representative Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="apartmentStaffRepresentativeDesignation">Staff
                                            Representative Designation 1</label>
                                        <select class="form-control rounded"
                                                formControlName="apartmentStaffRepresentativeDesignation"
                                                id="apartmentStaffRepresentativeDesignation"
                                                name="apartmentStaffRepresentativeDesignation">
                                            <option [ngValue]="null" hidden>Staff Representative Designation 1</option>
                                            <option *ngFor="let designation of designationList"
                                                    [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="ApartmentStaffRepresentativeName">Staff Representative
                                            Name 1</label>
                                        <input class="form-control rounded"
                                               formControlName="ApartmentStaffRepresentativeName"
                                               id="ApartmentStaffRepresentativeName"
                                               name="ApartmentStaffRepresentativeName"
                                               placeholder="Staff Representative Name 1"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="apartmentStaffRepresentativeDesignation2">Staff
                                            Representative Designation 2</label>
                                        <select class="form-control rounded"
                                                formControlName="apartmentStaffRepresentativeDesignation2"
                                                id="apartmentStaffRepresentativeDesignation2"
                                                name="apartmentStaffRepresentativeDesignation2">
                                            <option [ngValue]="null">Staff Representative Designation 2</option>
                                            <option *ngFor="let designation of designationList"
                                                    [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="title" for="apartmentStaffRepresentativeName2">Staff
                                            Representative Name 2</label>
                                        <input class="form-control rounded"
                                               formControlName="apartmentStaffRepresentativeName2"
                                               id="apartmentStaffRepresentativeName2"
                                               name="apartmentStaffRepresentativeName2"
                                               placeholder="Staff Representative Name 2"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <app-security-revaluation #revaluationComponentApartment
                                                              [valuators]="securityValuator?.buildingValuator[i]"
                                                              [data]="formDataForEdit?.buildingDetails[i]?.revaluationData"
                                                              [oldValuation]="securityForm.get('buildingDetails').value"
                                                              [revaluationId]="securityId.apartmentId + i"
                                                              [calendarType]="calendarType"></app-security-revaluation>
                                </div>
                                <div *ngIf="securityForm.get('buildingDetails')['length'] > 1"
                                     class="col-md-1 pt-4">
                                    <input (click)="removeBuildingDetails(i)"
                                           class="align-self-end btn btn-sm btn-danger btn-primary"
                                           type="button" value="Delete"/>
                                </div>

                            </div>
                        </ng-template>
                        <ng-template [ngTemplateOutlet]="apartment"></ng-template>
                    </div>
                    <hr>
                </div>

            </div>
            <div class="text-right">
                <input (click)="addBuilding()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add Apartment"/>
            </div>

            <div class="row">
                <div class="form-group">
                    <label class="title ml-3" for="buildingDetailsDescription">Apartment Details
                        Description</label>
                    <textarea class="form-control ml-3 rounded" cols="95" formControlName="buildingDetailsDescription"
                              id="buildingDetailsDescription"
                              placeholder="Apartment Details Description"
                              rows="5"></textarea>
                </div>
            </div>

            <div [hidden]="!underConstructionChecked">
                <div *ngFor="let building of securityForm.get('buildingUnderConstructions')['controls']; let i = index"
                     class="font-weight-bold"
                     formArrayName="buildingUnderConstructions">
                    <div [formGroupName]="i">
                        <div class="box-header with-border">
                            <h2 class="box-title title">Apartment Details Before Completion</h2>
                        </div>
                        <div formGroupName="buildingDetailsBeforeCompletion">
                            <ng-template #build>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingName">Apartment Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="bname"
                                                   name="buildingName" placeholder="Apartment Name"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDescription">Apartment
                                                Description</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDescription"
                                                   id="descriptioin"
                                                   name="buildingDescription" placeholder="Apartment Description"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'before')"
                                                   class="form-control rounded" formControlName="buildArea"
                                                   id="area"
                                                   name="buildArea" placeholder="Build Up Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildRate">Build Up Area Rate</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'before')"
                                                   class="form-control rounded" formControlName="buildRate"
                                                   id="rate"
                                                   name="buildRate" placeholder="Build Up Area Rate"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="totalCost">Total Cost</label>
                                            <input (ngModelChange)="calculateSanitation(i,'before');calculateElectrification(i,'before');calculateWaterSupply(i,'before')"
                                                   class="form-control rounded" formControlName="totalCost"
                                                   id="cost"
                                                   name="totalCost" placeholder="Total Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="floorName">Floor Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="fname"
                                                   name="floorName" placeholder="First Floor,Second....."
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="valuationArea">Valuation Taken Area
                                                (Sq.ft)</label>
                                            <input (input)="calculateEstimatedCost(i,'before')"
                                                   class="form-control rounded" formControlName="valuationArea"
                                                   id="vArea"
                                                   name="valuationArea" placeholder="Valuation Taken Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="ratePerSquareFeet">Rate per Square
                                                Feet</label>
                                            <input (input)="calculateEstimatedCost(i,'before')"
                                                   class="form-control rounded" formControlName="ratePerSquareFeet"
                                                   id="ratepsf"
                                                   name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="estimatedCost">Estimated Cost</label>
                                            <input class="form-control rounded" formControlName="estimatedCost"
                                                   id="estCost"
                                                   name="estimatedCost" placeholder="Estimated Cost"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'before')"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply %</label>
                                            <input (input)="calculateWaterSupply(i,'before')"
                                                   class="form-control rounded" formControlName="waterSupplyPercent"
                                                   id="beforeWaterSupplyPercent"
                                                   name="waterSupplyPercent" placeholder="Water Supply %"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply</label>
                                            <input class="form-control rounded" formControlName="waterSupply"
                                                   id="supply"
                                                   name="waterSupply" placeholder="Water Supply"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'before')"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitationPercent">Sanitation %</label>
                                            <input (input)="calculateSanitation(i,'before')"
                                                   class="form-control rounded" formControlName="sanitationPercent"
                                                   id="beforeSanitationPercent"
                                                   name="sanitationPercent" placeholder="Sanitation %"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitation">Sanitation</label>
                                            <input class="form-control rounded" formControlName="sanitation"
                                                   id="san"
                                                   name="sanitation" placeholder="Sanitation"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'before')"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrificationPercent">Electrification %</label>
                                            <input (input)="calculateElectrification(i,'before')"
                                                   class="form-control rounded" formControlName="electrificationPercent"
                                                   id="beforeElectrificationPercent"
                                                   name="electrificationPercent" placeholder="Electrification %"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrification">Electrification</label>
                                            <input class="form-control rounded" formControlName="electrification"
                                                   id="ele"
                                                   name="electrification" placeholder="Electrification"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'before')"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingTotalCost">Apartment Total Cost</label>
                                            <input class="form-control rounded" formControlName="buildingTotalCost"
                                                   id="tc"
                                                   name="buildingTotalCost" placeholder="Apartment Total Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingFairMarketValue">Apartment Fair Market
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingFairMarketValue"
                                                   id="fmv"
                                                   name="buildingFairMarketValue" placeholder="Apartment Fair Market Value"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDistressValue">Apartment Distress
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDistressValue"
                                                   id="dv"
                                                   name="buildingDistressValue" placeholder="Apartment Distress Value"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <hr>
                                </div>
                            </ng-template>
                            <ng-template [ngTemplateOutlet]="build"></ng-template>
                        </div>
                        <hr>

                        <div class="box-header with-border">
                            <h2 class="box-title title">Apartment Details After Completion</h2>
                            <div formGroupName="buildingDetailsAfterCompletion">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingName">Apartment Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="afterName"
                                                   name="buildingName" placeholder="Apartment Name"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDescription">Apartment
                                                Description</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDescription"
                                                   id="afterDesc"
                                                   name="buildingDescription" placeholder="Apartment Description"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildArea">Build Up Area (Sq.ft)</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'after')"
                                                   class="form-control rounded" formControlName="buildArea"
                                                   id="afterArea"
                                                   name="buildArea" placeholder="Build Up Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildRate">Build Up Area Rate</label>
                                            <input (input)="calculateBuildUpAreaRate(i,'after')"
                                                   class="form-control rounded" formControlName="buildRate"
                                                   id="afterbuildRate"
                                                   name="buildRate" placeholder="Build Up Area Rate"
                                                   type="number"/>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="totalCost">Total Cost</label>
                                            <input (ngModelChange)="calculateWaterSupply(i,'after');calculateElectrification(i,'after');calculateSanitation(i,'after')"
                                                   class="form-control rounded" formControlName="totalCost"
                                                   id="afterTc"
                                                   name="totalCost" placeholder="Total Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="floorName">Floor Name</label>
                                            <input class="form-control rounded" formControlName="buildingName"
                                                   id="afterFloorName"
                                                   name="floorName" placeholder="First Floor,Second....."
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="valuationArea">Valuation Taken Area
                                                (Sq.ft)</label>
                                            <input (input)="calculateEstimatedCost(i,'after')"
                                                   class="form-control rounded" formControlName="valuationArea"
                                                   id="afterVA"
                                                   name="valuationArea" placeholder="Valuation Taken Area"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="ratePerSquareFeet">Rate per Square
                                                Feet</label>
                                            <input (input)="calculateEstimatedCost(i,'after')"
                                                   class="form-control rounded" formControlName="ratePerSquareFeet"
                                                   id="afterRate"
                                                   name="ratePerSquareFeet" placeholder="Rate per Square Feet"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="estimatedCost">Estimated Cost</label>
                                            <input class="form-control rounded" formControlName="estimatedCost"
                                                   id="afterEstCost"
                                                   name="estimatedCost" placeholder="Estimated Cost"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'after')"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply %</label>
                                            <input (input)="calculateWaterSupply(i,'after')"
                                                   class="form-control rounded" formControlName="waterSupplyPercent"
                                                   id="afterWaterSupplyPercent"
                                                   name="waterSupplyPercent" placeholder="Water Supply %"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="waterSupply">Water Supply</label>
                                            <input class="form-control rounded" formControlName="waterSupply"
                                                   id="afterSupply"
                                                   name="waterSupply" placeholder="Water Supply"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'after')"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitationPercent">Sanitation %</label>
                                            <input (input)="calculateSanitation(i,'after')" class="form-control rounded"
                                                   formControlName="sanitationPercent"
                                                   id="afterSanitationPercent"
                                                   name="sanitationPercent" placeholder="Sanitation %"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="sanitation">Sanitation</label>
                                            <input class="form-control rounded" formControlName="sanitation"
                                                   id="afterSanitation"
                                                   name="sanitation" placeholder="Sanitation"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'after')"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrificationPercent">Electrification %</label>
                                            <input (input)="calculateElectrification(i,'after')"
                                                   class="form-control rounded" formControlName="electrificationPercent"
                                                   id="afterElectrificationPercent"
                                                   name="electrificationPercent" placeholder="Electrification %"
                                                   type="number"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="electrification">Electrification</label>
                                            <input class="form-control rounded" formControlName="electrification"
                                                   id="afterElectrification"
                                                   name="electrification" placeholder="Electrification"
                                                   type="number" readonly
                                                   (ngModelChange)="calculateTotalApartmentCost(i,'after')"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingTotalCost">Apartment Total Cost</label>
                                            <input class="form-control rounded" formControlName="buildingTotalCost"
                                                   id="afterbuildTc"
                                                   name="buildingTotalCost" placeholder="Apartment Total Cost"
                                                   type="number" readonly/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingFairMarketValue">Apartment Fair Market
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingFairMarketValue"
                                                   id="afterFMV"
                                                   name="buildingFairMarketValue" placeholder="Apartment Fair Market Value"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="title" for="buildingDistressValue">Apartment Distress
                                                Value</label>
                                            <input class="form-control rounded"
                                                   formControlName="buildingDistressValue"
                                                   id="afterDV"
                                                   name="buildingDistressValue" placeholder="Apartment Distress Value"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div *ngIf="securityForm.get('buildingUnderConstructions')['length'] > 1"
                                         class="col-md-1 pt-4">
                                        <input (click)="removeBuildingUnderConstructions(i)"
                                               class="align-self-end btn btn-sm btn-danger btn-primary"
                                               type="button" value="Delete"/>
                                    </div>

                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <input (click)="addBuildingUnderConstructions()" class="btn btn-sm btn-flat btn-primary"
                           type="button"
                           value="Add Apartment"/>
                </div>
            </div>
        </nb-card>
        <!--        Land Building security-->
        <nb-card [hidden]="!landBuilding" class="p-5">

            <div class="row">
                <div class="col-md-5">
                    <div class="box-header with-border">
                        <h2 class="box-title title">Land and Building Security</h2>
                    </div>
                </div>
            </div>
            <div formArrayName="landBuilding">
                <div
                        *ngFor="let landAndBuilding of securityForm.get('landBuilding')['controls']; let i = index"
                        class="font-weight-bold">
                    <div class="row justify-content-end">
                        <button class="btn btn-primary sb-small mr-2"
                                (click)="openSiteVisitModel('Land And Building Security'+' '+(i+1))">Inspect Site Visit</button>
                    </div>
                    <div class="row">
                        <div class="col-md-10">
                            <p><b>{{i + 1}}.Land & Building</b></p>

                        </div>
                        <div
                                *ngIf="securityForm.get('landBuilding') ['length'] > 1"
                                class="col-md-1 float-right">
                            <input (click)="removeLandBuildingDetails(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>
                    </div>
                    <div [formGroupName]="i">
                        <input type="checkbox" formControlName="underConstructionChecked"> Check if Land & Building is
                        Under Construction
                        <br>
                        <input type="checkbox" formControlName="landBuildingOtherBranchChecked"> Property on another
                        branch location
                        <div class="row pt-2">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="owner">Owner Name</label>
                                    <input [ngClass]="{'is-invalid':(landBuilding) && (landAndBuilding.get('owner').errors)}"
                                            class="form-control rounded"
                                           formControlName="owner"
                                           name="owner" placeholder="Owner Name"
                                           type="text" required/>
                                    <div *ngIf="(landBuilding) && (landAndBuilding.get('owner').invalid)"
                                         class="invalid-feedback">
                                        <div *ngIf="landAndBuilding.get('owner').errors.required">
                                            Owner name is required
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="location">Location</label>
                                    <input class="form-control rounded"
                                           formControlName="location"
                                           name="location" placeholder="Location"
                                           type="text"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="plotNumber">Plot
                                        No.</label>
                                    <input class="form-control rounded"
                                           formControlName="plotNumber"
                                           name="plotNumber" placeholder="Plot No."
                                           type="text"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="areaFormat">Area
                                        Format</label>
                                    <select class="form-control rounded"
                                            formControlName="areaFormat"
                                            name="areaFormat">
                                        <option [value]="null">Select Area Format</option>
                                        <option [value]="area" *ngFor="let area of areaFormat">{{area}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="area">Area</label>
                                    <input class="form-control rounded"
                                           formControlName="area"
                                           name="area" placeholder="Area"
                                           type="text"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="landConsideredValue">Considered Value</label>
                                    <input [ngClass]="{ 'is-invalid': (landBuilding) && (landAndBuilding.get('landConsideredValue').errors)}"
                                            class="form-control" formControlName="landConsideredValue"
                                           id="landBuildingConsideredValue" name="total" placeholder="Considered Value"
                                           type="number">
                                    <div *ngIf="(landBuilding) && (landAndBuilding.get('landConsideredValue').invalid)"
                                         class="invalid-feedback">
                                        <div *ngIf="landAndBuilding.get('landConsideredValue').errors.required">
                                            Considered value is required
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="area">House Number
                                    </label>
                                    <input
                                            class="form-control rounded"
                                            formControlName="houseNumber" name="houseNumber"
                                            placeholder="House Number"
                                            type="text"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="area">Total building area
                                        (Sqf)</label>
                                    <input [ngClass]="{ 'is-invalid':(submitted) &&  landAndBuilding.get('totalBuildingArea').errors }"
                                           class="form-control rounded"
                                           formControlName="totalBuildingArea"
                                           name="totalBuildingArea"
                                           placeholder="Total building area (Sqf)"
                                           type="number"/>
                                    <div
                                            *ngIf="(submitted) && landAndBuilding.get('totalBuildingArea').invalid"
                                            class="invalid-feedback">
                                        <div
                                                *ngIf="landAndBuilding.get('totalBuildingArea').errors.required">
                                            Total building area required!
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="area">Cost per sqf</label>
                                    <input class="form-control rounded"
                                           formControlName="costPerSquare"
                                           name="costPerSquare"
                                           placeholder="Cost per sqf"
                                           type="number"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="area">Total cost
                                    </label>
                                    <input class="form-control rounded"
                                           formControlName="totalCost"
                                           name="totalCost" placeholder="Total cost"
                                           type="number"/>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="marketValue">Fair Market Value</label>
                                    <input class="form-control rounded"
                                           formControlName="marketValue"
                                           name="marketValue"
                                           placeholder="Fair Market Value"
                                           type="number"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title" for="distressValue">{{client === clientName?.EXCEL ? 'Market Value' : 'Distress Value'}}</label>
                                    <input class="form-control rounded"
                                           formControlName="distressValue"
                                           name="distressValue"
                                           [placeholder]="(client === clientName?.EXCEL) ? 'Market Value' : 'Distress Value'"
                                           type="text"/>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div *ngIf="securityForm.get(['landBuilding',i,'landBuildingOtherBranchChecked']).value">
                                    <div class="form-group">
                                        <label>Select Branch</label>
                                        <ng-select
                                                (change)="valuator(securityForm.get(['landBuilding',i,'buildingBranch']).value.id,'building',i)"
                                                [multiple]="false"
                                                bindLabel="name"
                                                formControlName="buildingBranch"
                                                placeholder="">
                                            <ng-option
                                                    *ngFor="let branch of branchLists"
                                                    [value]="branch">{{branch.name}}</ng-option>
                                        </ng-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="title" for="landBuildingCollateralOwnerRelationship">Collateral Owner
                                        Relationship</label>
                                    <select class="form-control rounded"
                                            formControlName="landBuildingCollateralOwnerRelationship"
                                            id="landBuildingCollateralOwnerRelationship"
                                            name="landBuildingCollateralOwnerRelationship">
                                        <option [ngValue]="null">--Select Relationship--</option>
                                        <option *ngFor="let relationship of collateralOwnerRelationshipList.relation"
                                                [ngValue]="relationship.id">{{relationship.name}}</option>
                                    </select>
                                </div>
                            </div>
                                <div class="col-md-6">
                                <div class="form-group">
                                    <label class="title" for="roadAccessBluePrint">Is road access seen in blueprint or
                                        not</label>
                                    <select class="form-control rounded"
                                            formControlName="roadAccessBluePrint"
                                            id="roadAccessBluePrint"
                                            name="roadAccessBluePrint">
                                        <option [ngValue]="null">--Select Road Access--</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <label for="roadAccessDescribe"><strong>Briefly describe the road access</strong></label>
                                <textarea class="form-control"
                                          formControlName="roadAccessDescribe"
                                          id="roadAccessDescribe"
                                          name="roadAccessDescribe"
                                          placeholder="Briefly describe the road access"
                                          rows="5"
                                          type="text"></textarea>
                            </div>
                            <div class="col-md-6 form-group">
                                <label for="landAndBuildingSecurityLegalDocumentAddress"><strong>Address as per Legal
                                    Document</strong></label>
                                <textarea class="form-control"
                                          formControlName="landAndBuildingSecurityLegalDocumentAddress"
                                          id="landAndBuildingSecurityLegalDocumentAddress"
                                          name="landAndBuildingSecurityLegalDocumentAddress"
                                          placeholder="Address as per Legal Document"
                                          rows="5"
                                          type="text" maxlength="256"></textarea>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group form-inline">
                                        <nb-checkbox id="ownerKycInfoForLandAndBuilding{{i}}" class="ml-2"
                                                     formControlName="kycCheckForLandAndBuilding"
                                                     (checkedChange)="ownerKycRelationInfoCheck(securityForm.get(['landBuilding', i,
                                                      'kycCheckForLandAndBuilding']).value, 'land_building', i)">
                                            <h6>Owner KYC Applicable</h6>
                                        </nb-checkbox>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group" *ngIf="securityForm.get(['landBuilding', i, 'kycCheckForLandAndBuilding']).value === true">
                                <app-owner-kyc-applicable #ownerKycApplicableLandBuilding
                                                          [data]="formDataForEdit?.landBuilding[i]?.ownerKycApplicableData"
                                                          [calendarType]="calendarType"
                                                          [kycId]="securityId.land_buildingId + i"></app-owner-kyc-applicable>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Valuator Name</label>
                                    <ng-select (click)="valuator(null,'building',i)"
                                               [multiple]="false"
                                               bindLabel="name"
                                               formControlName="buildingValuator"
                                               placeholder="">
                                        <ng-option [value]="null">--Select Valuator Name--</ng-option>
                                        <ng-option
                                                *ngFor="let valuator of securityValuator.buildingValuator[i]"
                                                [value]="valuator">{{valuator.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title">Valuated Date</label>
                                    <input *ngIf="calendarType === 'AD'"
                                           [nbDatepicker]="buildingValuatorDate"
                                           class="form-control rounded"
                                           formControlName="buildingValuatorDate"
                                           name="buildingValuatorDate"
                                           placeholder="Valuated Date"
                                           type="text"/>
                                    <app-calendar
                                            (messageToEmit)="securityForm.get(['landBuilding',i,'buildingValuatorDate']).patchValue($event?.eDate)"
                                            *ngIf="calendarType === 'BS'"
                                            [ePreDate]="securityForm.get(['landBuilding',i,'buildingValuatorDate']).value"></app-calendar>
                                    <nb-datepicker
                                        #buildingValuatorDate></nb-datepicker>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title">Valuator Representative
                                        Name</label>
                                    <input class="form-control rounded"
                                           formControlName="buildingValuatorRepresentative"
                                           name="buildingValuatorRepresentative"
                                           placeholder="Valuator Representative Name"
                                           type="text"/>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title" for="landBuildingStaffRepresentativeDesignation">Staff
                                        Representative Designation 1</label>
                                    <select class="form-control rounded"
                                            formControlName="landBuildingStaffRepresentativeDesignation"
                                            id="landBuildingStaffRepresentativeDesignation"
                                            name="landBuildingStaffRepresentativeDesignation">
                                        <option [ngValue]="null" hidden>Staff Representative Designation</option>
                                        <option *ngFor="let designation of designationList"
                                                [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title">Staff Representative Name 1</label>
                                    <input class="form-control rounded"
                                           formControlName="buildingStaffRepresentativeName"
                                           name="buildingStaffRepresentativeName"
                                           placeholder="Staff Representative Name 1"
                                           type="text"/>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title" for="landBuildingStaffRepresentativeDesignation2">Staff
                                        Representative Designation 2</label>
                                    <select class="form-control rounded"
                                            formControlName="landBuildingStaffRepresentativeDesignation2"
                                            id="landBuildingStaffRepresentativeDesignation2"
                                            name="landBuildingStaffRepresentativeDesignation2">
                                        <option [ngValue]="null">Staff Representative Designation 2</option>
                                        <option *ngFor="let designation of designationList"
                                                [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title" for="landBuildingStaffRepresentativeName2">Staff Representative
                                        Name 2</label>
                                    <input class="form-control rounded"
                                           formControlName="landBuildingStaffRepresentativeName2"
                                           id="landBuildingStaffRepresentativeName2"
                                           name="landBuildingStaffRepresentativeName2"
                                           placeholder="Staff Representative Name 2"
                                           type="text"/>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="title">{{client === clientName?.SHINE_RESUNGA ? 'Ownership Type' : 'Type of property'}}</label>
                                    <select class="form-control rounded" formControlName="typeOfProperty"
                                            name="typeOfProperty">
                                        <option [value]="null">Select {{client === clientName?.SHINE_RESUNGA ? 'Ownership Type' : 'Type of property'}}</option>
                                        <option *ngFor="let property of typeOfProperty"
                                                [value]="property">{{property}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title">Ownership transfer date</label>
                                    <input class="form-control rounded" formControlName="ownershipTransferDate"
                                           name="ownershipTransferDate" placeholder="Ownership transfer date"
                                           [nbDatepicker]="ownershipDate"
                                           *ngIf="calendarType === 'AD'">
                                    <app-calendar
                                            (messageToEmit)="securityForm.get(['landBuilding',i,'ownershipTransferDate']).patchValue($event?.eDate)"
                                            *ngIf="calendarType === 'BS'"
                                            [ePreDate]="securityForm.get(['landBuilding',i,'ownershipTransferDate']).value"></app-calendar>
                                    <nb-datepicker #ownershipDate></nb-datepicker>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="title">Ownership transfer through</label>
                                    <select class="form-control rounded" formControlName="ownershipTransferThrough"
                                            name="ownershipTransferThrough"
                                            (change)="resetOtherTransferParameter('landBuilding', i,false)">
                                        <option [value]="null">Select Ownership transfer through</option>
                                        <option *ngFor="let ownership of newOwnerShipTransfer"
                                                [ngValue]="ownership.key">{{ownership.value}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4"
                                 *ngIf="securityForm.get(['landBuilding',i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.OTHER)">
                                <div class="form-group">
                                    <label class="title">Other</label>
                                    <input class="form-control rounded" formControlName="otherOwnershipTransferValue"
                                           name="otherOwnershipTransferValue"
                                           placeholder="Other"
                                           type="text"/>
                                </div>
                            </div>
                            <ng-container>
                                <div class="col-md-12"
                                     *ngIf="securityForm.get(['landBuilding' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.SALE)">
                                    <strong>Has transfer date elapsed by 6 months plus 35 days? </strong>
                                    <input class="ml-md-3" type="radio" value="Yes"
                                           formControlName="saleOwnershipTransfer"
                                           (input)="resetOtherTransferParameter('landBuilding', i,true)">
                                    <label>Yes</label>
                                    <input class="ml-md-3" type="radio" value="No"
                                           formControlName="saleOwnershipTransfer"
                                           (input)="resetOtherTransferParameter('landBuilding', i,true)">
                                    <label>No</label>

                                </div>
                                <div class="col-md-12"
                                     *ngIf="securityForm.get(['landBuilding' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.FAMILY_SEPARATION)">
                                    <strong>Has transfer date elapsed by 3 month? </strong>
                                    <input class="ml-md-3" type="radio" value="Yes"
                                           formControlName="familyTransferOwnershipTransfer"
                                           (input)="resetOtherTransferParameter('landBuilding', i,true)">
                                    <label>Yes</label>
                                    <input class="ml-md-3" type="radio" value="No"
                                           formControlName="familyTransferOwnershipTransfer"
                                           (input)="resetOtherTransferParameter('landBuilding', i,true)">
                                    <label>No</label>
                                </div>
                                <div class="col-md-12"
                                     *ngIf="securityForm.get(['landBuilding' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.GIFT_BAKASPATRA)">
                                    <strong>Has transfer date elapsed by 2 year plus 35 days? </strong>
                                    <input class="ml-md-3" type="radio" value="Yes"
                                           formControlName="giftOwnershipTransfer"
                                           (input)="resetOtherTransferParameter('landBuilding', i,true)">
                                    <label>Yes</label>
                                    <input class="ml-md-3" type="radio" value="No"
                                           formControlName="giftOwnershipTransfer"
                                           (input)="resetOtherTransferParameter('landBuilding', i,true)">
                                    <label>No</label>
                                </div>
                            </ng-container>
                            <ng-container>
                                <div class="col-md-12 d-inline-flex"
                                     *ngIf="securityForm.get(['landBuilding' , i,'saleOwnershipTransfer']).value === 'No'">
                                    <i>*Incase of No, specify registration amount in the transfer deed (as
                                        applicable)</i>
                                    <input class="form-control col-md-3" formControlName="saleRegistrationAmount"
                                           type="number" placeholder="Amount">
                                </div>
                                <div class="col-md-12 d-inline-flex"
                                     *ngIf="securityForm.get(['landBuilding' , i,'familyTransferOwnershipTransfer']).value === 'No'">
                                    <i>*Incase of No, specify registration amount in the transfer deed (as
                                        applicable)</i>
                                    <input class="form-control col-md-3" formControlName="familyRegistrationAmount"
                                           type="number" placeholder="Amount">
                                </div>
                                <div class="col-md-12 d-inline-flex"
                                     *ngIf="securityForm.get(['landBuilding' , i,'giftOwnershipTransfer']).value === 'No'">
                                    <i>*Incase of No, specify registration amount in the transfer deed (as
                                        applicable)</i>
                                    <input class="form-control col-md-3" formControlName="giftRegistrationAmount"
                                           type="number" placeholder="Amount">
                                </div>
                            </ng-container>
                            <div class="col-md-12">
                                <app-security-revaluation #revaluationComponentLandBuilding
                                                          [valuators]="securityValuator?.buildingValuator[i]"
                                                          [data]="formDataForEdit?.landBuilding[i]?.revaluationData"
                                                          [oldValuation]="securityForm.get('landBuilding').value"
                                                          [revaluationId]="securityId.land_buildingId + i"
                                                          [calendarType]="calendarType"></app-security-revaluation>
                            </div>

                        </div>


                        <hr>
                        <div *ngIf="securityForm.get(['landBuilding',i,'underConstructionChecked']).value">
                            <p><b>Land And Building Under Construction Detail</b></p>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Owner Name</label>
                                        <input class="form-control rounded"
                                               formControlName="ownerConstruction"
                                               name="owner" placeholder="Owner Name"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Location</label>
                                        <input class="form-control rounded"
                                               formControlName="locationConstruction"
                                               name="location" placeholder="Location"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Plot
                                            No.</label>
                                        <input class="form-control rounded"
                                               formControlName="plotNumberConstruction"
                                               name="plotNumber" placeholder="Plot No."
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Area
                                            Format</label>
                                        <select class="form-control rounded"
                                                formControlName="areaFormatConstruction"
                                                name="areaFormat">
                                            <option [value]="null">Select Area Format</option>
                                            <option [value]="area" *ngFor="let area of areaFormat">{{area}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Area</label>
                                        <input class="form-control rounded"
                                               formControlName="areaConstruction"
                                               name="area" placeholder="Area"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="landConsideredValueConstruction">Considered Value</label>
                                        <input class="form-control" formControlName="landConsideredValueConstruction"
                                               id="landConsideredValueConstruction" name="total"
                                               placeholder="Considered Value" type="number">
                                    </div>
                                </div>
                                <!--                                To do: need to remove if not required in future-->

                                <!--                                <div class="col-md-3">-->
                                <!--                                    <div class="form-group">-->
                                <!--                                        <label class="title" >House Number-->
                                <!--                                        </label>-->
                                <!--                                        <input class="form-control rounded"-->
                                <!--                                               formControlName="houseNumberConstruction"-->
                                <!--                                               name="houseNumber" placeholder="House Number"-->
                                <!--                                               type="text"/>-->
                                <!--                                    </div>-->
                                <!--                                </div>-->
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Total building area
                                            (Sqf)</label>
                                        <input class="form-control rounded"
                                               formControlName="totalBuildingAreaConstruction"
                                               name="totalBuildingArea"
                                               placeholder="Total building area (Sqf)"
                                               [ngClass]="{ 'is-invalid':(submitted) &&   securityForm.get(['landBuilding', i , 'totalBuildingAreaConstruction']).errors }"
                                               type="number"/>
                                        <div *ngIf="(submitted) && securityForm.get(['landBuilding', i , 'totalBuildingAreaConstruction']).invalid"
                                             class="invalid-feedback">
                                            <div *ngIf="securityForm.get(['landBuilding', i , 'totalBuildingAreaConstruction']).errors.required">
                                                Total building area required!
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Cost per sqf</label>
                                        <input class="form-control rounded"
                                               formControlName="costPerSquareConstruction"
                                               name="costPerSquare"
                                               placeholder="Cost per sqf"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Total Estimate Cost</label>
                                        <input class="form-control rounded"
                                               formControlName="totalCostConstruction"
                                               name="totalCost" placeholder="Total Estimate Cost"
                                               type="number"/>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Fair Market Value</label>
                                        <input class="form-control rounded"
                                               formControlName="marketValueConstruction"
                                               name="marketValue"
                                               placeholder="Fair Market Value"
                                               type="number"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title" for="distressValue">{{client === clientName?.EXCEL ? 'Market Value' : 'Distress Value'}}</label>
                                        <input class="form-control rounded"
                                               formControlName="distressValueConstruction"
                                               name="distressValue"
                                               [placeholder]="(client === clientName?.EXCEL) ? 'Market Value' : 'Distress Value'"
                                               type="text"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="title">Progess Cost</label>
                                        <input class="form-control rounded"
                                               formControlName="progessCost"
                                               name="progessCost" placeholder="Progess Cost"
                                               type="number"/>
                                    </div>
                                </div>
                                <!--                                To do: need to remove if not required in future-->
                                <!--                                <div class="col-md-3">-->
                                <!--                                    <div class="form-group">-->
                                <!--                                        <label class="title">Type of property</label>-->
                                <!--                                        <select class="form-control rounded" formControlName="typeOfPropertyConstruction"-->
                                <!--                                                name="typeOfProperty">-->
                                <!--                                            <option [value]="null" hidden>Select Type of property</option>-->
                                <!--                                            <option *ngFor="let property of typeOfProperty" [value]="property">{{property}}</option>-->
                                <!--                                        </select>-->
                                <!--                                    </div>-->
                                <!--                                </div>-->
                                <!--                                <div class="col-md-3">-->
                                <!--                                    <div class="form-group">-->
                                <!--                                        <label class="title" for="landStaffRepresentativeName">Mode of transfer</label>-->
                                <!--                                        <input class="form-control rounded" formControlName="modeOfTransferConstruction"-->
                                <!--                                               name="modeOfTransfer" placeholder="Mode of transfer"-->
                                <!--                                               type="text"/>-->
                                <!--                                    </div>-->
                                <!--                                </div>-->
                            </div>

                        </div>
                    </div>
                </div>

                <div class="text-right">
                    <input (click)="addLandBuilding()"
                           class="btn btn-sm btn-flat btn-primary"
                           type="button"
                           value="Add More Land & Building"/>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="title" for="area">Remarks of land and building</label>
                        <textarea class="form-control rounded"
                                  formControlName="landBuildingDescription"
                                  name="remarksBuilding"
                                  placeholder="Remarks of land and building"
                                  [ngClass]="{ 'is-invalid':(submitted) &&  securityForm.get('landBuildingDescription').errors }"
                                  rows="2" type="text"></textarea>
                        <div *ngIf="(submitted) && securityForm.get('landBuildingDescription').invalid"
                             class="small text-danger">
                            <div *ngIf="securityForm.get('landBuildingDescription').errors.required">
                                Remarks of required!
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </nb-card>

        <!--Plant and Machinery Security-->
        <nb-card [hidden]="!plantSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Details Of Plant And Machinery Security Before Completion</h2>
            </div>
            <div *ngFor="let plant of securityForm.get('plantDetails')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="plantDetails">
                <div [formGroupName]="i">
                    <input type="checkbox" formControlName="plantOtherBranchChecked"> Property on another branch
                    location
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="model">Model No.</label>
                                <input [ngClass]="{'is-invalid': (plantSelected) && (plant.get('model').errors)}"
                                        class="form-control rounded" formControlName="model"
                                       name="model" placeholder="Model No."
                                       type="text" required/>
                                <div *ngIf="(plantSelected) && (plant.get('model').invalid)"
                                class="invalid-feedback">
                                    <div *ngIf="plant.get('model').errors.required">Model no is required</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="quotation">Quotation/Valuation Amount</label>
                                <input [ngClass]="{ 'is-invalid': (plantSelected) && (plant.get('quotation').errors ||
                                    plant.get('quotation').invalid) }"
                                        class="form-control rounded" formControlName="quotation"
                                       id="quotation"
                                       name="quotation" placeholder="Quotation/Valuation Amount"
                                       type="text"/>
                                <div *ngIf="(plantSelected) && (plant.get('quotation').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="plant.get('quotation').errors.required">Quotation amount is required</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="supplier">Supplier</label>
                                <input class="form-control rounded" formControlName="supplier"
                                       id="supplier"
                                       name="supplier" placeholder="Supplier"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="downPay">Down payment</label>
                                <input class="form-control rounded" formControlName="downPay"
                                       id="downPay"
                                       name="downPay" placeholder="Down payment"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="loanExp">Loan Exposure</label>
                                <input class="form-control rounded" formControlName="loanExp"
                                       id="loanExp"
                                       name="loanExp" placeholder="0.00"
                                       type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div *ngIf="securityForm.get(['plantDetails',i,'plantOtherBranchChecked']).value">
                                <div class="form-group">
                                    <label>Select Branch</label>
                                    <ng-select
                                            (change)="valuator(securityForm.get(['plantDetails',i,'plantBranch']).value.id,'plant',i)"
                                            [multiple]="false"
                                            bindLabel="name"
                                            formControlName="plantBranch"
                                            placeholder="">
                                        <ng-option *ngFor="let branch of branchLists"
                                                   [value]="branch">{{branch.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Valuator Name</label>
                                <ng-select [multiple]="false"
                                           bindLabel="name"
                                           placeholder=""
                                           formControlName="plantMachineryValuator" (click)="valuator(null,'plant',i)">
                                    <ng-option [value]="null">--Select Valuator Name--</ng-option>
                                    <ng-option *ngFor="let valuator of securityValuator.plantValuator[i]"
                                               [value]="valuator">{{valuator.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryValuatorDate">Valuated Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                       formControlName="plantMachineryValuatorDate"
                                       id="plantMachineryValuatorDate"
                                       name="plantMachineryValuatorDate" placeholder="Valuated Date"
                                       [nbDatepicker]="plantMachineryValuatorDate"
                                       type="text"/>
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['plantDetails',i,'plantMachineryValuatorDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['plantDetails',i,'plantMachineryValuatorDate']).value"></app-calendar>
                                <nb-datepicker #plantMachineryValuatorDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryValuatorRepresentative">Valuator Representative
                                    Name</label>
                                <input class="form-control rounded"
                                       formControlName="plantMachineryValuatorRepresentative"
                                       id="plantMachineryValuatorRepresentative"
                                       name="plantMachineryValuatorRepresentative"
                                       placeholder="Valuator Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryStaffRepresentativeDesignation">Staff
                                    Representative Designation 1</label>
                                <select class="form-control rounded"
                                        formControlName="plantMachineryStaffRepresentativeDesignation"
                                        id="plantMachineryStaffRepresentativeDesignation"
                                        name="plantMachineryStaffRepresentativeDesignation">
                                    <option [ngValue]="null" hidden>Staff Representative Designation 1</option>
                                    <option *ngFor="let designation of designationList"
                                            [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryStaffRepresentativeName">Staff Representative
                                    Name 1</label>
                                <input class="form-control rounded"
                                       formControlName="plantMachineryStaffRepresentativeName"
                                       id="plantMachineryStaffRepresentativeName"
                                       name="plantMachineryStaffRepresentativeName"
                                       placeholder="Staff Representative Name 1"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryStaffRepresentativeDesignation2">Staff
                                    Representative Designation 2</label>
                                <select class="form-control rounded"
                                        formControlName="plantMachineryStaffRepresentativeDesignation2"
                                        id="plantMachineryStaffRepresentativeDesignation2"
                                        name="plantMachineryStaffRepresentativeDesignation2">
                                    <option [ngValue]="null">Staff Representative Designation 2</option>
                                    <option *ngFor="let designation of designationList"
                                            [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="plantMachineryStaffRepresentativeName2">Staff Representative
                                    Name 2</label>
                                <input class="form-control rounded"
                                       formControlName="plantMachineryStaffRepresentativeName2"
                                       id="plantMachineryStaffRepresentativeName2"
                                       name="plantMachineryStaffRepresentativeName2"
                                       placeholder="Staff Representative Name2"
                                       type="text"/>
                            </div>
                        </div>

                        <div *ngIf="securityForm.get('plantDetails')['length'] > 1" class="col-md-1 pt-4">
                            <input (click)="removePlantDetails(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addPlantandMachinery()" class="btn btn-sm btn-flat btn-primary"
                       type="button"
                       value="Add Plant and Machine"/>
            </div>
        </nb-card>
        <!-- Vehicle Security -->
        <nb-card [hidden]="!vehicleSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Vehicle Security</h2>
            </div>
            <div
                    *ngFor="let addMoreVehicle of securityForm.get('vehicleDetails')['controls']; let i = index"
                    class="font-weight-bold"
                    formArrayName="vehicleDetails">
                <div [formGroupName]="i">
                    <br>
                    <div class="row">
                        <div class="col-md-10">
                            <h5>{{i + 1}}) Details of Security Offered: Vehicle</h5>
                            <input type="checkbox" formControlName="vehicleOtherBranchChecked"> Property on another
                            branch location
                        </div>
                        <div *ngIf="securityForm.get('vehicleDetails')['length']>1"
                             class="col-md-2 ">
                            <button (click)="removeVehicleDetails(i)"
                                    class="float-right btn tbn-sm btn-flat btn-danger" value="Delete">
                                <em class="fa fa-trash" style="color: white;"></em>

                            </button>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="model"><strong>Model</strong></label>
                                <input [ngClass]="{'is-invalid': (vehicleSelected) && (addMoreVehicle.get('model').errors)}"
                                        class="form-control" formControlName="model" id="model" name="model"
                                        placeholder="Model"
                                        type="text" required />
                                <div *ngIf="(vehicleSelected) && (addMoreVehicle.get('model').invalid)" class="invalid-feedback">
                                    <div *ngIf="addMoreVehicle.get('model').errors.required">
                                        Model name is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="registrationNumber"><strong>Registration
                                    Number</strong></label>
                                <input
                                        class="form-control" formControlName="registrationNumber"
                                        id="registrationNumber"
                                        name="registrationNumber" placeholder="Registration Number"
                                        type="text">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="registrationDate"><strong>Registration
                                    Date</strong></label>
                                <input
                                        [nbDatepicker]="registrationDate"
                                        class="form-control" formControlName="registrationDate" fullWidth
                                        id="registrationDate" name="registrationDate"
                                        nbInput placeholder="Registration Date" *ngIf="calendarType === 'AD'">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['vehicleDetails',i,'registrationDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['vehicleDetails',i,'registrationDate']).value"></app-calendar>
                                <nb-datepicker #registrationDate></nb-datepicker>
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="engineNumber"><strong>Engine Number</strong></label>
                                <input
                                        class="form-control" formControlName="engineNumber" id="engineNumber"
                                        name="model"
                                        placeholder="Engine Number" type="text">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="chassisNumber"><strong>Chassis Number</strong></label>
                                <input
                                        class="form-control" formControlName="chassisNumber" id="chassisNumber"
                                        name="chassisNumber"
                                        placeholder="Chassis Number" type="text">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="valuationAmount"><strong>{{client === clientName?.ICFC ? 'Quotation/Valuation Amount' : 'Valuation Amount'}}</strong></label>
                                <input  [ngClass]="{ 'is-invalid': (vehicleSelected) && (addMoreVehicle.get('valuationAmount').errors ||
                                        addMoreVehicle.get('valuationAmount').invalid) }"
                                        (keyup)="vehicleRemainingAmount(i)"
                                        class="form-control" formControlName="valuationAmount" id="valuationAmount"
                                        name="valuationAmount"
                                        [placeholder]="(client === clientName?.ICFC) ? 'Quotation/Valuation Amount' : 'Valuation Amount'"
                                        type="number">
                                <div *ngIf="(vehicleSelected) && (addMoreVehicle.get('valuationAmount').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="addMoreVehicle.get('valuationAmount').errors.required">
                                        Valuation amount is required
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="downPayment"><strong>Down Payment</strong></label>
                                <input
                                        (keyup)="vehicleRemainingAmount(i)"
                                        class="form-control" formControlName="downPayment" id="downPayment"
                                        name="downPayment"
                                        placeholder="Down Payment" type="number">
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="remainingAmount"><strong>Remaining Amount</strong></label>
                                <input
                                        class="form-control" formControlName="remainingAmount" id="remainingAmount"
                                        [readOnly]="true"
                                        name="remainingAmount"
                                        placeholder="Remaining Amount" type="number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="showroomCommission"><strong>Showroom
                                    Commission</strong></label>
                                <input
                                        class="form-control" formControlName="showroomCommission"
                                        id="showroomCommission"
                                        name="showroomCommission" placeholder="Showroom Commission"
                                        type="number">
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicleQuotationDate">Quotation Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                       formControlName="vehicleQuotationDate"
                                       id="vehicleQuotationDate"
                                       name="vehicleQuotationDate" placeholder="Quotation Date"
                                       [nbDatepicker]="vehicaleQuotationDate"
                                       type="text"/>
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['vehicleDetails',i,'vehicleQuotationDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['vehicleDetails',i,'vehicleQuotationDate']).value"></app-calendar>
                                <nb-datepicker #vehicaleQuotationDate></nb-datepicker>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div *ngIf="securityForm.get(['vehicleDetails',i,'vehicleOtherBranchChecked']).value">
                                <div class="form-group">
                                    <label>Select Branch</label>
                                    <ng-select
                                            (change)="valuator(securityForm.get(['vehicleDetails',i,'vehicalBranch']).value.id,'vehicle',i)"
                                            [multiple]="false"
                                            bindLabel="name"
                                            formControlName="vehicalBranch"
                                            placeholder="">
                                        <ng-option *ngFor="let branch of branchLists"
                                                   [value]="branch">{{branch.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Valuator Name</label>
                                <ng-select [multiple]="false"
                                           bindLabel="name"
                                           placeholder=""
                                           formControlName="vehicalValuator" (click)="valuator(null,'vehicle',i)">
                                    <ng-option [value]="null">--Select Valuator Name--</ng-option>
                                    <ng-option *ngFor="let valuator of securityValuator.vehicalValuator[i]"
                                               [value]="valuator">{{valuator.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalValuatorDate">Valuated Date</label>
                                <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                       formControlName="vehicalValuatorDate"
                                       id="vehicalValuatorDate"
                                       name="vehicalValuatorDate" placeholder="Valuated Date"
                                       [nbDatepicker]="vehicalValuatorDate"
                                       type="text"/>
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['vehicleDetails',i,'vehicalValuatorDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['vehicleDetails',i,'vehicalValuatorDate']).value"></app-calendar>
                                <nb-datepicker #vehicalValuatorDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalValuatorRepresentative">Valuator Representative
                                    Name</label>
                                <input class="form-control rounded" formControlName="vehicalValuatorRepresentative"
                                       id="vehicalValuatorRepresentative"
                                       name="vehicalValuatorRepresentative" placeholder="Valuator Representative Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalStaffRepresentativeDesignation">Staff Representative
                                    Designation 1</label>
                                <select class="form-control rounded"
                                        formControlName="vehicalStaffRepresentativeDesignation"
                                        id="vehicalStaffRepresentativeDesignation"
                                        name="vehicalStaffRepresentativeDesignation">
                                    <option [ngValue]="null" hidden>Staff Representative Designation 1</option>
                                    <option *ngFor="let designation of designationList"
                                            [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicalStaffRepresentativeName">Staff Representative Name
                                    1</label>
                                <input class="form-control rounded" formControlName="vehicalStaffRepresentativeName"
                                       id="vehicalStaffRepresentativeName"
                                       name="vehicalStaffRepresentativeName" placeholder="Staff Representative Name 1"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicaleStaffRepresentativeDesignation2">Staff Representative
                                    Designation 2</label>
                                <select class="form-control rounded"
                                        formControlName="vehicaleStaffRepresentativeDesignation2"
                                        id="vehicaleStaffRepresentativeDesignation2"
                                        name="vehicaleStaffRepresentativeDesignation2">
                                    <option [ngValue]="null">Staff Representative Designation 2</option>
                                    <option *ngFor="let designation of designationList"
                                            [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="vehicaleStaffRepresentativeName2">Staff Representative Name
                                    2</label>
                                <input class="form-control rounded" formControlName="vehicaleStaffRepresentativeName2"
                                       id="vehicaleStaffRepresentativeName2"
                                       name="vehicaleStaffRepresentativeName2" placeholder="Staff Representative Name 2"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Ownership transfer date</label>
                                <input class="form-control rounded" formControlName="ownershipTransferDate"
                                       *ngIf="calendarType === 'AD'"
                                       name="ownershipTransferDate" placeholder="Ownership transfer date"
                                       [nbDatepicker]="ownershipDate">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['vehicleDetails',i,'ownershipTransferDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['vehicleDetails',i,'ownershipTransferDate']).value"></app-calendar>
                                <nb-datepicker #ownershipDate></nb-datepicker>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <h6>Showroom Details</h6>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label class="title" for="showroomName">Showroom Name</label>
                                <input class="form-control rounded" formControlName="showroomName"
                                       id="showroomName"
                                       name="showroomName" placeholder="Showroom Name"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label class="title" for="showroomAddress">Showroom Address</label>
                                <input class="form-control rounded" formControlName="showroomAddress"
                                       id="showroomAddress"
                                       name="showroomAddress" placeholder="Showroom Address"
                                       type="text"/>
                            </div>
                        </div>

                        <div class="col-md-12 form-group">
                            <label><b>Vehicle Remarks</b></label>
                            <textarea class="form-control" formControlName="vehicleRemarks" rows="4"
                                      placeholder="Vehicle Remarks"></textarea>
                        </div>

                    </div>
                    <hr>
                </div>
            </div>
            <div class="d-flex justify-content-sm-end">
                <p class="font-weight-bolder">Vehicle Exposure: {{totalVehicleExposure |number}}%</p>
            </div>
            <div class="text-right">
                <input (click)="addVehicleSecurity()" class="btn btn-sm btn-flat btn-primary"
                       type="button"
                       value="Add More"/>
            </div>
            <div>

            </div>
        </nb-card>
        <!-- Fixed Deposit Receipt -->
        <nb-card [hidden]="!depositSelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Fixed Deposit Receipt</h2>
            </div>
            <div *ngFor="let deposit of securityForm.get('fixedDepositDetails')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="fixedDepositDetails">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-12">
                            <hr>
                            <div *ngIf="i > 0" class="float-right">
                                <input (click)="removeFixedDeposit(i)" class="btn btn-sm btn-flat btn-danger"
                                       type=button value="Delete"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">FD Receipt Number<strong></strong></label>
                                <input class="form-control" formControlName="receiptNumber" placeholder="FD Receipt Number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">FD Account Holder Name<strong></strong></label>
                                <input class="form-control" formControlName="accountHolderName" placeholder="FD Account Holder Name">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">FD Account Number<strong></strong></label>
                                <input [ngClass]="{'is-invalid': (depositSelected) && (deposit.get('accountNumber').errors)}"
                                        class="form-control" formControlName="accountNumber" placeholder="FD Account Number"
                                required />
                                <div *ngIf="(depositSelected) && (deposit.get('accountNumber').invalid)" class="invalid-feedback">
                                    <div *ngIf="deposit.get('accountNumber').errors.required">
                                        Account no is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">FD Tenure Start Date<strong></strong></label>
                                <input *ngIf="calendarType === 'AD'" [nbDatepicker]="tenureStartDate"
                                       class="form-control" formControlName="tenureStartDate" placeholder="FD Tenure Start Date">
                                <app-calendar *ngIf="calendarType === 'BS'"
                                              (messageToEmit)="securityForm.get(['fixedDepositDetails',i,'tenureStartDate']).patchValue($event?.eDate)"
                                              [ePreDate]="securityForm.get(['fixedDepositDetails',i,'tenureStartDate']).value"></app-calendar>
                                <nb-datepicker #tenureStartDate></nb-datepicker>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Amount<strong></strong></label>
                                <input class="form-control"
                                       [ngClass]="{'is-invalid': (depositSelected) && (deposit.get('amount').errors)}"
                                       formControlName="amount" placeholder="Amount" type="number">
                                <div *ngIf="(depositSelected) && (deposit.get('amount').invalid)" class="invalid-feedback">
                                    <div *ngIf="deposit.get('amount').errors.required">
                                        Amount is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Expiry Date<strong></strong></label>
                                <input *ngIf="calendarType === 'AD'" [nbDatepicker]="expiryDate"
                                       class="form-control rounded" formControlName="expiryDate"
                                       nbInput placeholder="Expiry Date">
                                <app-calendar *ngIf="calendarType === 'BS'"
                                              (messageToEmit)="securityForm.get(['fixedDepositDetails',i,'expiryDate']).patchValue($event?.eDate)"
                                              [ePreDate]="securityForm.get(['fixedDepositDetails',i,'expiryDate']).value"></app-calendar>
                                <nb-datepicker #expiryDate></nb-datepicker>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Coupon Rate<strong></strong></label>
                                <input class="form-control" formControlName="couponRate" placeholder="Coupon Rate" type="number">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Beneficiary<strong></strong></label>
                                <input class="form-control" formControlName="beneficiary" placeholder="Beneficiary">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Remarks<strong></strong></label>
                                <input class="form-control" formControlName="remarks" placeholder="Remarks">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-right">
                <input (click)="addFixedDeposit()" class="btn btn-sm btn-flat btn-primary"
                       type="button"
                       value="Add More"/>
            </div>
        </nb-card>

        <!-- Share Security -->
        <nb-card [hidden]="!shareSelected" class="p-3" [formGroup]="shareSecurityForm">
            <nb-card-header>
                <h6 class="box-title title">Details of security offered and valuation amount</h6>
            </nb-card-header>
            <nb-card-body>
                <div class="row">
                    <div class="col-md-3">
                        <label for="sharePriceDate"><b>Price Updated Date</b></label>
                        <input formControlName="sharePriceDate"
                               class="form-control"
                               [readOnly]="true"
                               id="sharePriceDate">
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="avgDaysForPrice"><b>Average Day's for Share Price</b></label>
                        <input formControlName="avgDaysForPrice"
                               class="form-control"
                               [readOnly]="true"
                               id="avgDaysForPrice">
                    </div>
                    <div class="col-md-3">
                        <label for="promoter"><b>Loan Promoter Percent</b></label>
                        <input [(ngModel)]="activeNepseMaster.promoter"
                               [ngModelOptions]="{standalone: true}" class="form-control"
                               disabled id="promoter">
                    </div>

                    <div class="col-md-3">
                        <label for="ordinary"><b>Loan Ordinary Percent</b></label>
                        <input [(ngModel)]="activeNepseMaster.ordinary"
                               [ngModelOptions]="{standalone: true}" class="form-control"
                               disabled id="ordinary">
                    </div>
                </div>
                <br>
                <div
                        *ngFor="let shareField of shareSecurityForm.get('shareSecurityDetails')['controls'];  let shareFieldIndex = index"
                        formArrayName="shareSecurityDetails">
                    <div [formGroupName]="shareFieldIndex">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="companyName">Select Company Name :: Company Code</label>
                                    <select (change)="setShareValueByCompany(shareFieldIndex)"
                                            [ngClass]="{ 'is-invalid': (shareSelected) && (shareField.get('companyName').errors || shareField.get('companyName').invalid) }"
                                            class="custom-select"
                                            formControlName="companyName" id="companyName"
                                            name="companyName">
                                        <option value="" selected hidden>--Select Company Name--</option>
                                        <option *ngFor="let nepse of nepseList"
                                                value="{{nepse.companyName }}">{{nepse.companyName}}
                                            :: {{nepse.companyCode}}</option>
                                    </select>
                                    <div *ngIf="(shareSelected) && (shareField.get('companyName').invalid)" class="invalid-feedback">
                                        <div *ngIf="shareField.get('companyName').errors.required">
                                            Company name is required
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="shareType">Select Share Type</label>
                                    <input class="form-control" formControlName="shareType" id="shareType"
                                           name="shareType" readonly type="text">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="totalShareUnit">Number of Share Unit</label>
                                    <input (change)="calculateShareFieldsValues(shareFieldIndex)"
                                           [ngClass]="{ 'is-invalid': (shareSelected) && (shareField.get('totalShareUnit').errors
                                           || shareField.get('totalShareUnit').invalid) }"
                                           class="form-control" formControlName="totalShareUnit"
                                           id="totalShareUnit"
                                           name="totalShareUnit"
                                           type="number" placeholder="Number of Share Unit">
                                    <div *ngIf="(shareSelected) && (shareField.get('totalShareUnit').invalid)" class="invalid-feedback">
                                        <div *ngIf="shareField.get('totalShareUnit').errors.required">
                                            Number of share unit is required
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="shareRate">Rate of Each Unit</label>
                                    <input
                                            (change)="calculateShareFieldsValues(shareFieldIndex)"
                                            class="form-control" formControlName="amountPerUnit"
                                            id="shareRate" name="shareRate"
                                            type="number" placeholder="Rate of Each Unit">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="total">Total</label>
                                    <input class="form-control" formControlName="total" id="total"
                                           name="total" readonly type="number" placeholder="Total">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="consideredValue">Considered Value</label>
                                    <input class="form-control" formControlName="consideredValue"
                                           id="consideredValue" name="total" placeholder="Considered Value" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="row col-md-12">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title">Price Earning Ratio</label>
                                            <input class="form-control" formControlName="priceEarningRatio"
                                                   id="priceEarningRatio" name="priceEarningRatio"
                                                   placeholder="Price Earning Ratio" type="number">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title">Price to Book Value</label>
                                            <input class="form-control" formControlName="priceBookValue"
                                                   id="priceBookValue" name="priceBookValue"
                                                   placeholder="Price to Book Value" type="number">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title">Dividend Yield</label>
                                            <input class="form-control" formControlName="dividendYeild"
                                                   id="dividendYeild" name="dividendYeild"
                                                   placeholder="Dividend Yield" type="number">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title">Dividend Payout Ratio</label>
                                            <input class="form-control" formControlName="dividendPayoutRatio"
                                                   id="dividendPayoutRatio" name="dividendPayoutRatio"
                                                   placeholder="Dividend Payout Ratio" type="number">
                                        </div>
                                    </div>
                        </div>
                        <div *ngIf="shareSecurityForm.get('shareSecurityDetails')['length'] > 1"
                             class="d-flex justify-content-sm-end">
                            <button (click)="removeShareList(shareFieldIndex)"
                                    class="btn btn-sm btn-flat btn-danger">
                                <em class="fa fa-trash bg-transparent"></em>
                            </button>
                        </div>
                        <hr/>
                    </div>
                </div>
                <div class="d-flex justify-content-sm-end">
                    <p class="font-weight-bolder">Total Share
                        Value: {{totalShareValue}}</p>
                </div>
                <div class="d-flex justify-content-end">
                    <button (click)="addShareSecurity()" class="btn btn-sm btn-flat btn-primary"><i
                            class="fa fa-plus"></i></button>
                </div>
            </nb-card-body>
            <nb-card>
                <nb-card-body>
                    <div class="row">
                        <div class="col-md-12">
                            <label for="securityOffered">Description/Details of security offered</label>
                            <textarea class="form-control text-area" formControlName="securityOffered"
                                      placeholder="Description/Details of security offered"
                                      id="securityOffered"></textarea>
                        </div>
                    </div>
                </nb-card-body>
            </nb-card>
        </nb-card>

        <nb-card [hidden]="!hypothecationOfStock" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Hypothecation of Stock</h2>
            </div>
            <div *ngFor="let hypothecation of securityForm.get('hypothecationOfStock')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="hypothecationOfStock">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="title" for="description">Description</label>
                                <textarea class="form-control rounded" formControlName="description"
                                          placeholder="Description" rows="5"
                                          type="text"></textarea>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Owner</label>
                                <input [ngClass]="{'is-invalid': (hypothecationOfStock) && (hypothecation.get('owner').errors)}"
                                        class="form-control rounded" formControlName="owner"
                                       placeholder="Owner"
                                       type="text" required/>
                                <div *ngIf="(hypothecationOfStock) && (hypothecation.get('owner').invalid)" class="invalid-feedback">
                                    <div *ngIf="hypothecation.get('owner').errors.required">
                                        Owner name is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Stock Location</label>
                                <input class="form-control rounded" formControlName="stock"
                                       placeholder="Stock Location"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Value</label>
                                <input class="form-control rounded" formControlName="value"
                                       placeholder="Value"
                                       type="number"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title" for="hypothecationOwnerRelationship">Collateral Owner
                                    Relationship</label>
                                <select class="form-control rounded" formControlName="hypothecationOwnerRelationship"
                                        id="hypothecationOwnerRelationship"
                                        name="hypothecationOwnerRelationship">
                                    <option [ngValue]="null">Select Relationship</option>
                                    <option *ngFor="let relationship of collateralOwnerRelationshipList.relation"
                                            [ngValue]="relationship.id">{{relationship.name}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <nb-checkbox id="ownerKycInfoForHypothecatio{{i}}" class="ml-2"
                                             formControlName="kycCheckForHypthecation"
                                             (checkedChange)="ownerKycRelationInfoCheck(securityForm.get(['hypothecationOfStock', i,
                                              'kycCheckForHypthecation']).value,'hypothecation', i)">
                                    <h6>Owner KYC Applicable</h6>
                                </nb-checkbox>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group" *ngIf="securityForm.get(['hypothecationOfStock', i , 'kycCheckForHypthecation']).value === true">
                                <app-owner-kyc-applicable #ownerKycApplicableHypothecation
                                                          [data]="formDataForEdit?.hypothecationOfStock[i]?.ownerKycApplicableData"
                                                          [calendarType]="calendarType"
                                                          [kycId]="securityId.hypothecation_Id + i"></app-owner-kyc-applicable>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>

                        <div *ngIf="securityForm.get('hypothecationOfStock') ['length'] > 1" class="col-md-1">
                            <input (click)="removeHypothecation(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addHypothecationOfStock()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add More Hypothecation Of Stock"/>
            </div>
        </nb-card>
        <nb-card [hidden]="!assignmentOfReceivable" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Assignment Of Receivable</h2>
            </div>
            <div *ngFor="let assignment of securityForm.get('assignmentOfReceivables')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="assignmentOfReceivables">
                <div [formGroupName]="i">
                    <div class="row">

                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="title" for="description">Amount</label>
                                <input [ngClass]="{'is-invalid': (assignmentOfReceivable) && (assignment.get('amount').errors)}"
                                        class="form-control rounded" formControlName="amount"
                                       placeholder="Amount"
                                       type="number" required/>
                                <div *ngIf="(assignmentOfReceivable) && (assignment.get('amount').invalid)" class="invalid-feedback">
                                    <div *ngIf="assignment.get('amount').errors.required">
                                        Amount is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>
                    </div>

                </div>
                <hr>
            </div>
        </nb-card>

        <nb-card [hidden]="!assignments" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Lease Assignment</h2>
            </div>
            <div *ngFor="let assignment of securityForm.get('leaseAssignment')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="leaseAssignment">
                <div [formGroupName]="i">
                    <div class="row">

                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
        </nb-card>

        <nb-card [hidden]="!securityOther" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Other Security</h2>
            </div>
            <div *ngFor="let security of securityForm.get('otherSecurity')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="otherSecurity">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
        </nb-card>

        <nb-card [hidden]="!corporateGuarantee" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Corporate Guarantee</h2>
            </div>
            <div *ngFor="let corporate of securityForm.get('corporateGuarantee')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="corporateGuarantee">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Name of Guarantor</label>
                                <input [ngClass]="{'is-invalid': (corporateGuarantee) && (corporate.get('name').errors)}"
                                        class="form-control rounded" formControlName="name"
                                       placeholder="Name of Guarantor"
                                       type="text" required/>
                                <div *ngIf="(corporateGuarantee) && (corporate.get('name').invalid)" class="invalid-feedback">
                                    <div *ngIf="corporate.get('name').errors.required">
                                        Guarantor name is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Address</label>
                                <input class="form-control rounded" formControlName="address"
                                       placeholder="Address"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Key person </label>
                                <input class="form-control rounded" formControlName="keyPerson"
                                       placeholder="Key person "
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Email address </label>
                                <input class="form-control rounded" formControlName="email"
                                       placeholder="Email address"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="description">Phone number</label>
                                <input class="form-control rounded" formControlName="phoneNumber"
                                       placeholder="Phone number"
                                       type="number"/>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>

                        <div *ngIf="securityForm.get('corporateGuarantee') ['length'] > 1" class="col-md-1">
                            <input (click)="removeCorporate(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addCorporateGuarantee()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add More Corporate Guarantee"/>
            </div>
        </nb-card>

        <nb-card [hidden]="!personal" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Personal Guarantee</h2>
            </div>
            <div *ngFor="let personalGuarantee of securityForm.get('personalGuarantee')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="personalGuarantee">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Name of Guarantor</label>
                                <input [ngClass]="{'is-invalid': (personal) && (personalGuarantee.get('name').errors)}"
                                        class="form-control rounded" formControlName="name"
                                       placeholder="Name of Guarantor"
                                       type="text" required/>
                                <div *ngIf="(personal) && (personalGuarantee.get('name').invalid)" class="invalid-feedback">
                                    <div *ngIf="personalGuarantee.get('name').errors.required">
                                        Guarantor name is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Address </label>
                                <input class="form-control rounded" formControlName="address"
                                       placeholder="Address "
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title">Email address</label>
                                <input class="form-control rounded" formControlName="email"
                                       placeholder="Email address"
                                       type="text"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="title" for="description">Phone number</label>
                                <input class="form-control rounded" formControlName="phoneNumber"
                                       placeholder="Phone number"
                                       type="number"/>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Other Detail</label>
                                <ckeditor formControlName="otherDetail" [config]="ckeConfig"></ckeditor>

                            </div>
                        </div>
                        <div *ngIf="securityForm.get('personalGuarantee') ['length'] > 1" class="col-md-1">
                            <input (click)="removePersonal(i)"
                                   class="align-self-end btn btn-sm btn-danger btn-primary"
                                   type="button" value="Delete"/>
                        </div>

                    </div>

                </div>
                <hr>
            </div>
            <div class="text-right">
                <input (click)="addPersonalGuarantee()" class="btn btn-sm btn-flat btn-primary" type="button"
                       value="Add MorePersonal Guarantee"/>
            </div>
        </nb-card>

        <!--        Insurance policy Security -->
        <nb-card [hidden]="!insurancePolicySelected" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Insurance Policy Security</h2>
            </div>
            <hr>
            <div *ngFor="let insurancePolicy of securityForm.get('insurancePolicy')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="insurancePolicy">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Insured Amount</label>
                                <input [ngClass]="{'is-invalid': (insurancePolicySelected) && (insurancePolicy.get('insuredAmount').errors)}"
                                        class="form-control rounded" formControlName="insuredAmount"
                                       placeholder="Insured Amount"
                                       type="number" required/>
                                <div *ngIf="(insurancePolicySelected) && (insurancePolicy.get('insuredAmount').invalid)"
                                class="invalid-feedback">
                                    <div *ngIf="insurancePolicy.get('insuredAmount').errors.required">
                                        Insured amount is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-8">
                            <div class="form-group">
                                <!--                                <label class="title">Insurance Company Name</label>-->
                                <!--                                <input class="form-control rounded" formControlName="insuranceCompanyName"-->
                                <!--                                       placeholder="Insurance Company Name"-->
                                <!--                                       type="text"/>-->
                                <label for="insuranceCompanyName"><strong>Insurance Company</strong></label>
                                <select class="form-control"
                                        [ngClass]="{'is-invalid': (insurancePolicySelected) && (insurancePolicy.get('insuranceCompanyName').errors)}"
                                        formControlName="insuranceCompanyName"
                                        id="insuranceCompanyName">
                                    <option [ngValue]="null">--Select Insurance Company--</option>
                                    <option *ngFor="let insuranceCompany of insuranceCompanyList"
                                            [ngValue]="insuranceCompany.id">{{insuranceCompany.name}}</option>
                                </select>
                                <div *ngIf="(insurancePolicySelected) && (insurancePolicy.get('insuranceCompanyName').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="insurancePolicy.get('insuranceCompanyName').errors.required">
                                        Insured amount is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Insurance Policy Start </label>
                                <input class="form-control rounded" formControlName="policyStartDate"
                                       name="policyStartDate" placeholder="Insurance Policy Start date"
                                       [nbDatepicker]="insurancePolicyDate"
                                       *ngIf="calendarType === 'AD'">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['insurancePolicy',i,'policyStartDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['insurancePolicy',i,'policyStartDate']).value"></app-calendar>
                                <nb-datepicker #insurancePolicyDate></nb-datepicker>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Maturity Date</label>
                                <input class="form-control rounded" formControlName="maturityDate"
                                       name="policyStartDate" placeholder="Maturity Date" [nbDatepicker]="maturityDate"
                                       *ngIf="calendarType === 'AD'">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['insurancePolicy',i,'maturityDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['insurancePolicy',i,'maturityDate']).value"></app-calendar>
                                <nb-datepicker #maturityDate></nb-datepicker>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Insurance Policy Type</label>
                                <input class="form-control rounded" formControlName="insurancePolicyType"
                                       placeholder="Insurance Policy Type"
                                       type="text"/>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Surrender Value</label>
                                <input class="form-control rounded" formControlName="surrenderValue"
                                       placeholder="Surrender Value"
                                       type="number"/>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Earliest Surrender Date</label>
                                <input class="form-control rounded" formControlName="earlySurrenderDate"
                                       name="earlySurrenderDate" placeholder="Earliest Surrender Date"
                                       [nbDatepicker]="earlySurrenderDate"
                                       *ngIf="calendarType === 'AD'">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['insurancePolicy',i,'earlySurrenderDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['insurancePolicy',i,'earlySurrenderDate']).value"></app-calendar>
                                <nb-datepicker #earlySurrenderDate></nb-datepicker>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Considered Value</label>
                                <input class="form-control rounded" formControlName="consideredValue"
                                       placeholder="Considered Value"
                                       type="number"/>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Yearly Cash Back Amount <em class="sb-medium">(if any)</em></label>
                                <input class="form-control rounded" formControlName="cashBackAmount"
                                       placeholder="Yearly Cash Back Amount"
                                       type="number"/>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="securityForm.get('insurancePolicy') ['length'] > 1" class="text-right">
                        <input (click)="removeInsurance(i)"
                               class="align-self-end btn btn-sm btn-danger btn-primary"
                               type="button" value="Delete"/>
                    </div>
                    <br>
                </div>
                <div class="text-right">
                    <input (click)="addInsurancePolicy()" class="btn btn-sm btn-flat btn-primary" type="button"
                           value="Add More Insurance Policy"/>
                </div>

            </div>
            <hr>
        </nb-card>

        <!--        Bond Security Security -->
        <nb-card [hidden]="!bondSecurity" class="p-3">
            <div class="box-header with-border">
                <h2 class="box-title title">Bond Security</h2>
            </div>
            <hr>
            <div *ngFor="let bond of securityForm.get('bondSecurity')['controls']; let i = index"
                 class="font-weight-bold"
                 formArrayName="bondSecurity">
                <div [formGroupName]="i">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Name Of Bond</label>
                                <input [ngClass]="{'is-invalid': (bondSecurity) && (bond.get('nameOfBond').errors)}"
                                       class="form-control rounded" formControlName="nameOfBond"
                                       placeholder="Name of bond"
                                       type="text" required/>
                                <div *ngIf="(bondSecurity) && (bond.get('nameOfBond').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="bond.get('nameOfBond').errors.required">
                                        Bond name is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Tenure/Validity of Bond</label>
                                <input [ngClass]="{'is-invalid': (bondSecurity) && (bond.get('validityOfBond').errors)}"
                                       class="form-control rounded" formControlName="validityOfBond"
                                       placeholder="Tenure/Validity of Bond"
                                       type="text" required/>
                                <div *ngIf="(bondSecurity) && (bond.get('validityOfBond').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="bond.get('validityOfBond').errors.required">
                                        Tenure/Validity is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Coupon Rate (%)</label>
                                <input [ngClass]="{'is-invalid': (bondSecurity) && (bond.get('couponRate').errors)}"
                                       class="form-control rounded" formControlName="couponRate"
                                       placeholder="Tenure/Validity of Bond"
                                       type="number" required/>
                                <div *ngIf="(bondSecurity) && (bond.get('couponRate').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="bond.get('couponRate').errors.required">
                                        Coupon rate is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Bond Value</label>
                                <input [ngClass]="{'is-invalid': (bondSecurity) && (bond.get('bondValue').errors)}"
                                       class="form-control rounded" formControlName="bondValue"
                                       placeholder="Bond Value"
                                       type="number" required/>
                                <div *ngIf="(bondSecurity) && (bond.get('bondValue').invalid)"
                                     class="invalid-feedback">
                                    <div *ngIf="bond.get('bondValue').errors.required">
                                        Bond Value is required
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Bond Serial Number</label>
                                <input class="form-control rounded" formControlName="bondSerialNumber"
                                       placeholder="Bond serial number"
                                       type="number"/>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Issuer</label>
                                <input class="form-control rounded" formControlName="issuer"
                                       placeholder="Bond Value"
                                       type="number"/>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="title">Expiry Date</label>
                                <input class="form-control rounded" formControlName="expiryDate"
                                       name="expiryDate" placeholder="Expiry Date" [nbDatepicker]="expiryDate"
                                       *ngIf="calendarType === 'AD'">
                                <app-calendar
                                        (messageToEmit)="securityForm.get(['bondSecurity',i,'expiryDate']).patchValue($event?.eDate)"
                                        *ngIf="calendarType === 'BS'"
                                        [ePreDate]="securityForm.get(['bondSecurity',i,'expiryDate']).value"></app-calendar>
                                <nb-datepicker #expiryDate></nb-datepicker>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="securityForm.get('bondSecurity') ['length'] > 1" class="text-right">
                        <input (click)="removeBondSecurity(i)"
                               class="align-self-end btn btn-sm btn-danger btn-primary"
                               type="button" value="Delete"/>
                    </div>
                    <br>
                </div>
                <div class="text-right">
                    <input (click)="addMoreBondSecurity()" class="btn btn-sm btn-flat btn-primary" type="button"
                           value="Add More Bond"/>
                </div>

            </div>
            <hr>
        </nb-card>

        <div class="row">
            <div class="col-md-12">
                <label><b>Remarks Common to all Security</b></label>
                <textarea class="form-control" formControlName="remark" rows="4"
                          placeholder="Remarks Common to all Security"></textarea>
            </div>
        </div>
    </form>
</div>
