<nb-card class="p-3">
    <div class="box-header with-border">
        <h2 class="box-title title">Vehicle Security</h2>
    </div>
    <div [formGroup]="vehicleSecurityForm">
        <div *ngFor="let addMoreVehicle of vehicleSecurityForm.get('vehicleSecurity')['controls']; let i = index"
                class="font-weight-bold"
                formArrayName="vehicleSecurity">
            <div [formGroupName]="i">
                <br>
                <div class="row">
                    <div class="col-md-10">
                        <h5>{{i + 1}}) Details of Security Offered: Vehicle</h5>
                        <input type="checkbox" formControlName="vehicleOtherBranchChecked"> Property on another
                        branch location
                    </div>
                    <div *ngIf="vehicleSecurityForm.get('vehicleSecurity')['length']>1"
                         class="col-md-2 ">
                        <button (click)="removeVehicleForm(i)"
                                class="float-right btn tbn-sm btn-flat btn-danger" value="Delete">
                            <em class="fa fa-trash" style="color: white;"></em>
                        </button>
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="model"><strong>Model</strong></label>
                            <input class="form-control" formControlName="model" id="model" name="model"
                                   placeholder="Model"
                                   type="text" required />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="registrationNumber"><strong>Registration
                                Number</strong></label>
                            <input
                                    class="form-control" formControlName="registrationNumber"
                                    id="registrationNumber"
                                    name="registrationNumber" placeholder="Registration Number"
                                    type="text">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="registrationDate"><strong>Registration
                                Date</strong></label>
                            <input
                                    [nbDatepicker]="registrationDate"
                                    class="form-control" formControlName="registrationDate" fullWidth
                                    id="registrationDate" name="registrationDate"
                                    nbInput placeholder="Registration Date" *ngIf="calendarType === 'AD'">
                            <app-calendar
                                    (messageToEmit)="vehicleSecurityForm.get(['vehicleSecurity',i,'registrationDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="vehicleSecurityForm.get(['vehicleSecurity',i,'registrationDate']).value"></app-calendar>
                            <nb-datepicker #registrationDate></nb-datepicker>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="engineNumber"><strong>Engine Number</strong></label>
                            <input
                                    class="form-control" formControlName="engineNumber" id="engineNumber"
                                    name="model"
                                    placeholder="Engine Number" type="text">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="chassisNumber"><strong>Chassis Number</strong></label>
                            <input
                                    class="form-control" formControlName="chassisNumber" id="chassisNumber"
                                    name="chassisNumber"
                                    placeholder="Chassis Number" type="text">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="valuationAmount"><strong>'Valuation Amount'</strong></label>
                            <input class="form-control" formControlName="valuationAmount" id="valuationAmount"
                                    name="valuationAmount"
                                    placeholder="Valuation Amount" type="number">
                        </div>
                    </div>


                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="downPayment"><strong>Down Payment</strong></label>
                            <input class="form-control" formControlName="downPayment" id="downPayment"
                                    name="downPayment"
                                    placeholder="Down Payment" type="number">
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="remainingAmount"><strong>Remaining Amount</strong></label>
                            <input
                                    class="form-control" formControlName="remainingAmount" id="remainingAmount"
                                    [readOnly]="true"
                                    name="remainingAmount"
                                    placeholder="Remaining Amount" type="number">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="showroomCommission"><strong>Showroom
                                Commission</strong></label>
                            <input
                                    class="form-control" formControlName="showroomCommission"
                                    id="showroomCommission"
                                    name="showroomCommission" placeholder="Showroom Commission"
                                    type="number">
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicleQuotationDate">Quotation Date</label>
                            <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                   formControlName="vehicleQuotationDate"
                                   id="vehicleQuotationDate"
                                   name="vehicleQuotationDate" placeholder="Quotation Date"
                                   [nbDatepicker]="vehicaleQuotationDate"
                                   type="text"/>
                            <app-calendar
                                    (messageToEmit)="vehicleSecurityForm.get(['vehicleSecurity',i,'vehicleQuotationDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="vehicleSecurityForm.get(['vehicleSecurity',i,'vehicleQuotationDate']).value"></app-calendar>
                            <nb-datepicker #vehicaleQuotationDate></nb-datepicker>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div *ngIf="vehicleSecurityForm.get(['vehicleSecurity',i,'vehicleOtherBranchChecked']).value">
                            <div class="form-group">
                                <label>Select Branch</label>
                                <ng-select [multiple]="false"
                                        bindLabel="name"
                                        formControlName="vehicalBranch"
                                        placeholder="">
                                    <ng-option *ngFor="let branch of branchLists"
                                               [value]="branch">{{branch.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Valuator Name</label>
                            <ng-select [multiple]="false"
                                       bindLabel="name"
                                       placeholder=""
                                       formControlName="vehicalValuator" (click)="getValuatorList(i)">
                                <ng-option [value]="null">Select Valuator Name</ng-option>
                                <ng-option *ngFor="let valuator of securityValuator.landValuator[i]"
                                           [value]="valuator">{{valuator.name}}</ng-option>
                            </ng-select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicalValuatorDate">Valuated Date</label>
                            <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                   formControlName="vehicalValuatorDate"
                                   id="vehicalValuatorDate"
                                   name="vehicalValuatorDate" placeholder="Valuated Date"
                                   [nbDatepicker]="vehicalValuatorDate"
                                   type="text"/>
                            <app-calendar
                                    (messageToEmit)="vehicleSecurityForm.get(['vehicleSecurity',i,'vehicalValuatorDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="vehicleSecurityForm.get(['vehicleSecurity',i,'vehicalValuatorDate']).value"></app-calendar>
                            <nb-datepicker #vehicalValuatorDate></nb-datepicker>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicalValuatorRepresentative">Valuator Representative
                                Name</label>
                            <input class="form-control rounded" formControlName="vehicalValuatorRepresentative"
                                   id="vehicalValuatorRepresentative"
                                   name="vehicalValuatorRepresentative" placeholder="Valuator Representative Name"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicalStaffRepresentativeDesignation">Staff Representative
                                Designation 1</label>
                            <select class="form-control rounded"
                                    formControlName="vehicalStaffRepresentativeDesignation"
                                    id="vehicalStaffRepresentativeDesignation"
                                    name="vehicalStaffRepresentativeDesignation">
                                <option [ngValue]="null" hidden>Staff Representative Designation 1</option>
                                <option *ngFor="let designation of designationList"
                                        [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicalStaffRepresentativeName">Staff Representative Name
                                1</label>
                            <input class="form-control rounded" formControlName="vehicalStaffRepresentativeName"
                                   id="vehicalStaffRepresentativeName"
                                   name="vehicalStaffRepresentativeName" placeholder="Staff Representative Name 1"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicaleStaffRepresentativeDesignation2">Staff Representative
                                Designation 2</label>
                            <select class="form-control rounded"
                                    formControlName="vehicaleStaffRepresentativeDesignation2"
                                    id="vehicaleStaffRepresentativeDesignation2"
                                    name="vehicaleStaffRepresentativeDesignation2">
                                <option [ngValue]="null">Staff Representative Designation 2</option>
                                <option *ngFor="let designation of designationList"
                                        [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="vehicaleStaffRepresentativeName2">Staff Representative Name
                                2</label>
                            <input class="form-control rounded" formControlName="vehicaleStaffRepresentativeName2"
                                   id="vehicaleStaffRepresentativeName2"
                                   name="vehicaleStaffRepresentativeName2" placeholder="Staff Representative Name 2"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title">Ownership transfer date</label>
                            <input class="form-control rounded" formControlName="ownershipTransferDate"
                                   *ngIf="calendarType === 'AD'"
                                   name="ownershipTransferDate" placeholder="Ownership transfer date"
                                   [nbDatepicker]="ownershipDate">
                            <app-calendar
                                    (messageToEmit)="vehicleSecurityForm.get(['vehicleSecurity',i,'ownershipTransferDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="vehicleSecurityForm.get(['vehicleSecurity',i,'ownershipTransferDate']).value"></app-calendar>
                            <nb-datepicker #ownershipDate></nb-datepicker>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-12">
                        <h6>Showroom Details</h6>
                    </div>
                    <div class="col-md-5">
                        <div class="form-group">
                            <label class="title" for="showroomName">Showroom Name</label>
                            <input class="form-control rounded" formControlName="showroomName"
                                   id="showroomName"
                                   name="showroomName" placeholder="Showroom Name"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="form-group">
                            <label class="title" for="showroomAddress">Showroom Address</label>
                            <input class="form-control rounded" formControlName="showroomAddress"
                                   id="showroomAddress"
                                   name="showroomAddress" placeholder="Showroom Name"
                                   type="text"/>
                        </div>
                    </div>

                    <div class="col-md-12 form-group">
                        <label><b>Vehicle Remarks</b></label>
                        <textarea class="form-control" formControlName="vehicleRemarks" rows="4"
                                  placeholder="Vehicle Remarks"></textarea>
                    </div>

                </div>
                <hr>
            </div>
        </div>
        <div class="d-flex justify-content-sm-end">
            <p class="font-weight-bolder">Vehicle Exposure: %</p>
        </div>
        <div class="text-right">
        <input (click)="addVehicleSecurityForm()" class="btn btn-sm btn-flat btn-primary"
               type="button"
               value="Add More"/>
    </div>
    </div>
</nb-card>
