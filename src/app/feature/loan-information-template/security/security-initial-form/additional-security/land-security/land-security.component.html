<nb-card class="p-3">
    <div class="box-header with-border">
        <h2 class="box-title title">Details of Security Offered and Value Amount : LAND</h2>
    </div>
    <div [formGroup]="landSecurityForm">
        <div *ngFor="let land of landSecurityForm.get('landSecurity')['controls']; let i = index"
             class="font-weight-bold"
             formArrayName="landSecurity">
            <div [formGroupName]="i">
                <input type="checkbox" formControlName="landOtherBranchChecked"> Property on another branch location
                <div class="row justify-content-end">
                    <button class="btn btn-primary sb-small mr-2"
                            (click)="openSiteVisitModel('Land Security'+' '+(i+1))">Inspect Site Visit</button>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="owner"><strong>Owner</strong></label>
                            <input class="form-control form-control-sm-error rounded" formControlName="owner"
                                   id="owner" name="owner" placeholder="Owner Name" type="text" required/>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="location">Location</label>
                            <input class="form-control rounded" formControlName="location"
                                   id="location"
                                   name="location" placeholder="location"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label class="title" for="plotNumber">Plot No.</label>
                            <input class="form-control rounded" formControlName="plotNumber"
                                   id="plotNumber"
                                   name="plotNumber" placeholder="Plot No."
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label class="title" for="areaFormat">Area Format</label>
                            <nb-select formControlName="areaFormat" placeholder="select area format" id="areaFormat"
                                       fullWidth>
                                <nb-option *ngFor="let format of areaFormat" [value]="format">{{format}}</nb-option>
                            </nb-select>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label class="title" for="area">Area</label>
                            <input class="form-control rounded" formControlName="area"
                                   id="area"
                                   name="area" placeholder="area"
                                   type="text"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label for="landConsideredValue">Considered Value</label>
                            <input class="form-control"
                                   formControlName="landConsideredValue"
                                   id="landConsideredValue" name="total" placeholder="considered value">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="marketValue">Fair Market Value</label>
                            <input class="form-control rounded"
                                   formControlName="marketValue"
                                   id="marketValue"
                                   name="marketValue" placeholder="market value"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="title" for="distressValue">Distress Value</label>
                            <input class="form-control rounded"
                                   formControlName="distressValue"
                                   id="distressValue"
                                   name="distressValue" placeholder="distress value"
                                   type="text"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div *ngIf="landSecurityForm.get(['landSecurity',i,'landOtherBranchChecked']).value">
                            <div class="form-group">
                                <label>Select Branch</label>
                                <ng-select [multiple]="false"
                                        bindLabel="name"
                                        formControlName="landBranch"
                                        placeholder="">
                                    <ng-option *ngFor="let branch of branchLists"
                                               [value]="branch">{{branch.name}}</ng-option>
                                </ng-select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="title" for="landCollateralOwnerRelationship">Collateral Owner
                                Relationship</label>
                            <select class="form-control rounded" formControlName="landCollateralOwnerRelationship"
                                    id="landCollateralOwnerRelationship"
                                    name="landCollateralOwnerRelationship">
                                <option [ngValue]="null">--Select Relationship--</option>
                                <option *ngFor="let relationship of collateralOwnerRelationshipList.relation"
                                        [ngValue]="relationship.id">{{relationship.name}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="title" for="roadAccessBluePrintLand">Is road access seen in blueprint or
                                not</label>
                            <select class="form-control rounded"
                                    formControlName="roadAccessBluePrint"
                                    id="roadAccessBluePrintLand">
                                <option [ngValue]="null">--Select Road Access--</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 form-group">
                        <label for="roadAccessDescribeLand"><strong>Briefly describe the road access</strong></label>
                        <textarea class="form-control"
                                  formControlName="roadAccessDescribe"
                                  id="roadAccessDescribeLand"
                                  placeholder="Road Access Description"
                                  rows="5"
                                  type="text"></textarea>
                    </div>
                    <div class="col-md-6 form-group">
                        <label for="landSecurityLegalDocumentAddress"><strong>Address as per Legal Document</strong></label>
                        <textarea class="form-control"
                                  formControlName="landSecurityLegalDocumentAddress"
                                  id="landSecurityLegalDocumentAddress"
                                  name="landSecurityLegalDocumentAddress"
                                  placeholder="Address as per Legal Document"
                                  rows="5"
                                  type="text" maxlength="256"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group form-inline">
                            <nb-checkbox id="ownerKycInfoForLand{{i}}" class="ml-2"
                                         formControlName="landOwnerKyc"
                                         (checkedChange)="landOwnerKycCheck($event, i)">
                                <h6>Owner KYC Applicable</h6>
                            </nb-checkbox>
                        </div>
                    </div>
                </div>
                <div class="form-group" *ngIf="landSecurityForm.get(['landSecurity', i, 'landOwnerKyc']).value === true">
                    <label>
                        <mark><strong>Note</strong>: <em>Please write <strong>Late</strong> in front of the name if
                            relation person is deceased</em></mark>
                    </label>
                    <app-owner-kyc-applicable></app-owner-kyc-applicable>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Valuator Name</label>
                            <ng-select [multiple]="false"
                                       bindLabel="name"
                                       placeholder=""
                                       formControlName="landValuator" (click)="valuator(i)">
                                <ng-option [value]="null">Select Valuator Name</ng-option>
                                <ng-option *ngFor="let valuator of securityValuator.landValuator[i]"
                                           [value]="valuator">{{valuator.name}}</ng-option>
                            </ng-select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="landValuatorDate">Valuated Date</label>
                            <input *ngIf="calendarType === 'AD'" class="form-control rounded"
                                   formControlName="landValuatorDate"
                                   id="landValuatorDate"
                                   name="landValuatorDate" placeholder="Valuated Date"
                                   [nbDatepicker]="landValuatorDate"
                                   type="text"/>
                            <app-calendar
                                    (messageToEmit)="landSecurityForm.get(['landSecurity',i,'landValuatorDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="landSecurityForm.get(['landSecurity',i,'landValuatorDate']).value"></app-calendar>
                            <nb-datepicker #landValuatorDate></nb-datepicker>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="landValuatorRepresentative">Valuator Representative
                                Name</label>
                            <input class="form-control rounded" formControlName="landValuatorRepresentative"
                                   id="landValuatorRepresentative"
                                   name="landValuatorRepresentative" placeholder="Valuator Representative Name"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="landStaffRepresentativeDesignation">Staff Representative
                                Designation 1</label>
                            <select class="form-control rounded"
                                    formControlName="landStaffRepresentativeDesignation"
                                    id="landStaffRepresentativeDesignation"
                                    name="landStaffRepresentativeDesignation">
                                <option [ngValue]="null" hidden>Staff Representative Designation 1</option>
                                <option *ngFor="let designation of designationList"
                                        [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="landStaffRepresentativeName">Staff Representative Name
                                1</label>
                            <input class="form-control rounded" formControlName="landStaffRepresentativeName"
                                   id="landStaffRepresentativeName"
                                   name="landStaffRepresentativeName" placeholder="Staff Representative Name 1"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="landStaffRepresentativeDesignation2">Staff Representative
                                Designation 2</label>
                            <select class="form-control rounded"
                                    formControlName="landStaffRepresentativeDesignation2"
                                    id="landStaffRepresentativeDesignation2"
                                    name="landStaffRepresentativeDesignation2">
                                <option [ngValue]="null">Staff Representative Designation 2</option>
                                <option *ngFor="let designation of designationList"
                                        [ngValue]="designation?.roleName">{{designation?.roleName}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title" for="landStaffRepresentativeName2">Staff Representative Name
                                2</label>
                            <input class="form-control rounded" formControlName="landStaffRepresentativeName2"
                                   id="landStaffRepresentativeName2"
                                   name="landStaffRepresentativeName2" placeholder="Staff Representative Name 2"
                                   type="text"/>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title">Type of property</label>
                            <select class="form-control rounded" formControlName="typeOfProperty"
                                    name="typeOfProperty">
                                <option [value]="null">Select Type of property</option>
                                <option *ngFor="let property of typeOfProperty"
                                        [value]="property">{{property}}</option>
                            </select>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title">Ownership transfer date</label>
                            <input class="form-control rounded" formControlName="ownershipTransferDate"
                                   name="ownershipTransferDate" placeholder="Ownership transfer date"
                                   [nbDatepicker]="ownershipDate"
                                   *ngIf="calendarType === 'AD'">
                            <app-calendar
                                    (messageToEmit)="landSecurityForm.get(['landSecurity',i,'ownershipTransferDate']).patchValue($event?.eDate)"
                                    *ngIf="calendarType === 'BS'"
                                    [ePreDate]="landSecurityForm.get(['landSecurity',i,'ownershipTransferDate']).value"></app-calendar>
                            <nb-datepicker #ownershipDate></nb-datepicker>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="title">Ownership transfer Through</label>
                            <select class="form-control rounded" formControlName="ownershipTransferThrough"
                                    name="ownershipTransferThrough"
                                    (change)="resetOtherTransferParameter('landSecurity', i,false)">
                                <option [value]="null">Select Ownership transfer through</option>
                                <option *ngFor="let ownership of ownershipTransferEnumPair"
                                        [ngValue]="ownership.key">{{ownership.value}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3"
                         *ngIf="landSecurityForm.get(['landSecurity',i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.OTHER)">
                        <div class="form-group">
                            <label class="title">Other</label>
                            <input class="form-control rounded" formControlName="otherOwnershipTransferValue"
                                   name="otherOwnershipTransferValue" placeholder="Other Ownership Transfer Mode"
                                   type="text"/>
                        </div>
                    </div>
                    <ng-container>
                        <div class="col-md-12"
                             *ngIf="landSecurityForm.get(['landSecurity' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.SALE)">
                            <strong>Has transfer date elapsed by 6 months plus 35 days? </strong>
                            <input class="ml-md-3" type="radio" value="Yes" formControlName="saleOwnershipTransfer"
                                   (input)="resetOtherTransferParameter('landSecurity', i,true)">
                            <label>Yes</label>
                            <input class="ml-md-3" type="radio" value="No" formControlName="saleOwnershipTransfer"
                                   (input)="resetOtherTransferParameter('landSecurity', i,true)">
                            <label>No</label>
                        </div>
                        <div class="col-md-12"
                             *ngIf="landSecurityForm.get(['landSecurity' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.FAMILY_SEPARATION)">
                            <strong>Has transfer date elapsed by 3 month? </strong>
                            <input class="ml-md-3" type="radio" value="Yes"
                                   formControlName="familyTransferOwnershipTransfer"
                                   (input)="resetOtherTransferParameter('landSecurity', i,true)">
                            <label>Yes</label>
                            <input class="ml-md-3" type="radio" value="No"
                                   formControlName="familyTransferOwnershipTransfer"
                                   (input)="resetOtherTransferParameter('landSecurity', i,true)">
                            <label>No</label>
                        </div>
                        <div class="col-md-12"
                             *ngIf="landSecurityForm.get(['landSecurity' , i,'ownershipTransferThrough']).value === ownershipTransfers.id(ownershipTransfers.GIFT_BAKASPATRA)">
                            <strong>Has transfer date elapsed by 2 year plus 35 days? </strong>
                            <input class="ml-md-3" type="radio" value="Yes" formControlName="giftOwnershipTransfer"
                                   (input)="resetOtherTransferParameter('landSecurity', i,true)">
                            <label>Yes</label>
                            <input class="ml-md-3" type="radio" value="No" formControlName="giftOwnershipTransfer"
                                   (input)="resetOtherTransferParameter('landSecurity', i,true)">
                            <label>No</label>
                        </div>
                    </ng-container>
                    <ng-container>
                        <div class="col-md-12 d-inline-flex"
                             *ngIf="landSecurityForm.get(['landSecurity' , i,'saleOwnershipTransfer']).value === 'No'">
                            <i>*Incase of No, specify registration amount in the transfer deed (as applicable)</i>
                            <input class="form-control col-md-3" formControlName="saleRegistrationAmount"
                                   type="number" placeholder="Amount">
                        </div>
                        <div class="col-md-12 d-inline-flex"
                             *ngIf="landSecurityForm.get(['landSecurity' , i,'familyTransferOwnershipTransfer']).value === 'No'">
                            <i>*Incase of No, specify registration amount in the transfer deed (as applicable)</i>
                            <input class="form-control col-md-3" formControlName="familyRegistrationAmount"
                                   type="number" placeholder="Amount">
                        </div>
                        <div class="col-md-12 d-inline-flex"
                             *ngIf="landSecurityForm.get(['landSecurity' , i,'giftOwnershipTransfer']).value === 'No'">
                            <i>*Incase of No, specify registration amount in the transfer deed (as applicable)</i>
                            <input class="form-control col-md-3" formControlName="giftRegistrationAmount"
                                   type="number" placeholder="Amount">
                        </div>
                    </ng-container>
                    <div class="col-md-12">
                        <app-security-revaluation></app-security-revaluation>
                    </div>
                    <div *ngIf="landSecurityForm.get('landSecurity') ['length'] > 1" class="col-md-1">
                        <input (click)="removeLandSecurity(i)"
                               class="align-self-end btn btn-sm btn-danger btn-primary"
                               type="button" value="Delete"/>
                    </div>

                </div>

            </div>
            <hr>
        </div>
        <div class="text-right">
            <input (click)="addMoreLand()" class="btn btn-sm btn-flat btn-primary" type="button"
                   value="Add More Land"/>
        </div>
        <div class="row">
            <div class="form-group col-md-12">
                <label class="title rounded" for="description">Description/Details of Security
                    Offered</label>
                <textarea class="form-control rounded" cols="150" formControlName="description"
                          id="description"
                          placeholder="details of security offered"
                          rows="5"></textarea>
            </div>
        </div>
    </div>
</nb-card>
