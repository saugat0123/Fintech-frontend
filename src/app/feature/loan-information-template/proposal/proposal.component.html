<div class="tab-pane fade active show" id="proposal">
  <div class="row">
    <div class="col-md-12">
      <nb-card>
        <nb-card-body>
          <div class="form-group">
            <form (ngSubmit)="onSubmit()" [formGroup]="proposalForm" class="form-horizontal">
              <div class="row">
                <div class="col-md-4" *ngIf="checkApproved">
                  <div class="form-group">
                    <label class="title" for="existingLimit"><strong>Existing Limit</strong></label>
                    <input class="form-control"
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.existingLimit.errors }"
                        formControlName="existingLimit" id="existingLimit"
                        name="existingLimit" placeholder="Existing limit"
                        type="number">
                    <div *ngIf=" (submitted)  && formControls.existingLimit.errors"
                         class="invalid-feedback">
                      <span *ngIf="(formControls.existingLimit.errors.required)">Existing Limit is required</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4" *ngIf="checkApproved">
                  <div class="form-group">
                    <label class="title" for="outStandingLimit"><strong>Outstanding Limit</strong></label>
                    <input class="form-control"
                           [ngClass]="{ 'is-invalid': (submitted) && formControls.outStandingLimit.errors }"
                           formControlName="outStandingLimit" id="outStandingLimit"
                           name="outStandingLimit" placeholder="Outstanding limit"
                           type="number">
                    <div *ngIf=" (submitted)  && formControls.outStandingLimit.errors"
                         class="invalid-feedback">
                      <span *ngIf="(formControls.outStandingLimit.errors.required)">Outstanding Limit is required</span>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="proposedLimit"><strong>Proposed Limit</strong></label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.proposedLimit.errors }"
                        class="form-control"
                        formControlName="proposedLimit" id="proposedLimit"
                        name="proposedLimit" placeholder="Proposed limit"
                        type="number" (input)="checkRepaymentMode()">
                    <div *ngIf=" (submitted)  && formControls.proposedLimit.errors"
                         class="invalid-feedback">
                      <span *ngIf="(formControls.proposedLimit.errors.required)">Proposed Limit is required</span>

                      <span *ngIf="(formControls.proposedLimit.errors.min)">Proposed Limit must be positive numerical value.</span>
                      <span *ngIf="proposalForm.get('proposedLimit').hasError('amountRange') ">Minimum proposed amount must be greater than Rs.<strong>{{minimumAmountLimit}}</strong></span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="interestRate"><strong>Interest
                      Rate(%)</strong></label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.interestRate.errors }"
                        class="form-control" formControlName="interestRate"
                        id="interestRate" name="interestRate" placeholder="Interest Rate(%)"
                        [(ngModel)]="interestLimit"
                        type="number" (input)="checkRepaymentMode()">
                    <div *ngIf="(submitted) && formControls.interestRate.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.interestRate.errors.required">Interest Rate is required</span>
                      <span *ngIf="formControls.interestRate.errors.min">Interest Rate must be positive numerical value.</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="baseRate"><strong>Base Rate(%)</strong></label>
                    <input [ngClass]="{ 'is-invalid': (submitted) && formControls.baseRate.errors }"
                           class="form-control" formControlName="baseRate" id="baseRate"
                           name="baseRate" placeholder="Base Rate(%)"
                           type="number">
                    <div *ngIf="(submitted) && formControls.baseRate.invalid"
                         class="invalid-feedback">
                      <span
                          *ngIf="formControls.baseRate.errors.required">Base Rate is required</span>

                      <span *ngIf="formControls.baseRate.errors.min">Base Rate must be positive numerical value.</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="premiumRateOnBaseRate"><strong>Premium Rate On Base
                      Rate(%)</strong></label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.premiumRateOnBaseRate.errors }"
                        class="form-control"
                        class="form-control" formControlName="premiumRateOnBaseRate"
                        id="premiumRateOnBaseRate" name="premiumRate"
                        placeholder="Base Rate(%)" placeholder="Premium Rate On Base Rate(%)"
                        type="number" readonly>
                    <div *ngIf="(submitted) && formControls.premiumRateOnBaseRate.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.premiumRateOnBaseRate.errors.required">Premium Rate On Base Rate is required</span>

                      <span *ngIf="formControls.premiumRateOnBaseRate.errors.min">Premium Rate On Base Rate must be positive numerical value.</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="serviceCharge"><strong>Service Charge </strong>
                      <input
                          [ngClass]="{ 'is-untouched': (submitted) && formControls.serviceChargeMethod.errors }"
                          formControlName="serviceChargeMethod"
                          name="serviceChargeMethod" type="radio"
                          value="PERCENT"><strong>% </strong>
                      <input formControlName="serviceChargeMethod" name="serviceChargeMethod"
                             type="radio" value="FLAT"><strong> Flat</strong>
                      <small
                          *ngIf="(submitted) && formControls.serviceChargeMethod.invalid && formControls.serviceChargeMethod.errors.required"
                          style="color:#DC3545">
                        Charge method is required
                      </small>
                    </label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.serviceCharge.errors }"
                        class="form-control" formControlName="serviceCharge"
                        id="serviceCharge"
                        name="serviceCharge" placeholder="Service charge"
                        type="number">
                    <div *ngIf="(submitted) && formControls.serviceCharge.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.serviceCharge.errors.required">Service Charge is required</span>

                      <span *ngIf="formControls.serviceCharge.errors.min">Service Charge must be positive numerical value.</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="tenureDurationInMonths"><strong>Tenure Duration in
                      Month.</strong></label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.tenureDurationInMonths.errors }"
                        class="form-control"
                        formControlName="tenureDurationInMonths" id="tenureDurationInMonths"
                        placeholder="Tenure Duration in Months"
                        type="number" (input)="checkRepaymentMode()">

                    <!--                                        <input [nbDatepicker]="tenurePicker"-->
                    <!--                                               [ngClass]="{ 'is-invalid':submitted &&formControls.tenureDurationInMonths.errors}"-->
                    <!--                                               class="form-control rounded"-->
                    <!--                                               formControlName="tenureDurationInMonths"-->
                    <!--                                               id="tenureDurationInMonths" placeholder="Enter the date"-->
                    <!--                                               type="text"/>-->
                    <!--                                        <nb-datepicker #tenurePicker></nb-datepicker>-->

                    <div *ngIf="(submitted) && formControls.tenureDurationInMonths.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.tenureDurationInMonths.errors.required ">Tenure duration is required.</span>
                      <span *ngIf="formControls.tenureDurationInMonths.errors.min ">Tenure duration must be positive numerical value.</span>
                    </div>
                  </div>
                </div>

                <!--                                start of repayment mode-->
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="repaymentMode"><strong>Repayment Mode</strong></label>
                    <select
                        [ngClass]="{ 'is-invalid': (submitted ) && formControls.repaymentMode.errors }"
                        class="custom-select" formControlName="repaymentMode"
                        id="repaymentMode"
                        name="repaymentMode"
                        (change)="checkRepaymentMode()">
                      <option [ngValue]="null" hidden selected>Select</option>
                      <option value="EMI">EMI</option>
                      <option value="EQI">EQI</option>
                      <option value="MONTHLY">Monthly</option>
                      <option value="QUARTERLY">Quarterly</option>
                      <option value="YEARLY">Yearly</option>
                    </select>
                    <div *ngIf="(submitted) && formControls.repaymentMode.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.repaymentMode.errors.required">Repayment mode is required</span>
                    </div>
                  </div>
                </div>
                <!--                                end of repayment mode-->

                <!--                start of installment amount div-->
                <div class="col-md-4"
                     *ngIf="proposalForm.get('repaymentMode').value === 'EMI' || proposalForm.get('repaymentMode').value === 'EQI'">
                  <div class="form-group>">
                    <label class="title"> <strong>Installment Amount</strong></label>
                    <input
                        class="form-control" formControlName="installmentAmount"
                        id="installmentAmount"
                        name="installmentAmount" placeholder="Installment Amount"
                        type="number" readonly>
                  </div>
                </div>
                <!--                end of installment amount div-->
                <div class="col-md-4"
                     *ngIf="proposalForm.get('repaymentMode').value === 'MONTHLY' || proposalForm.get('repaymentMode').value === 'QUARTERLY' || proposalForm.get('repaymentMode').value === 'YEARLY'">
                  <div class="form-group>">
                    <label class="title"> <strong>Interest Amount</strong></label>
                    <input
                        class="form-control" formControlName="interestAmount"
                        id="interestAmount"
                        name="interestAmount" placeholder="Interest Amount"
                        type="number">
                  </div>
                </div>

                <!--                start of Moratorium period amount div-->
                <div class="col-md-4">
                  <div class="form-group>">
                    <label class="title"> <strong>Moratorium Period</strong></label>
                    <input
                        class="form-control" formControlName="moratoriumPeriod"
                        id="moratoriumPeriod"
                        name="moratoriumPeriod" placeholder="Example: 4 month"
                        type="number">
                  </div>
                </div>
                <!--                end of Moratorium Period amount div-->


                <!--                start of Prepayment charge  div-->
                <div class="col-md-4">
                  <div class="form-group>">
                    <label class="title"> <strong>Prepayment Charge</strong></label>
                    <input
                        class="form-control" formControlName="prepaymentCharge"
                        id="prepaymentCharge"
                        name="prepaymentCharge" placeholder="Prepayment Amount">
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="commitmentFee"><strong>Commitment Fee</strong></label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.commitmentFee.errors }"
                        class="form-control"
                        formControlName="commitmentFee" id="commitmentFee"
                        name="commitmentFee"
                        placeholder="Commitment Fee" type="number"/>
                    <div *ngIf="(submitted) && formControls.commitmentFee.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.commitmentFee.errors.required">Commitment Fee is required.</span>
                    </div>

                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title" for="collateralRequirement"><strong>Collateral requirement (in%)</strong></label>
                    <input
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.collateralRequirement.errors }"
                        class="form-control"
                        formControlName="collateralRequirement" id="collateralRequirement"
                        name="collateralRequirement"
                        placeholder="Collateral requirement" type="number"/>
                    <div *ngIf="(submitted) && formControls.collateralRequirement.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.collateralRequirement.errors.required">Collateral requirement is required.</span>
                    </div>

                  </div>
                </div>

                <div class="col-md-4">
                  <div class="form-group">
                    <label class="title"><strong>Limit Expiry/Loan Tenure </strong><br>
                      <div class="pt-3">
                        <input
                            [ngClass]="{ 'is-untouched': (submitted) && formControls.limitExpiryMethod.errors }"
                            formControlName="limitExpiryMethod"
                            name="limitExpiryMethod" type="radio"
                            value="ABSOLUTE"><strong>Absolute </strong>
                        <input formControlName="limitExpiryMethod" name="limitExpiryMethod"
                               type="radio" value="CUSTOM"><strong> Custom</strong>
                        <small
                            *ngIf="(submitted) && formControls.limitExpiryMethod.invalid && formControls.limitExpiryMethod.errors.required"
                            style="color:#DC3545">
                          Limit Expiry Method is required
                        </small>
                      </div>
                    </label>
                  </div>
                </div>
                <div class="col-md-4" *ngIf="absoluteSelected">
                  <div class="form-group">
                    <label class="title" for="dateOfExpiry"><strong>Date of Expiry</strong></label>
                    <input [nbDatepicker]="DOE" [ngClass]="{ 'is-invalid': (submitted) && formControls.dateOfExpiry.errors }"
                           class="form-control" formControlName="dateOfExpiry" id="dateOfExpiry"
                           name="dateOfExpiry" placeholder="Date of Expiry">
                    <nb-datepicker #DOE></nb-datepicker>
                    <div *ngIf="(submitted) && formControls.dateOfExpiry.invalid"
                         class="invalid-feedback">
                      <span
                          *ngIf="formControls.dateOfExpiry.errors.required">Date of Expiry is required</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4" *ngIf="customSelected">
                  <div class="form-group">
                    <label class="title" for="duration"><strong>Duration</strong></label>
                    <input [ngClass]="{ 'is-invalid': (submitted) && formControls.duration.errors }"
                           class="form-control" formControlName="duration" id="duration"
                           name="duration" placeholder="Duration"
                           type="number">
                    <div *ngIf="(submitted) && formControls.duration.invalid"
                         class="invalid-feedback">
                      <span
                          *ngIf="formControls.duration.errors.required">Duration is required</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4" *ngIf="customSelected">
                  <div class="form-group">
                    <label class="title" for="frequency"><strong>Frequency</strong></label>
                    <select
                        [ngClass]="{ 'is-invalid': (submitted ) && formControls.frequency.errors }"
                        class="custom-select" formControlName="frequency"
                        id="frequency"
                        name="frequency">
                      <option [ngValue]="undefined" hidden selected>Select</option>
                      <option value="DAY">Day(s)</option>
                      <option value="MONTH">Month(s)</option>
                      <option value="QUATER">Quarter(s)</option>
                      <option value="YEAR">Year(s)</option>
                    </select>
                    <div *ngIf="(submitted) && formControls.frequency.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.frequency.errors.required">Frequency is required</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4" *ngIf="customSelected">
                  <div class="form-group">
                    <label class="title" for="condition"><strong>Condition</strong></label>
                    <select
                        [ngClass]="{ 'is-invalid': (submitted ) && formControls.condition.errors }"
                        class="custom-select" formControlName="condition"
                        id="condition"
                        name="condition">
                      <option [ngValue]="undefined" hidden selected>Select</option>
                      <option value="FROM THE DATE OF APPROVAL">From the date of approval</option>
                      <option value="FROM THE DATE OF INITIATION OF LOAN">From the date of initiation of loan</option>
                      <option value="FROM EACH DEAL">From each deal</option>
                    </select>
                    <div *ngIf="(submitted) && formControls.condition.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.condition.errors.required">Condition is required</span>
                    </div>
                  </div>
                </div>

                <!--                end of Moratorium Period amount div-->
                <div class="col-md-12">
                  <div class="form-group">
                    <label class="title" for="disbursementCriteria"><strong>Disbursement
                      Criteria</strong></label>
                    <textarea
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.disbursementCriteria.errors }"
                        class="form-control"
                        formControlName="disbursementCriteria" id="disbursementCriteria"
                        name="disbursementCriteria"
                        placeholder="Disbursement Criteria"
                        rows="3"></textarea>
                    <div *ngIf="(submitted) && formControls.disbursementCriteria.invalid"
                         class="invalid-feedback">
                      <span *ngIf="formControls.disbursementCriteria.errors.required">Disbursement Criteria is required.</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="form-group">
                    <label class="title" for="repayment"><strong>Repayment</strong></label>
                    <textarea
                        [ngClass]="{ 'is-invalid': (submitted) && formControls.repayment.errors }"
                        class="form-control"
                        formControlName="repayment" id="repayment"
                        name="repayment"
                        placeholder="Repayment"
                        rows="3"></textarea>
                    <div *ngIf="(submitted) && formControls.repayment.invalid"
                         class="invalid-feedback">
                      <span
                          *ngIf="formControls.repayment.errors.required">Repayment is required.</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="form-group" style="max-height: 300px !important;height: 250px;">

                    <label class="title"><strong><sup class="text-danger">*</sup>Introduction/Justification
                      of
                      Loan</strong></label>
                    <!--                    <textarea-->
                    <!--                        [ngClass]="{ 'is-invalid': (submitted) && formControls.borrowerInformation.errors }"-->
                    <!--                        class="form-control"-->
                    <!--                        formControlName="borrowerInformation" id="borrowerInfo"-->
                    <!--                        name="borrowerInfo"-->
                    <!--                        placeholder="Borrower Information"-->
                    <!--                        rows="3"></textarea>-->


                    <ckeditor formControlName="borrowerInformation"
                              [style]="{height:'250px !important;'}"
                              placeholder="Insert borrower Information..."
                              required
                              [config]="ckeConfig"
                              [ngClass]="{'is-invalid': formControls.borrowerInformation.invalid && submitted}">
                    </ckeditor>
                  </div>


                </div>


                <div class="clearfix"></div>
                <div class="col-md-12" style="padding-top: 70px;">
                  <div *ngIf="submitted">
                    <span *ngIf="formControls.borrowerInformation.invalid" class="text-danger">
                      <sup>*</sup>Borrower Information is required.</span>
                  </div>
                  <h6><strong>Additional Description</strong></h6>
                </div>
                <div class="col-md-12 form-group">
                  <nb-checkbox (change)="checkChecked($event.target.checked,'waiver')"
                               [checked]="waiverChecked">
                    <b>Waiver/Deviation</b>
                  </nb-checkbox>
                  <div *ngIf="waiverChecked">
                    <!--                    <textarea class="form-control"-->
                    <!--                              formControlName="waiverConclusionRecommendation" placeholder="Waiver"-->
                    <!--                              rows="2"></textarea>-->
                    <ckeditor formControlName="waiverConclusionRecommendation"
                              [config]="ckeConfig"></ckeditor>
                  </div>

                </div>
                <div class="col-md-12 form-group">
                  <nb-checkbox (change)="checkChecked($event.target.checked,'sol')"
                               [checked]="solChecked"><b>Single
                    Obligor Limit</b>
                  </nb-checkbox>
                  <div *ngIf="solChecked">
                    <!--                    <textarea class="form-control"-->
                    <!--                              formControlName="solConclusionRecommendation"-->
                    <!--                              placeholder="Single Obligor Limit "-->
                    <!--                              rows="2"></textarea>-->
                    <ckeditor formControlName="solConclusionRecommendation"
                              [config]="ckeConfig"></ckeditor>
                  </div>
                </div>
                <div class="col-md-12 form-group">

                  <nb-checkbox (change)="checkChecked($event.target.checked,'risk')"
                               [checked]="riskChecked"><b>Risk &
                    Mitigation</b>
                  </nb-checkbox>
                  <div *ngIf="riskChecked">
                    <!--                    <textarea class="form-control"-->
                    <!--                              formControlName="riskConclusionRecommendation"-->
                    <!--                              placeholder="Risk & Mitigation "-->
                    <!--                              rows="2"></textarea>-->
                    <ckeditor formControlName="riskConclusionRecommendation"
                              [config]="ckeConfig"></ckeditor>
                  </div>
                </div>
              </div>

            </form>
          </div>
        </nb-card-body>
      </nb-card>
    </div>
  </div>
</div>
