<nb-card>
    <nb-card-body>
        <form [formGroup]="multiBankingForm">
            <div class="row">
                <div class="col-md-12">
                    <span><strong>Multi Banking ?</strong></span>
                    <nb-radio-group class="ml-1 d-inline-flex"
                                    formControlName="isMultiBanking"
                                    name="isMultiBanking"
                                    id="isMultiBanking">
                        <nb-radio [value]="true">Yes</nb-radio>
                        <nb-radio [value]="false">No</nb-radio>
                    </nb-radio-group>
                    <ng-container *ngIf="multiBankingForm.get('isMultiBanking').value === true">
                        <div class="row col-md-6">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="remark"><strong>First Pari Passu Agreement Date</strong></label>
                                    <input class="form-control text-center date-picker"
                                           formControlName="firstPari"
                                           placeholder="First Pari Passu Agreement Date"
                                           type="date"/>
                                    <!--                                    <input *ngIf="calendarType === 'BS'" formControlName="firstPari" hidden>-->
                                    <!--                                    <app-calendar *ngIf="calendarType === 'BS'" [ePreDate]="multiBankingForm.get('firstPari').value"-->
                                    <!--                                                  (messageToEmit)="multiBankingForm.get('firstPari').patchValue($event?.eDate)"></app-calendar>-->
                                    <!--                                    <nb-datepicker #firstPari></nb-datepicker>-->
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="remark"><strong>Latest Pari Passu Agreement Date</strong></label>
                                    <input class="form-control text-center"
                                           formControlName="lastPari"
                                           placeholder="Latest Pari Passu Agreement Date"
                                           type="date"/>
                                    <!--                                    <input *ngIf="calendarType === 'BS'" formControlName="lastPari" hidden>-->
                                    <!--                                    <app-calendar *ngIf="calendarType === 'BS'" [ePreDate]="multiBankingForm.get('lastPari').value"-->
                                    <!--                                                  (messageToEmit)="multiBankingForm.get('lastPari').patchValue($event?.eDate)"></app-calendar>-->
                                    <!--                                    <nb-datepicker #lastPari></nb-datepicker>-->
                                </div>
                            </div>
                        </div>
                        <table class="table table-bordered table-responsive-md table-hover table-sm sb-small text-center">
                            <thead>
                            <tr class="sb-bg-secondary text-white">
                                <th>S.N</th>
                                <th>Bank Name</th>
                                <th>Date</th>
                                <th>Funded Limited</th>
                                <th>Non Funded Limited</th>
                                <th>Total Limit</th>
                                <th>Funded O.S</th>
                                <th>Non Funded O.S</th>
                                <th>Total O.S</th>
                                <th>Remark (if any)</th>
                                <th *ngIf="multiBankingForm.get('multiBanking')['length'] > 1">Action</th>
                            </tr>
                            </thead>
                            <tbody *ngFor="let data of multiBankingForm.get('multiBanking')['controls']; let i = index"
                                   formArrayName="multiBanking">
                            <tr [formGroupName]="i">
                                <td>{{i + 1}}</td>
                                <td><input class="form-control text-center"
                                           formControlName="bankName"
                                           placeholder="Bank Name"
                                           type="text"/></td>
                                <td>
                                    <input class="form-control text-center"
                                           formControlName="date"
                                           placeholder="Date"
                                           type="date"/>
                                    <!--                                <nb-datepicker #date></nb-datepicker>-->
                                </td>
                                <td><input (keyup)="calculateTotalMultiBanking()"
                                           (change)="multiTotalLimit(i)"
                                           class="form-control text-center"
                                           formControlName="fundedLimited"
                                           placeholder="Funded Limited"
                                           type="number"/></td>
                                <td><input (keyup)="calculateTotalMultiBanking()"
                                           (change)="multiTotalLimit(i)"
                                           class="form-control text-center"
                                           formControlName="nonFundedLimited"
                                           placeholder="Non Funded Limited"
                                           type="number"/></td>
                                <td><input [readOnly]="true"
                                           class="form-control text-center"
                                           formControlName="totalLimit"
                                           placeholder="Total Limit"
                                           type="number"/></td>
                                <td><input (keyup)="calculateTotalMultiBanking()"
                                           (change)="multiTotalOS(i)"
                                           class="form-control text-center"
                                           formControlName="fundedOS"
                                           placeholder="Funded O.S"
                                           type="number"/></td>
                                <td><input (keyup)="calculateTotalMultiBanking()"
                                           (change)="multiTotalOS(i)"
                                           class="form-control text-center"
                                           formControlName="nonFundedOS"
                                           placeholder="Non Funded O.S"
                                           type="number"/></td>
                                <td><input [readOnly]="true"
                                           class="form-control text-center"
                                           formControlName="totalOS"
                                           placeholder="Total O.S"
                                           type="number"/></td>
                                <td><input class="form-control text-center"
                                           formControlName="remarks"
                                           placeholder="Remarks (if any)"
                                           type="text"/></td>
                                <td *ngIf="multiBankingForm.get('multiBanking')['length'] > 1">
                                    <input (click)="removeMultiBanking(i)"
                                           class="align-self-end btn btn-sm btn-danger btn-primary"
                                           type="button" value="Delete"/>
                                </td>
                            </tr>
                            </tbody>
                            <tr class="font-weight-bold">
                                <td colspan="2">Total</td>
                                <td></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="totalFundedLimited"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="totalNonFundedLimited"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="totalLimited1"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="totalFundedOS"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="totalNonFundedOS"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="totalOS1"
                                           type="number"></td>
                                <td></td>
                            </tr>
                        </table>
                        <div class="text-right">
                            <input (click)="addMultiBanking()" class="btn btn-sm btn-flat btn-primary"
                                   type="button" value="Add More"/>
                        </div>
                    </ng-container>
                </div>

                <div class="col-md-12">
                    <span><strong>Consortium Financing ? </strong></span>
                    <nb-radio-group class="ml-1 d-inline-flex"
                                    formControlName="isConsortium"
                                    name="isConsortium" id="isConsortium">
                        <nb-radio [value]="true">Yes</nb-radio>
                        <nb-radio [value]="false">No</nb-radio>
                    </nb-radio-group>
                    <ng-container *ngIf="multiBankingForm.get('isConsortium').value === true">
                        <div class="row col-md-6">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="remark"><strong>First Facilities Agreement Date</strong></label>
                                    <input class="form-control text-center"
                                           formControlName="firstFacility"
                                           placeholder="First Facilities Agreement Date"
                                           type="date"/>
                                    <!--                                <input *ngIf="calendarType === 'BS'" formControlName="firstFacility" hidden>-->
                                    <!--                                <app-calendar *ngIf="calendarType === 'BS'" [ePreDate]="multiBankingForm.get('firstFacility').value"-->
                                    <!--                                              (messageToEmit)="multiBankingForm.get('firstFacility').patchValue($event?.eDate)"></app-calendar>-->
                                    <!--                                    <nb-datepicker #firstFacility></nb-datepicker>-->
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="remark"><strong>Latest Facilities Agreement Date</strong></label>
                                    <input class="form-control text-center"
                                           formControlName="latestFacility"
                                           placeholder="Latest Facilities Agreement Date"
                                           type="date"/>
                                    <!--  <input *ngIf="calendarType === 'BS'" formControlName="latestFacility" hidden>-->
                                    <!--  <app-calendar *ngIf="calendarType === 'BS'" [ePreDate]="multiBankingForm.get('latestFacility').value"-->
                                    <!--              (messageToEmit)="multiBankingForm.get('latestFacility').patchValue($event?.eDate)"></app-calendar>-->
                                    <!--                                    <nb-datepicker #latestFacility></nb-datepicker>-->
                                </div>
                            </div>
                        </div>
                        <table class="table table-bordered table-responsive-md table-hover table-sm sb-small text-center">
                            <thead>
                            <tr class="sb-bg-secondary text-white">
                                <th>S.N</th>
                                <th>Bank Name</th>
                                <th>Date</th>
                                <th>Funded Limited</th>
                                <th>Non Funded Limited</th>
                                <th>Total Limit</th>
                                <th>Funded O.S</th>
                                <th>Non Funded O.S</th>
                                <th>Total O.S</th>
                                <th>Remark (if any)</th>
                                <th *ngIf="multiBankingForm.get('consortium')['length'] > 1">Action</th>
                            </tr>
                            </thead>
                            <tbody *ngFor="let data of multiBankingForm.get('consortium')['controls']; let index = index"
                                   formArrayName="consortium">
                            <tr [formGroupName]="index">
                                <td>{{index + 1}}</td>
                                <td><input class="form-control text-center"
                                           formControlName="conBankName"
                                           placeholder="Bank Name"
                                           type="text"/></td>
                                <td>
                                    <input class="form-control text-center"
                                           formControlName="conDate"
                                           placeholder="Date"
                                           type="date"/>
                                    <!--                                <nb-datepicker #date1></nb-datepicker></td>-->
                                <td><input (keyup)="calculateTotalConsortium()"
                                           (change)="consortiumTotalLimit(index)"
                                           class="form-control text-center"
                                           formControlName="conFundedLimited"
                                           placeholder="Funded Limited"
                                           type="number"/></td>
                                <td><input (keyup)="calculateTotalConsortium()"
                                           (change)="consortiumTotalLimit(index)"
                                           class="form-control text-center"
                                           formControlName="conNonFundedLimited"
                                           placeholder="Non Funded Limited"
                                           type="number"/></td>
                                <td><input [readOnly]="true"
                                           class="form-control text-center"
                                           formControlName="conTotalLimit"
                                           placeholder="Total Limit"
                                           type="number"/></td>
                                <td><input (keyup)="calculateTotalConsortium()"
                                           (change)="consortiumTotalOS(index)"
                                           class="form-control text-center"
                                           formControlName="conFundedOS"
                                           placeholder="Funded O.S"
                                           type="number"/></td>
                                <td><input (keyup)="calculateTotalConsortium()"
                                           (change)="consortiumTotalOS(index)"
                                           class="form-control text-center"
                                           formControlName="conNonFundedOS"
                                           placeholder="Non Funded O.S"
                                           type="number"/></td>
                                <td><input [readOnly]="true"
                                           class="form-control text-center"
                                           formControlName="conTotalOS"
                                           placeholder="Total O.S"
                                           type="number"/></td>
                                <td><input class="form-control text-center"
                                           formControlName="conRemarks"
                                           placeholder="Remarks (if any)"
                                           type="text"/></td>
                                <td *ngIf="multiBankingForm.get('consortium')['length'] > 1">
                                    <input (click)="removeConsortium(index)"
                                           class="align-self-end btn btn-sm btn-danger btn-primary"
                                           type="button" value="Delete"/>
                                </td>
                            </tr>
                            </tbody>
                            <tr class="font-weight-bold">
                                <td colspan="2">Total</td>
                                <td></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="conTotalFundedLimited"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="conTotalNonFundedLimited"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="conTotalLimited1"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="conTotalFundedOS"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="conTotalNonFundedOS"
                                           type="number"></td>
                                <td><input [readOnly]="true" class="form-control text-center"
                                           formControlName="conTotalOS1"
                                           type="number"></td>
                                <td></td>
                            </tr>
                        </table>
                        <div class="text-right">
                            <input (click)="addConsortium()" class="btn btn-sm btn-flat btn-primary"
                                   type="button" value="Add More"/>
                        </div>
                    </ng-container>
                </div>

                <div class="col-md-12">
                    <table class="table table-bordered table-responsive-md table-hover table-sm sb-small text-left">
                        <tbody>
                        <tr>
                            <th class="sb-bg-secondary text-white">Lead Bank</th>
                            <td><input class="form-control text-center"
                                       formControlName="leadBank"
                                       placeholder="Lead Bank"
                                       type="text"/></td>
                        </tr>
                        <tr>
                            <th class="sb-bg-secondary text-white">Last Audited Year</th>
                            <td><input class="form-control text-center"
                                       formControlName="lastAudited"
                                       placeholder="Last Audited Year"
                                       type="date"/>
                                <!--                                <nb-datepicker #auditedYear></nb-datepicker>-->
                            </td>
                        </tr>
                        <tr>
                            <th class="sb-bg-secondary text-white">Auditor's Name</th>
                            <td><input class="form-control text-center"
                                       formControlName="auditorName"
                                       placeholder="Auditor's Name"
                                       type="text"/></td>
                        </tr>
                        <tr>
                            <th class="sb-bg-secondary text-white">Tax Amount</th>
                            <td><input class="form-control text-center"
                                       formControlName="taxAmount"
                                       placeholder="Tax Amount"
                                       type="number"/></td>
                        </tr>
                        <tr>
                            <th class="sb-bg-secondary text-white">Name of Executive Head</th>
                            <td><input class="form-control text-center"
                                       formControlName="nameExecutive"
                                       placeholder="Name of Executive Head"
                                       type="text"/></td>
                        </tr>
                        <tr>
                            <th class="sb-bg-secondary text-white">Address of Executive Head</th>
                            <td><input class="form-control text-center"
                                       formControlName="addressExecutive"
                                       placeholder="Address of Executive Head"
                                       type="text"/></td>
                        </tr>
                        <tr>
                            <th class="sb-bg-secondary text-white">Date fo Appointment</th>
                            <td><input class="form-control text-center"
                                       formControlName="dateOfApp"
                                       placeholder="Date fo Appointment"
                                       type="date"/>
                                <!--                                <nb-datepicker #appointment></nb-datepicker>-->
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="col-md-12">
                    <div class="form-group">
                        <label for="remark"><strong>Remark</strong></label>
                        <textarea class="form-control" formControlName="remark" id="remark"
                                  name="remark" placeholder="Remark" rows="3"></textarea>
                    </div>
                </div>
            </div>
            <nb-card-footer *ngIf="fromProfile">
                <button (click)="submitForm()" class="btn float-right" nbButton type="submit">Save</button>
            </nb-card-footer>
        </form>
    </nb-card-body>
</nb-card>
