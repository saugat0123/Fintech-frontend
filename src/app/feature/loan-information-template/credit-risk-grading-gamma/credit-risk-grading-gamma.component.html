<section *ngIf="creditRiskGrading?.get('groupObject')['controls']">

    <nb-accordion class="mb-4">
        <nb-accordion-item>
            <nb-accordion-item-header>
                <em>
                    <mark><strong>click me to view Credit Scoring Breakdown</strong></mark>
                </em>
            </nb-accordion-item-header>
            <nb-accordion-item-body>
                <div>
                    <table class="table table-hover table-bordered text-center">
                        <thead>
                        <tr class="sb-bg-dark">
                            <th>S.N</th>
                            <th>Range of score</th>
                            <th>Perceived Risk</th>
                            <th>Decision</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>i</td>
                            <td>>=90</td>
                            <td>Virtually zero risk</td>
                            <td rowspan="5">Accept</td>
                        </tr>
                        <tr>
                            <td>ii</td>
                            <td>>=75</td>
                            <td>Lower risk</td>
                        </tr>
                        <tr>
                            <td>iii</td>
                            <td>>=65</td>
                            <td>Low risk</td>
                        </tr>
                        <tr>
                            <td>iv</td>
                            <td>>=55</td>
                            <td>Moderate risk</td>
                        </tr>
                        <tr>
                            <td>v</td>
                            <td>>=45</td>
                            <td>Average risk</td>

                        </tr>
                        <tr>
                            <td>vi</td>
                            <td>>=35</td>
                            <td>High risk</td>
                            <td>To be approved from one level CAD authority</td>
                        </tr>
                        <tr>
                            <td>vii</td>
                            <td>>=25</td>
                            <td>Pre-default risk</td>
                            <td>Minimum approving authority to be CCO</td>
                        </tr>
                        <tr>
                            <td>viii</td>
                            <td><25</td>
                            <td>Default risk</td>
                            <td>Decline</td>
                        </tr>

                        </tbody>
                    </table>
                </div>
            </nb-accordion-item-body>
        </nb-accordion-item>
    </nb-accordion>

    <form [formGroup]="creditRiskGrading" [nbSpinner]="spinner">
        <mark><strong>Note : All Risk Criteria need to be checked for scoring</strong></mark>
        <table class="table table-bordered table-striped text-center">
            <thead>
            <tr>
                <th>SN.</th>
                <th>Criteria</th>
                <th>Weight</th>
                <th>Parameter</th>
                <th *ngIf="fromProfile">Actual Parameter</th>
                <th>Score Obtained</th>
            </tr>
            </thead>
<!--            *ngIf="creditHistory?.toString() === '0'"-->
            <tbody formArrayName="groupObject"
                   *ngFor="let crg of creditRiskGrading?.get('groupObject')['controls']; let i =  index">
            <ng-container [formGroupName]="i">
                <ng-container *ngFor="let answer of crg?.value">
                    <tr style="background-color: #17a2b1" >
                        <th>Topic</th>
                        <th>{{answer?.groupName}}</th>
                        <th>{{answer?.weightage}} %</th>
                        <td></td>
                        <td></td>
                        <th><span>Total:</span>{{answer?.groupTotal}}</th>
                    </tr>
                    <tr *ngFor="let ans of questions[i]; let ii = index" [formGroup]="crg.get([i,'gammaQuestionAnswer'])">
                            <td>{{ii+1}}</td>
                            <td>{{ans}}</td>
                        <td></td>

                        <td>
                                <ul>
                                    <ng-container *ngFor="let answ of answers[i][ii]">
                                        <li>{{answ?.description}}</li>
                                    </ng-container>
                                </ul>
                            </td>
                            <td>
                                <ng-container>
                                    <div *ngFor="let answ of answers[i][ii]">
                                        {{answ?.points}}
                                        <input [name]="ans" (click)="click(answ?.points, ans, i)" [value]="answ?.points" type="radio">
                                    </div>
                                </ng-container>
                            </td>
                        <td>{{this.creditRiskGrading?.get(['groupObject', i])?.get([i, 'gammaQuestionAnswer'])?.get(ans).value}}</td>
                    </tr>
<!--                    <tr *ngFor="let hisAns of withCreditHistoryData[i]?.gammaQuestion; let ii = index">-->
<!--                        <td>{{ii + 1}}</td>-->
<!--                        <td class="desc-td-width">-->
<!--                                <span >{{hisAns?.description}}</span>-->
<!--                        </td>-->
<!--                        <td></td>-->
<!--                        <td>-->
<!--                            <ul>-->
<!--                                <ng-container *ngFor="let answer of hisAns?.answers">-->
<!--                                    <li>-->
<!--                                        {{ answer?.description }}-->
<!--                                    </li>-->
<!--                                </ng-container>-->
<!--                            </ul>-->
<!--                        </td>-->
<!--                        <td>-->
<!--                            <ng-container *ngFor="let answ of hisAns?.answers; let iii = index">-->
<!--                                <div  formGroupName="gammaQuestionAnswer">-->
<!--                                    <input (click)="onChangeOption(hisAns?.description, answ?.points, answ?.description, i, crg?.groupName)"-->
<!--                                           [checked]="totalPointMapper.get(hisAns?.description) === answ?.points"-->
<!--                                           class="form-check-input"-->
<!--                                           [value]="answ?.points"-->
<!--                                           [formControlName]="hisAns?.description"-->
<!--                                           [id]="hisAns?.description + iii"-->
<!--                                           type="radio">-->
<!--                                    <br>-->
<!--                                </div>-->
<!--                            </ng-container>-->
<!--                        </td>-->
<!--                        <td>-->
<!--                            {{creditRiskGrading?.get(['withCreditGroupObject', i, 'gammaQuestionAnswer'])?.get(hisAns?.description)?.value}}-->
<!--                        </td>-->
<!--                    </tr>-->
                </ng-container>
            </ng-container>
            </tbody>

            <tbody>
            <hr>
            Start without History Data
            <hr>

<!--            <ng-container formArrayName="withoutCreditGroupObject"-->
<!--                          *ngFor="let crg of creditRiskGrading?.get('withoutCreditGroupObject')?.value; let iv =  index">-->
<!--                <ng-container [formGroupName]="iv">-->
<!--                    <tr style="background-color: #17a2b1">-->
<!--                        <th>Topic</th>-->
<!--                        <th>{{crg?.groupName}}</th>-->
<!--                        <th>{{crg?.weightage}} %</th>-->
<!--                        <td></td>-->
<!--                        <td></td>-->
<!--                        <th><span>Total:</span>{{crg?.groupTotal}}</th>-->
<!--                    </tr>-->
<!--                    <tr *ngFor="let ans of withoutCreditHistoryData[iv]?.gammaQuestion; let v = index">-->
<!--                        <td>{{v + 1}}</td>-->
<!--                        <td class="desc-td-width">-->
<!--                            <span >{{ans?.description}}</span>-->
<!--                        </td>-->
<!--                        <td></td>-->
<!--                        <td>-->
<!--                            <ul>-->
<!--                                <ng-container *ngFor="let answer of ans?.answers">-->
<!--                                    <li>-->
<!--                                        {{ answer?.description }}-->
<!--                                    </li>-->
<!--                                </ng-container>-->
<!--                            </ul>-->
<!--                        </td>-->
<!--                        <td>-->
<!--                            <ng-container *ngFor="let answer of ans?.answers; let vi = index">-->
<!--                                <div  formGroupName="gammaQuestionAnswer">-->
<!--                                    <input (click)="onChangeOption(ans?.description, answer?.points, answer?.description, iv, crg?.groupName)"-->
<!--                                           [checked]="totalPointMapper.get(ans?.description) === answer?.points"-->
<!--                                           class="form-check-input"-->
<!--                                           [value]="answer?.points"-->
<!--                                           [formControlName]="ans?.description"-->
<!--                                           [id]="ans?.description + vi"-->
<!--                                           type="radio">-->
<!--                                    <br>-->
<!--                                </div>-->
<!--                            </ng-container>-->
<!--                        </td>-->
<!--                        <td>-->
<!--                            {{creditRiskGrading?.get(['withoutCreditGroupObject', iv, 'gammaQuestionAnswer'])?.get(ans?.description)?.value}}-->
<!--                        </td>-->
<!--                    </tr>-->
<!--                </ng-container>-->
<!--            </ng-container>-->
            </tbody>
            <tbody>
            <tr>
                <th class="text-center" colspan="3"><b>Grading:</b> {{grading === undefined ? '' : grading}}</th>
                <th [attr.colspan]="totalPointsColspan" class="text-center">Total Score:</th>
                <th class="text-center">{{totalPoints === undefined ? '' : totalPoints}}</th>
            </tr>
            </tbody>
        </table>
    </form>
    <!--<div *ngIf="fromProfile" class="py-4 d-flex justify-content-end">
        <button (click)="onSubmit()" nbButton type="button">save</button>
    </div>-->
</section>
<!--<app-overlay-spinner></app-overlay-spinner>-->

