<section>
    <div class="modal-header text-center" *ngIf="!fromProfile">
        <a (click)="onClose()" aria-label="Close" class="close cursor disable-print"
           data-dismiss="modal">
            <span aria-hidden="true">Ã—</span></a>
    </div>
    <nb-accordion class="mb-4 disable-print">
        <nb-accordion-item>
            <nb-accordion-item-header>
                <em>
                    <mark><strong>click me to view Credit Scoring Breakdown</strong></mark>
                </em>
            </nb-accordion-item-header>
            <nb-accordion-item-body>
                <div>
                    <table class="table table-hover table-bordered text-center">
                        <thead>
                        <tr class="sb-bg-dark">
                            <th>Risk Grade</th>
                            <th>Score Range</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>1A</td>
                            <td>180 & Above</td>
                        </tr>
                        <tr>
                            <td>1B</td>
                            <td>170 to 179</td>
                        </tr>
                        <tr>
                            <td>2A</td>
                            <td>160 to 169</td>
                        </tr>
                        <tr>
                            <td>2B</td>
                            <td>150 to 159</td>
                        </tr>
                        <tr>
                            <td>3A</td>
                            <td>140 to 149</td>
                        </tr>
                        <tr>
                            <td>3B</td>
                            <td>130 to 139</td>
                        </tr>
                        <tr>
                            <td>4A</td>
                            <td>120 to 129</td>
                        </tr>
                        <tr>
                            <td>4B</td>
                            <td>105 to 119</td>
                        </tr>
                        <tr>
                            <td>4C</td>
                            <td>90 to 104</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>80 to 89</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>70 to 79</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>Below 70</td>
                        </tr>

                        </tbody>
                    </table>
                </div>
            </nb-accordion-item-body>
        </nb-accordion-item>
    </nb-accordion>
    <form [formGroup]="creditRiskGrading" [nbSpinner]="spinner">
        <mark><strong>Note : All Risk Criteria need to be checked for scoring</strong></mark>
        <table class="table table-bordered table-striped text-center">
            <thead>
            <tr>
                <th>SN.</th>
                <th>Criteria</th>
                <th>Weight</th>
                <th>Parameter</th>
                <th *ngIf="fromProfile">Actual Parameter</th>
                <th>Score Obtained</th>
            </tr>
            </thead>
            <tbody>
            <ng-container>
                <ng-container
                        *ngFor="let answer of creditRiskGrading?.get(['groupObject', creditHistory])?.value; let j = index">
                    <tr style="background-color: #17a2b1">
                        <th>Topic</th>
                        <th>{{answer?.groupName}}</th>
                        <th>{{answer?.weightage}} %</th>
                        <td></td>
                        <td></td>
                        <th><span>Total:</span>{{answer?.groupTotal}}</th>
                    </tr>
                    <tr *ngFor="let ans of questions[creditHistory][0][j]; let ii = index">
                        <td>{{ii + 1}}</td>
                        <td>{{ans}}</td>
                        <td></td>

                        <td>
                            <ul>
                                <ng-container *ngFor="let answ of answers[creditHistory][0][j][ii]">
                                    <li>{{answ?.description}}</li>
                                </ng-container>
                            </ul>
                        </td>
                        <td>
                            <ng-container>
                                <div *ngFor="let answ of answers[creditHistory][0][j][ii]">
                                    <input [name]="ans + creditHistory +j "
                                           (click)="click(answ?.points, ans,j)"
                                           [disabled]="!fromProfile"
                                           [checked]="this.creditRiskGrading?.get(['groupObject', creditHistory, j])?.get('gammaQuestionAnswer')?.get(ans)?.value === answ?.points"
                                           type="radio">
                                </div>

                            </ng-container>
                        </td>
                        <td>{{this.creditRiskGrading?.get(['groupObject', creditHistory, j])?.get('gammaQuestionAnswer')?.get(ans)?.value}}</td>
                    </tr>

                </ng-container>
            </ng-container>
            </tbody>
            <tbody>
            <tr class="sb-bg-secondary">
                <th class="text-center" colspan="3"><b>Grading:</b> {{grading === undefined ? '' : grading}}</th>
                <th [attr.colspan]="totalPointsColspan" class="text-center">Total Score:</th>
                <th class="text-center">{{creditRiskGrading?.get('totalPoint')?.value}}</th>
            </tr>
            </tbody>
        </table>
        <div class="row">
            <label class="title" >Remarks</label>
            <textarea class="form-control rounded" [ngModelOptions]="{standalone: true}"
                      name="remarks" [(ngModel)]="remarks" placeholder="Remarks"
                      rows="2" type="text"></textarea>
        </div>
        <div class="row">
            <button class="float-sm-right" nbButton (click)="onSubmit()">Save</button>
        </div>
    </form>
</section>

