<nb-card>
  <nb-card-header>
    <div class="col-md-12">
      <div class="row">
        <div class="col-md-6">
          <div class="btn-group">
            <button
                (click)="isFilterCollapsed = !isFilterCollapsed"
                [attr.aria-expanded]="!isFilterCollapsed" aria-controls="searchModel"
                nbButton
                shape="rectangle"
                status="primary">
              <em class="fa fa-filter"> Filter</em>
            </button>

          </div>
        </div>
        <div class="col-md-6 d-flex justify-content-end">
          <button nbButton outline status="success" class="mr-2"
                  (click)="openTemplate(chooseCusType)" *ngIf="currentRoleTypeMaker">
            <i class="fa fa-plus"></i>
          </button>
          <button (click)="download()" nbButton outline
                  status="info">
            <i aria-hidden="true" class="fa fa-download"></i></button>
        </div>
      </div>
    </div>

    <div [ngbCollapse]="isFilterCollapsed" class="col-md-12" id="searchModel">
      <form [formGroup]="filterForm">
        <div class="row py-3">
          <div class="col-md-3 mb-3" *ngIf="accessSpecific || accessAll">
            <nb-select multiple placeholder="branches" formControlName="tempBranch" >
              <nb-option *ngFor="let branch of branchList" [value]="branch.id">{{branch.name}}</nb-option>
            </nb-select>
          </div>
          <div class="col-md-3 mb-3">
            <input class="form-control rounded" formControlName="name" id="customerName"
                   placeholder="Enter customer name">
          </div>
          <div class="col-md-3 mb-3">
            <ng-select formControlName="customerType" placeholder="Customer Type">
              <ng-option value="COMPANY">COMPANY</ng-option>
              <ng-option value="INDIVIDUAL">INDIVIDUAL</ng-option>
            </ng-select>
          </div>
          <div class="col-md-3 mb-3">
            <ng-select [multiple]="false"
                       [appendTo]="'body'"
                       formControlName="idRegPlace"
                       id="idRegPlace"
                       placeholder="Id Registration place"
                       type="text">
              <ng-option *ngFor="let district of allDistrict" [value]="district?.name">
                {{district?.name}}
              </ng-option>
            </ng-select>
          </div>
        </div>

        <div class="col-md-12 p-0">
          <button (click)="onSearch()" [disabled]="!filterForm.valid" class="mr-2" nbButton
                  shape="rectangle"
                  status="info">Search
          </button>
          <button nbButton shape="rectangle" (click)=" clear()" status="danger" type="button">Clear
          </button>
        </div>
      </form>
    </div>

  </nb-card-header>
  <nb-card-body>
    <br>
    <table class="table table-bordered table-hover " id="add-branch-table">
      <thead>
      <tr>
        <th *ngIf="!isMaker">Branch</th>
        <th>Customer Name</th>
        <th>Customer Type</th>
        <th>ID Type</th>
        <th>ID Number</th>
        <th>ID Issue Place</th>
        <th>Email</th>
        <th>Contact No</th>
        <th>Associated Since</th>


      </tr>
      </thead>
      <tbody>
      <tr (click)="customerProfile(model.associateId,model.id,model.customerType)"
          *ngFor="let model of customerList;let i=index" class="cursor">
        <td *ngIf="!isMaker">{{model?.branch?.name}}</td>
        <td>{{model?.name}}</td>
        <td>{{model?.customerType}}</td>
        <td>{{model?.idType || 'NA'}}</td>
        <td>{{model?.idNumber || 'NA'}}</td>
        <td>{{model?.idRegPlace || 'NA'}}</td>
        <td>{{model?.email || 'NA'}}</td>

        <td>{{model?.contactNo || 'NA'}}</td>
        <td>{{(model?.createdAt|date) || 'NA'}}</td>

      </tr>

      </tbody>
    </table>
    <app-spinner *ngIf="spinner" class="d-flex justify-content-center"></app-spinner>
    <!-- ===================table-pagination==================== -->
    <app-paging (changePage)="changePage($event)" *ngIf="!spinner"
                [pageable]="pageable"></app-paging>
    <!-- ===================table-pagination==================== -->
  </nb-card-body>


</nb-card>

<ng-template #chooseCusType>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Choose Customer Type</h4>
    <a (click)="onClose()" aria-label="Close" class="close pull-right cursor">
      <span aria-hidden="true">&times;</span>
    </a>
  </div>
  <div class="modal-body">

    <div class="row">
      <div class="col-md-12">
        <ng-select [(ngModel)]="customerType" placeholder="select Customer Type">
          <ng-option value="COMPANY">COMPANY</ng-option>
          <ng-option value="INDIVIDUAL">INDIVIDUAL</ng-option>
        </ng-select>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-success float-right" (click)="getForm()">Next
    </button>
  </div>
</ng-template>
<app-overlay-spinner></app-overlay-spinner>
