<nb-card [nbSpinner]="spinner"
         accent="primary" class="m-0"
         nbSpinnerSize="giant"
         nbSpinnerStatus="primary">
  <nb-card-header class="text-center">
    <a  class="close cursor" data-dismiss="modal" aria-label="Close" (click)="onClose()">
      <span aria-hidden="true">Ã—</span></a>
    <h6>Company Detail</h6>
    <div class="d-flex justify-content-end">
      <nb-radio-group [(ngModel)]="calendarType" class="d-inline-flex"
                      name="companyInfoCalendarType">
        <nb-radio value="AD">AD</nb-radio>
        <nb-radio value="BS">BS</nb-radio>
      </nb-radio-group>
    </div>
  </nb-card-header>
  <nb-card-body>
    <form [formGroup]="companyInfoFormGroup">
      <nb-tabset>
        <nb-tab tabTitle="Legal Status">
          <div class="form-group">
            <div class="row">
              <div class="col-md-8">
                <div class="form-group">
                  <label for="corporateStructure"><strong>Corporate Structure</strong></label>
                  <select id="corporateStructure" formControlName="corporateStructure"
                          name="corporateStructure"
                          class="form-control custom-select"
                          [ngClass]="{ 'is-invalid': (submitted) && form.corporateStructure.errors }">
                    <option [value]="null" hidden>--Select Corporate Structure--</option>
                    <option [ngValue]="companyStructure.id" *ngFor="let companyStructure of companyStructureList">{{companyStructure.name}}</option>
                  </select>
                  <div *ngIf="(submitted) && form.corporateStructure.invalid"
                       class="invalid-feedback">
                    <div *ngIf="form.corporateStructure.errors.required">Corporate Structure is
                      required
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- START ROW -->
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label for="registeredOffice"><strong>Registered Office</strong></label>
                  <select [ngClass]="{ 'is-invalid': (submitted) && form.registeredOffice.errors }" class="form-control"
                         formControlName="registeredOffice"
                         id="registeredOffice" name="registeredOffice" placeholder="Registered Office">
                    <option [ngValue]="null" hidden>Select Registered Office</option>
                    <option *ngFor="let registeredOffice of registeredOffice" [ngValue]="registeredOffice.key">{{registeredOffice.value}}</option>
                  </select>
                  <div *ngIf="(submitted) && form.registeredOffice.invalid"
                       class="invalid-feedback">
                    <div *ngIf="form.registeredOffice.errors.required">
                      Registered Office is required
                    </div>
                  </div>
                  <div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label for="registeredUnderAct"><strong>Registered Under Act</strong></label>
                  <input  class="form-control"
                         formControlName="registeredUnderAct"
                         id="registeredUnderAct" name="registeredUnderAct" placeholder="Registered Under Act"
                         type="text">
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label for="registrationDate"><strong>Registration Date</strong></label>
                  <input *ngIf="calendarType === 'AD'" [nbDatepicker]="registrationDate"
                         [ngClass]="{ 'is-invalid':submitted && form.registrationDate.errors}"
                         class="form-control" formControlName="registrationDate"
                         id="registrationDate" name="registrationDate"
                         placeholder="Registration Date">
                  <app-calendar (messageToEmit)="companyInfoFormGroup.get('registrationDate').patchValue($event?.eDate)"
                                *ngIf="calendarType === 'BS'"
                                [ePreDate]="companyInfoFormGroup.get('registrationDate').value"></app-calendar>
                  <nb-datepicker #registrationDate></nb-datepicker>
                  <div *ngIf="submitted && form.registrationDate.errors" class="invalid-feedback">
                    <div
                        *ngIf="form.registrationDate.errors.required || form.registrationDate.errors.beforeToday">
                      Invalid Registration Date
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label for="panRegistrationOffice"><strong>PAN/VAT Registration
                    Office</strong></label>
                  <input [ngClass]="{ 'is-invalid': (submitted) && form.panRegistrationOffice.errors }" class="form-control"
                         formControlName="panRegistrationOffice" id="panRegistrationOffice" name="panRegistrationOffice"
                         placeholder="PAN/VAT Registration Office"
                         type="text">
                  <div *ngIf="(submitted) && form.panRegistrationOffice.invalid"
                       class="invalid-feedback">
                    <div *ngIf="form.panRegistrationOffice.errors.required">
                      PAN/VAT Registration Office is required
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label for="panRegistrationDate"><strong>PAN/VAT Registration
                    Date</strong></label>
                  <input *ngIf="calendarType === 'AD'" [nbDatepicker]="panRegistrationDate"
                         [ngClass]="{ 'is-invalid':submitted && form.panRegistrationDate.errors}"
                         class="form-control" formControlName="panRegistrationDate"
                         id="panRegistrationDate" name="panRegistrationDate"
                         placeholder="PAN/VAT Registration Date">
                  <app-calendar (messageToEmit)="companyInfoFormGroup.get('panRegistrationDate').patchValue($event?.eDate)"
                                *ngIf="calendarType === 'BS'"
                                [ePreDate]="companyInfoFormGroup.get('panRegistrationDate').value"></app-calendar>
                  <nb-datepicker #panRegistrationDate></nb-datepicker>
                  <div *ngIf="submitted && form.panRegistrationDate.errors"
                       class="invalid-feedback">
                    <div *ngIf="form.panRegistrationDate.errors.required ||
                                form.panRegistrationDate.errors.beforeToday">
                      Invalid PAN/VAT Registration Date
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label for="registrationExpiryDate"><strong> Registration Expiry Date</strong></label>
                  <input *ngIf="calendarType === 'AD'" [nbDatepicker]="registrationExpiryDate"
                         [ngClass]="{ 'is-invalid':submitted && form.registrationExpiryDate.errors}"
                         class="form-control" formControlName="registrationExpiryDate"
                         id="registrationExpiryDate" name="registrationExpiryDate"
                         placeholder="Registration Expiry Date">
                  <app-calendar
                      (messageToEmit)="companyInfoFormGroup.get('registrationExpiryDate').patchValue($event?.eDate)"
                      *ngIf="calendarType === 'BS'"
                      [ePreDate]="companyInfoFormGroup.get('registrationExpiryDate').value"></app-calendar>
                  <nb-datepicker #registrationExpiryDate></nb-datepicker>
                  <div *ngIf="submitted && form.registrationExpiryDate.errors"
                       class="invalid-feedback">
                    <div *ngIf="form.registrationExpiryDate.errors.required">
                      Registration Expiry Date is Required
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </nb-tab>
        <nb-tab tabTitle="Capital Information">
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label for="authorizedCapital"><strong>Authorized Capital</strong></label>
                <input [ngClass]="{ 'is-invalid': (submitted) && form.authorizedCapital.errors }" class="form-control"
                       formControlName="authorizedCapital"
                       id="authorizedCapital" name="authorizedCapital" placeholder="Authorized Capital"
                       type="number">
                <div *ngIf="(submitted) && form.authorizedCapital.invalid"
                     class="invalid-feedback">
                  <div *ngIf="form.authorizedCapital.errors.required">
                    Authorized Capital is required
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="issuedCapital"><strong>Issued Capital</strong></label>
                <input [ngClass]="{ 'is-invalid': (submitted) && form.issuedCapital.errors }" class="form-control" formControlName="issuedCapital"
                       id="issuedCapital"
                       name="issuedCapital" placeholder="Issued Capital"
                       type="number">
                <div *ngIf="(submitted) && form.issuedCapital.invalid"
                     class="invalid-feedback">
                  <div *ngIf="form.issuedCapital.errors.required">
                    Issued Capital is required
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="paidUpCapital"><strong>Paid Up Capital</strong></label>
                <input [ngClass]="{ 'is-invalid': (submitted) && form.paidUpCapital.errors }" class="form-control" formControlName="paidUpCapital"
                       id="paidUpCapital"
                       name="paidUpCapital" placeholder="Paid Up Capital"
                       type="number">
                <div *ngIf="(submitted) && form.paidUpCapital.invalid"
                     class="invalid-feedback">
                  <div *ngIf="form.paidUpCapital.errors.required">
                    Paid Up Capital Number is required
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="numberOfShareholder"><strong>Number Of Shareholder</strong></label>
                <input [ngClass]="{ 'is-invalid': (submitted) && form.numberOfShareholder.errors }" class="form-control"
                       formControlName="numberOfShareholder"
                       id="numberOfShareholder" name="numberOfShareholder" placeholder="Number Of Shareholder"
                       type="number">
                <div *ngIf="(submitted) && form.numberOfShareholder.invalid"
                     class="invalid-feedback">
                  <div *ngIf="form.numberOfShareholder.errors.required">
                    Number Of Shareholder is required
                  </div>
                </div>
              </div>
            </div>
          </div>


<!--          <div class="row">-->
<!--            <div class="col-md-4">-->
<!--              <div class="form-group">-->
<!--                <label for="totalCapital"><strong>Total Capital</strong></label>-->
<!--                <input [ngClass]="{ 'is-invalid': (submitted) && form.totalCapital.errors }" class="form-control" formControlName="totalCapital"-->
<!--                       id="totalCapital"-->
<!--                       name="totalCapital" placeholder="Total Capital"-->
<!--                       type="number">-->
<!--                <div *ngIf="(submitted) && form.totalCapital.invalid"-->
<!--                     class="invalid-feedback">-->
<!--                  <div *ngIf="form.totalCapital.errors.required">-->
<!--                    Total Capital is required-->
<!--                  </div>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="col-md-4">-->
<!--              <div class="form-group">-->
<!--                <label for="fixedCapital"><strong>Fixed Capital</strong></label>-->
<!--                <input [ngClass]="{ 'is-invalid': (submitted) && form.fixedCapital.errors }" class="form-control" formControlName="fixedCapital"-->
<!--                       id="fixedCapital"-->
<!--                       name="fixedCapital" placeholder="Fixed Capital"-->
<!--                       type="number">-->
<!--                <div *ngIf="(submitted) && form.fixedCapital.invalid"-->
<!--                     class="invalid-feedback">-->
<!--                  <div *ngIf="form.fixedCapital.errors.required">-->
<!--                    Fixed Capital is required-->
<!--                  </div>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--            <div class="col-md-4">-->
<!--              <div class="form-group">-->
<!--                <label for="workingCapital"><strong>Working Capital</strong></label>-->
<!--                <input [ngClass]="{ 'is-invalid': (submitted) && form.workingCapital.errors }" class="form-control" formControlName="workingCapital"-->
<!--                       id="workingCapital"-->
<!--                       name="workingCapital" placeholder="Working Capital"-->
<!--                       type="number">-->
<!--                <div *ngIf="(submitted) && form.workingCapital.invalid"-->
<!--                     class="invalid-feedback">-->
<!--                  <div *ngIf="form.workingCapital.errors.required">-->
<!--                    Working Capital is required-->
<!--                  </div>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
          <!-- END ROW -->
          <!-- START ROW -->



        </nb-tab>
        <nb-tab tabTitle="Contact Person Details">
          <div formArrayName="contactPersons" class="border-bottom border-dark m-4" *ngFor="let contact of companyInfoFormGroup.get('contactPersons')['controls']; let c = index">
            <div class="row" [formGroupName]="c">
              <div class="col-md-12" *ngIf="companyInfoFormGroup.get('contactPersons').length>1">
                <input class="float-right btn btn-sm btn-danger btn-primary" type="button"
                       (click)="removeContactPersons(c)" value="Delete"/>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label><strong>Name</strong></label>
                  <input class="form-control" formControlName="contactName"
                         id="contactName" placeholder="Name" type="text"
                         [ngClass]="{ 'is-invalid': (submitted) && contact.get('contactName').errors }">
                  <div *ngIf="(submitted) &&  contact.get('contactName').invalid"
                       class="invalid-feedback">
                    <div *ngIf=" contact.get('contactName').errors.required">
                      Name is required
                    </div>
                  </div>

                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label><strong>Contact Number</strong></label>
                  <input class="form-control" formControlName="contactNumber"
                         id="contactNumber" placeholder="Contact Number"
                         type="text"
                         [ngClass]="{ 'is-invalid': (submitted) && contact.get('contactNumber').errors }">
                  <div *ngIf="(submitted) && contact.get('contactNumber').invalid"
                       class="invalid-feedback">
                    <div *ngIf="contact.get('contactNumber').errors.required">
                      Contact Number is required
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label><strong>Email</strong></label>
                  <input class="form-control" formControlName="contactEmail"
                         [ngClass]="{ 'is-invalid': (submitted) && contact.get('contactEmail').errors }"
                         id="contactEmail" placeholder="Email"
                         type="email">
                  <div *ngIf="(submitted) && contact.get('contactEmail').invalid"
                       class="invalid-feedback">
                    <div *ngIf="contact.get('contactEmail').errors.required">
                      Contact Email  is required
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label for="functionalPosition"><strong>Functional Position</strong></label>
                  <select id="functionalPosition" formControlName="functionalPosition" name="functionalPosition"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': (submitted) && contact.get('functionalPosition').errors }">
                    <option [ngValue]="null" hidden>Select Position</option>
                    <option *ngFor="let designations of designation" [ngValue]="designations.id">{{designations.name}}</option>
                  </select>

                  <div *ngIf="(submitted) && contact.get('functionalPosition').invalid"
                       class="invalid-feedback">
                    <div *ngIf="contact.get('functionalPosition').errors.required">
                      Functional Position is required
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <input class="btn btn-sm btn-flat btn-primary float-right" type="button" (click)="addContactPersons()"
                   value="Add More"/>
          </div>
        </nb-tab>
        <nb-tab tabTitle="Company Location Detail">
          <div class="row">
            <!--<div class="col-md-4">
              <div class="form-group">
                <label><strong>House Number</strong></label>
                <input class="form-control" formControlName="houseNumber"
                       id="houseNumber" placeholder="House Number" type="text">
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label><strong>Street Name</strong></label>
                <input [ngClass]="{ 'is-invalid': (submitted) && form.streetName.errors }" class="form-control"
                       formControlName="streetName" id="streetName" placeholder="Street Name"
                       type="text">
                <div *ngIf="(submitted) && form.streetName.invalid"
                     class="invalid-feedback">
                  <div *ngIf="form.streetName.errors.required">
                    Street Name is required
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label><strong>Address</strong></label>
                <input [ngClass]="{ 'is-invalid': (submitted) && form.address.errors }" class="form-control"
                       formControlName="address" id="address" placeholder="Address"
                       type="text">
                <div *ngIf="(submitted) && form.address.invalid"
                     class="invalid-feedback">
                  <div *ngIf="form.address.errors.required">
                    Address is required
                  </div>
                </div>
              </div>
            </div>-->
            <app-common-address #companyLocation [address]="companyAddress"></app-common-address>
          </div>
        </nb-tab>
      </nb-tabset>
    </form>
  </nb-card-body>
  <nb-card-footer>
    <button (click)="onSubmit()" class="cursor float-right" nbButton size="small" status="primary"
            type="submit"><i class="fa fa-save"></i>
    </button>
  </nb-card-footer>
</nb-card>
