<div class="container">
    <div class="col-md-12 row">
        <form class="col-md-12" [formGroup]="facilityUtilizatoinForm">
<!--            <table class="table table-condensed table-bordered table-responsive-md text-center table-sm sb-small">-->
<!--                    <tr class="sb-bg-dark text-white">-->
<!--                        <th>Facility</th>-->
<!--                        <th>Limit</th>-->
<!--                        <th>Average Utilization</th>-->
<!--                        <th>Utilization (%)</th>-->
<!--                        <th>Maximum</th>-->
<!--                        <th>Minimum</th>-->
<!--                        <th *ngIf="fromProfile">Action</th>-->
<!--                    </tr>-->
<!--                    <tbody>-->
<!--                    <ng-container formArrayName="data" *ngFor="let controls of facilityUtilizatoinForm?.get('data')['controls']; let i = index">-->
<!--                        <tr *ngIf="fromProfile; else view" formGroupName="{{i}}">-->
<!--                            <td><input type="text" class="text-center form-control" formControlName="facility"></td>-->
<!--                            <td><input type="text" class="text-center form-control" formControlName="limit" (change)="calculateTotalAverage('limit')" appDecimalNumber></td>-->
<!--                            <td><input type="text" class="text-center form-control" formControlName="averageUtilization" (change)="calculateTotalAverage('averageUtilization')" appDecimalNumber></td>-->
<!--                            <td><input type="text" class="text-center form-control" formControlName="utilization" (change)="calculateTotalAverage('utilization')"  appDecimalNumber></td>-->
<!--                            <td><input type="text" class="text-center form-control" formControlName="maximum" (change)="calculateTotalAverage('maximum')"  appDecimalNumber></td>-->
<!--                            <td><input type="text" class="text-center form-control" formControlName="minimum" (change)="calculateTotalAverage('minimum')"  appDecimalNumber></td>-->
<!--                            <td><button (click)="removeUtilization(i)" nbButton><i class="fa fa-trash"></i></button></td>-->
<!--                        </tr>-->
<!--                        <ng-template #view>-->
<!--                            <tr  formGroupName="{{i}}">-->
<!--                                <td><span>{{controls?.get('facility')?.value}}</span></td>-->
<!--                                <td><span>{{controls?.get('limit')?.value}}</span></td>-->
<!--                                <td><span>{{controls?.get('averageUtilization')?.value}}</span></td>-->
<!--                                <td><span>{{controls?.get('utilization')?.value}}</span></td>-->
<!--                                <td><span>{{controls?.get('maximum')?.value}}</span></td>-->
<!--                                <td><span>{{controls?.get('minimum')?.value}}</span></td>-->
<!--                            </tr>-->
<!--                        </ng-template>-->
<!--                    </ng-container>-->
<!--                    <tr>-->
<!--                        <td>Facility wise Average Utilization </td>-->
<!--                        <td *ngFor="let key  of totalKeys">{{totals[key]}}</td>-->
<!--                        <td *ngIf="fromProfile"></td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                        <td>Total Average Utilization </td>-->
<!--                        <td *ngFor="let key  of totalKeys">{{(totals[key] / facilityUtilizatoinForm?.get('data')?.value?.length)}}</td>-->
<!--                        <td *ngIf="fromProfile"></td>-->
<!--                    </tr>-->
<!--                    </tbody>-->
<!--                </table>-->
<!--            <button (click)="addUtilization()" class="float-right" nbButton *ngIf="fromProfile">Add <i clas="fa fa-plus"></i></button>-->
<!--            <hr>-->
<!--            <div [ngClass]="fromProfile ? 'row' : 'container'">-->
<!--                <div [ngClass]="fromProfile ? 'col-md-4' : 'row'">-->
<!--                    <label for ="lcIssued"><strong>List of LC’s issued/ BG’s issued</strong></label><br>-->
<!--                    <input *ngIf="fromProfile" id = "lcIssued"type ="text" nbInput  formControlName="lcIssued">-->
<!--                        <p class="header" *ngIf="!fromProfile">{{facilityUtilizatoinForm?.get('lcIssued')?.value}}</p>-->
<!--                </div>-->
<!--                <div [ngClass]="fromProfile ? 'col-md-4' : 'row'">-->
<!--                    <label  for ="oneLimit"><strong>List of One off Limits</strong></label><br>-->
<!--                    <input *ngIf="fromProfile" type ="text" nbInput id="oneLimit" formControlName="oneLimit">-->
<!--                        <p class="header" *ngIf="!fromProfile">{{facilityUtilizatoinForm?.get('oneLimit')?.value}}</p>-->
<!--                </div>-->
<!--                <div [ngClass]="fromProfile ? 'col-md-4' : 'row'">-->
<!--                    <label for ="remarks"><strong>Remarks on Utilization</strong></label><br>-->
<!--                    <input *ngIf="fromProfile" type ="text" nbInput id="remarks" formControlName="remarks">-->
<!--                        <p class="header" *ngIf="!fromProfile">{{facilityUtilizatoinForm?.get('remarks')?.value}}</p>-->
<!--                </div>-->
<!--            </div>-->

<!--            <nb-card>-->
<!--                <nb-card-header>-->
<!--                    <div class="row d-flex justify-content-center">-->
<!--                        <h6>Account History</h6>-->
<!--                    </div>-->
<!--                        <nb-checkbox #chek formControlName="newCustomerChecked"-->
<!--                                     (checkedChange)="onAdditionalFieldSelect(chek.checked)" [checked]="formControls.newCustomerChecked.value">-->
<!--                            <strong>New Customer</strong>-->
<!--                        </nb-checkbox>-->
<!--                </nb-card-header>-->
<!--                <nb-card-body *ngIf="!chek?.checked">-->
<!--                    <div formGroupName="accountTransactionForm">-->
<!--                        <div class="col-md-12" >-->
<!--                            <table class="table table-bordered table-responsive-md table-hover text-center sb-small table-sm">-->
<!--                                <thead>-->
<!--                                <tr class="sb-bg-secondary text-white">-->
<!--                                    <th>Particular</th>-->
<!--                                    <th>Total Number</th>-->
<!--                                    <th>Total Value</th>-->
<!--                                </tr>-->
<!--                                </thead>-->
<!--                                <tbody>-->
<!--                                <tr>-->
<!--                                    <td>Credit Transaction in Account</td>-->
<!--                                    <ng-container *ngIf="fromProfile; else view">-->
<!--                                        <td>-->
<!--                                            <input class="text-center form-control"-->
<!--                                                   formControlName="creditTransactionNumber"-->
<!--                                                   [ngClass]="{ 'is-invalid': (submitted) && transactionForm?.creditTransactionNumber?.invalid }"-->
<!--                                                   appDecimalNumber>-->
<!--                                            <div *ngIf="(submitted) && transactionForm?.creditTransactionNumber?.invalid"-->
<!--                                                 class="invalid-feedback">-->
<!--                                                <span>Invalid Credit Transaction Number.</span>-->
<!--                                            </div>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <input class="text-center form-control"-->
<!--                                                   formControlName="creditTransactionValue"-->
<!--                                                   [ngClass]="{ 'is-invalid': (submitted) && transactionForm?.creditTransactionValue?.invalid}" appDecimalNumber>-->
<!--                                            <div *ngIf="(submitted) && transactionForm?.creditTransactionValue?.invalid"-->
<!--                                                 class="invalid-feedback">-->
<!--                                                <span>Invalid Credit Transaction Value.</span>-->
<!--                                            </div>-->
<!--                                        </td>-->
<!--                                    </ng-container>-->
<!--                                    <ng-template #view>-->
<!--                                        <td><span>{{transactionForm?.creditTransactionNumber?.value}}</span></td>-->
<!--                                        <td><span>{{transactionForm?.creditTransactionValue?.value}}</span></td>-->
<!--                                    </ng-template>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                    <td>Debit Transaction in Account</td>-->
<!--                                    <ng-container *ngIf="fromProfile; else view2">-->
<!--                                        <td>-->
<!--                                            <input class="text-center form-control"-->
<!--                                                   formControlName="debitTransactionNumber"-->
<!--                                                   [ngClass]="{ 'is-invalid': (submitted) && transactionForm?.debitTransactionNumber?.invalid }" appDecimalNumber>-->
<!--                                            <div *ngIf="(submitted) && transactionForm?.debitTransactionNumber?.invalid"-->
<!--                                                 class="invalid-feedback">-->
<!--                                                <span>Invalid Debit Transaction Number.</span>-->
<!--                                            </div>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <input class="text-center form-control"-->
<!--                                                   formControlName="debitTransactionValue"-->
<!--                                                   [ngClass]="{ 'is-invalid': (submitted) && transactionForm?.debitTransactionValue?.invalid }" appDecimalNumber>-->
<!--                                            <div *ngIf="(submitted) && transactionForm?.debitTransactionValue?.invalid"-->
<!--                                                 class="invalid-feedback">-->
<!--                                                <span>Invalid Debit Transaction Value.</span>-->
<!--                                            </div>-->
<!--                                        </td>-->
<!--                                    </ng-container>-->
<!--                                    <ng-template #view2>-->
<!--                                        <td><span>{{transactionForm?.debitTransactionNumber?.value}}</span></td>-->
<!--                                        <td><span>{{transactionForm?.debitTransactionValue?.value}}</span></td>-->
<!--                                    </ng-template>-->
<!--                                </tr>-->
<!--                                </tbody>-->
<!--                            </table>-->
<!--                        </div>-->
<!--                        <div class="col">-->
<!--                            <ng-container *ngIf="fromProfile; else view3">-->
<!--                                <label for="repaymentTrackWithCurrentBank">-->
<!--                                    <strong>Repayment track in our bank</strong></label><strong-->
<!--                                    class="text-danger">*</strong>-->
<!--                                <select id="repaymentTrackWithCurrentBank" class="form-control text-center"-->
<!--                                        formControlName="repaymentTrackWithCurrentBank"-->
<!--                                        [ngClass]="{'is-invalid': submitted && transactionForm?.repaymentTrackWithCurrentBank.invalid}">-->
<!--                                    <option [ngValue]="null" hidden selected>&#45;&#45;Select Repayment Track&#45;&#45;</option>-->
<!--                                    <option *ngFor="let m of repaymentTrack"-->
<!--                                            [value]="m?.value">{{m?.value}}</option>-->
<!--                                </select>-->
<!--                                <div *ngIf="(submitted) && transactionForm?.repaymentTrackWithCurrentBank.invalid"-->
<!--                                     class="invalid-feedback">-->
<!--                                    Repayment Track is Required-->
<!--                                </div>-->
<!--                            </ng-container>-->
<!--                            <ng-template #view3>-->
<!--                                <label for="repaymentTrackWithCurrentBank">-->
<!--                                    <strong>Repayment track in our bank: </strong></label>-->
<!--                                <span>{{'  ' + transactionForm?.repaymentTrackWithCurrentBank?.value}}</span>-->
<!--                            </ng-template>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </nb-card-body>-->
<!--            </nb-card>-->
            <div *ngIf="fromProfile">
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="overdraftUtilization"><b>Overdraft utilization</b></label>
                    <ckeditor id="overdraftUtilization" formControlName="overdraftUtilization"
                              [config]="facilityConfig"></ckeditor>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="remarks"><b>Remarks</b></label>
                    <ckeditor id="remarks" formControlName="remarks"
                              [config]="facilityConfig"></ckeditor>
                 </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="otherFacilityUtilization"><b>Other Facility Utilization</b></label>
                    <ckeditor id="otherFacilityUtilization" formControlName="otherFacilityUtilization"
                              [config]="facilityConfig"></ckeditor>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="remarks1"><b>Remarks</b></label>
                    <ckeditor id="remarks1" formControlName="remarks1"
                              [config]="facilityConfig"></ckeditor>
                 </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="letterOfCreditIssued"><b>Letter of Credit issued</b></label>
                    <ckeditor id="letterOfCreditIssued" formControlName="letterOfCreditIssued"
                              [config]="facilityConfig"></ckeditor>
               </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="remarks2"><b>Remarks</b></label>
                    <ckeditor id="remarks2" formControlName="remarks2"
                              [config]="facilityConfig"></ckeditor>
               </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="bankGuaranteeIssued"><b>Bank Guarantee issued</b></label>
                    <ckeditor id="bankGuaranteeIssued" formControlName="bankGuaranteeIssued"
                              [config]="facilityConfig"></ckeditor>
               </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="remarks3"><b>Remarks</b></label>
                    <ckeditor id="remarks3" formControlName="remarks3"
                              [config]="facilityConfig"></ckeditor>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="oneOffLoansApproved"><b>One off loans approved</b></label>
                    <ckeditor id="oneOffLoansApproved" formControlName="oneOffLoansApproved"
                              [config]="facilityConfig"></ckeditor>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="remarks4"><b>Remarks</b></label><br/>
                    <ckeditor id="remarks4" formControlName="remarks4"
                              [config]="facilityConfig"></ckeditor>
                </div>
            </div>
            </div>
            <div *ngIf="!fromProfile">
                <p class="header"><strong class="header">Facility Utilization</strong></p>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Overdraft utilization</strong>
                        <span [innerHTML]="parsedData?.overdraftUtilization ? parsedData?.overdraftUtilization : 'N/A' | safeHtml">{{parsedData}}</span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Remarks</strong><br/>
                        <span [innerHTML]="parsedData?.remarks ? parsedData?.remarks : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Other Facility Utilization</strong>
                        <span [innerHTML]="parsedData?.otherFacilityUtilization ? parsedData?.otherFacilityUtilization : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Remarks</strong><br/>
                        <span [innerHTML]="parsedData?.remarks1 ? parsedData?.remarks1 : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Letter of Credit issued</strong>
                        <span [innerHTML]="parsedData?.letterOfCreditIssued ? parsedData?.letterOfCreditIssued : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Remarks</strong><br/>
                        <span [innerHTML]="parsedData?.remarks2 ? parsedData?.remarks2 : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Bank Guarantee issued</strong>
                        <span [innerHTML]="parsedData?.bankGuaranteeIssued ? parsedData?.bankGuaranteeIssued : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Remarks</strong><br/>
                        <span [innerHTML]="parsedData?.remarks3 ? parsedData?.remarks3 : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>One off loans approved</strong>
                        <span [innerHTML]="parsedData?.oneOffLoansApproved ? parsedData?.oneOffLoansApproved : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p class="text-left"><strong>Remarks</strong><br/>
                        <span [innerHTML]="parsedData?.remarks4 ? parsedData?.remarks4 : 'N/A' | safeHtml"></span>
                        </p>
                    </div>
                </div>
            </div>
            <button (click)="saveFacilityUtilization()" *ngIf="fromProfile" class="float-right"  nbButton>Save</button>
        </form>
    </div>
</div>
