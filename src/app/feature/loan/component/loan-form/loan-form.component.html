<nb-card [nbSpinner]="nbSpinner">

  <nb-card-header>

    <button nbButton
            shape="rectangle"
            status="primary"
            size="tiny" (click)="goToCustomer()"><em class="fas fa-backward"></em> <span
        class="px-2">customer Profile</span>
    </button>
    <p class="py-2"><b>Loan Type:</b>&nbsp;<span
        class="badge badge-success">{{loanTypeKeyValue[loanType]}}</span></p>


    <h3 class="d-flex justify-content-center">{{loanTitle}}
    </h3>
    <h4 class="d-flex justify-content-center">of</h4>
    <h4 class="d-flex justify-content-center">{{loanDocument?.loanHolder?.name}}</h4>
    <hr>

    <div #container class="row">

      <div class="col-md-3">
        <form #priorityFormNav id="priorityFormNav" [formGroup]="priorityForm">
          <label><strong>Priority</strong></label>
          <ng-select [items]="dropdownPriorities"
                     [multiple]="false"
                     bindLabel="name"
                     bindValue="id"
                     formControlName="priority"
          >
          </ng-select>
          <div *ngIf="priorityForm.get('priority').errors">
            <small class="text-danger">
              Priority is required!
            </small>
          </div>
        </form>
      </div>


      <div *ngIf="showDocStatusDropDown" class="col-md-3">
        <form [formGroup]="docStatusForm">
          <label><strong>
            <mark class="ql-color-yellow"> Phase - Loan Build Cycle</mark>
          </strong></label>
          <ng-select [items]="docStatusMakerList"
                     [multiple]="false"
                     bindLabel="name"
                     bindValue="name"
                     formControlName="documentStatus">
          </ng-select>
        </form>
      </div>
      <!--      <div class="col-md-3">-->
      <!--        <label for="masterCalendarType">Calendar Type</label>-->
      <!--        <div>-->
      <!--          <nb-radio-group [(ngModel)]="calendarType" class="d-inline-flex"-->
      <!--                          id="masterCalendarType" name="masterCalendarType">-->
      <!--            <nb-radio value="AD">AD</nb-radio>-->
      <!--            <nb-radio value="BS">BS</nb-radio>-->
      <!--          </nb-radio-group>-->
      <!--        </div>-->
      <!--      </div>-->
      <!--      todo uncomment this if nepali form is required-->
      <!--      <div *ngIf="productUtils.NEP_TEMPLATE" class="col-md-3">-->
      <!--        <div class=" d-flex justify-content-end py-4">-->
      <!--          <button (click)="nepaliFormTemplate()" class="btn btn-flat btn-outline-primary">-->
      <!--            नेपाली फारम-->
      <!--          </button>-->
      <!--        </div>-->
      <!--      </div>-->

    </div>


    <span class="d-flex justify-content-end cus-fixed" id="nep-date" >{{currentNepDate}}</span>
  </nb-card-header>
  <nb-card-body>
    <section *ngIf="loanDocument && templateList" class="cus-fixed">
      <ngb-tabset #tabSet="ngbTabset" (tabChange)="tabChange($event, tabSet)">
        <ngb-tab *ngFor="let allList of templateList; let i = index" [title]="allList.name"
                 [id]="i.toString(10)" [disabled]="isBlackListed">
          <ng-template ngbTabContent *ngIf="allList.name === 'Proposal' && loanTag">
            <app-proposal *ngIf="loanTag !== 'MICRO_LOAN'" [formValue]="loadProposal()"
                          [loanType]="loanType" #proposalInfo></app-proposal>
          </ng-template>
          <ng-template ngbTabContent *ngIf="allList.name === 'Loan Document'">
            <app-customer-loan-document #customerDocument
                                        [loanDataHolder]="loanDocument"
                                        [loanType]="loanType"></app-customer-loan-document>
          </ng-template>
        </ngb-tab>
      </ngb-tabset>

      <div class="justify-content-center" style="padding-bottom: 20px">
        <div class="col-md-12">
          <div class="row text-center">
            <div class="col-md-6 d-flex justify-content-start">
              <button nbButton status="primary"
                      *ngIf="nextTabId > 1"
                      (click)="tabSet.select(previousTabId.toString(10));scrollToTop()">Previous
              </button>
            </div>
            <div class="col-md-6 d-flex justify-content-end">

              <button nbButton
                      shape="rectangle"
                       status="info" (click)="goToCustomer()" class=" mr-2">
                Close
              </button>

              <button nbButton status="primary"
                      shape="rectangle"
                      (click)="nextButtonActionFxn(tabSet);scrollToTop()"
                      *ngIf="nextTabId !== totalTabCount">Next
              </button>

              <button nbButton status="info"
                      shape="rectangle"
                      (click)="save()" *ngIf="nextTabId === totalTabCount"
                      [disabled]="isBlackListed">
                Save
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </nb-card-body>
</nb-card>
<app-overlay-spinner></app-overlay-spinner>

