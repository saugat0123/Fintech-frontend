<nb-card>
    <nb-card-body>
        <div class="container" id="security">
            <div class="wizard-title text-center"><h1>Security</h1></div>
            <div class="form-group">
                <app-security-initial-form #initialSecurity [formData]="initialSecurityValue"
                                           [name]="valuatorName"></app-security-initial-form>

                <!-- Guarantors -->

                <div class="box-header with-border">
                    <h2 class="box-title title">Guarantors Details</h2>
                </div>
                <div class="form-group">
                    <form [formGroup]="guarantorsForm">
                        <!--START ROW-->
                        <div *ngFor="let guarantorsDetails of guarantorsForm.get('guarantorsDetails')['controls']; let i = index"
                             class="font-weight-bold" formArrayName="guarantorsDetails">
                            <div [formGroupName]="i">
                                <div class="row">
                                    <div class="col-md-10 form-group">
                                        <h5>{{i + 1}}) guarantor Information</h5>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="name">Name</label>
                                            <input class="form-control rounded" formControlName="name" id="name"
                                                   name="name" placeholder="name of guarantor"
                                                   type="text"/>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label><strong>Province</strong></label>
                                            <select (change)="getDistrict(guarantorsDetails.get('province').value,i)"
                                                    [ngClass]="{ 'is-invalid': (submitted) && guarantorsDetails.get('province').errors}"
                                                    class="custom-select"
                                                    formControlName="province"
                                                    name="province">
                                                <option [value]="null" hidden>Select Province</option>
                                                <option *ngFor="let provinceVal of provinceList"
                                                        [ngValue]="provinceVal.id">
                                                    {{provinceVal.name}}
                                            </select>

                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label><strong>District</strong></label>
                                            <select (change)="getMunicipalities(guarantorsDetails.get('district').value, i)"
                                                    [ngClass]="{ 'is-invalid': (submitted) && guarantorsDetails.get('district').errors}"
                                                    class="custom-select"
                                                    formControlName="district"
                                                    name="district">
                                                <option [value]="null" hidden>Select District</option>
                                                <option *ngFor="let districtVal of addressList[i].districtList"
                                                        [ngValue]="districtVal.id">
                                                    {{districtVal.name}}</option>
                                            </select>

                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label><strong>Municipalities/VDC</strong></label>
                                            <select [ngClass]="{ 'is-invalid': (submitted) && guarantorsDetails.get('municipalities').errors}"
                                                    class="custom-select"
                                                    formControlName="municipalities"
                                                    name="municipalities">
                                                <option [value]="null" hidden>Select Municipalities/VDC</option>
                                                <option *ngFor="let municipalitiesVal of addressList[i].municipalityVdcList"
                                                        [ngValue]="municipalitiesVal.id">
                                                    {{municipalitiesVal.name}}
                                            </select>

                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="citizenNumber">Citizen Number</label>
                                            <input class="form-control rounded" formControlName="citizenNumber"
                                                   id="citizenNumber"
                                                   name="citizenNumber" placeholder="number" type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="citizenIssuedYear">Cititzen Issued Year</label>
                                            <input [nbDatepicker]="issuedYear" class="form-control"
                                                   formControlName="issuedYear"
                                                   id="citizenIssuedYear" name="citizenIssuedYear"
                                                   nbInput placeholder="Citizenship Issued Date">
                                            <nb-datepicker #issuedYear></nb-datepicker>
                                        </div>
                                    </div>
                                </div>
                                <!--END ROW-->
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="citizenIssuedPlace">Citizen Issued Place</label>
                                            <input class="form-control rounded" formControlName="issuedPlace"
                                                   id="citizenIssuedPlace"
                                                   name="citizenIssuedPlace" placeholder="Citizenship Issued Place"
                                                   type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="contactNumber">Contact</label>
                                            <input class="form-control rounded" formControlName="contactNumber"
                                                   id="contactNumber"
                                                   name="contactNumber" placeholder="contact number" type="text">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="fatherName">Guarantor's Father Name</label>
                                            <input class="form-control rounded" formControlName="fatherName"
                                                   id="fatherName"
                                                   name="fatherName" placeholder="Father's name" type="text"/>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="grandFatherName">Guarantor's GrandFather
                                                Name</label>
                                            <input class="form-control" formControlName="grandFatherName"
                                                   id="grandFatherName" name="grandFatherName"
                                                   placeholder="GrandFather's name"
                                                   type="text">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="title" for="relationship">Relationship</label>
                                            <input class="form-control rounded" formControlName="relationship"
                                                   id="relationship"
                                                   name="name" placeholder="relationship" type="text"/>
                                        </div>
                                    </div>
                                    <div *ngIf="guarantorsForm.get('guarantorsDetails')['length']>1"
                                         class="col-md-1 pt-4">
                                        <button (click)="removeGuarantorsDetails(i)"
                                                class="align-self-end btn btn-sm btn-danger btn-primary">
                                            Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        </div>
                        <div class="text-right">
                            <button (click)="addGuarantorsDetails()" class="btn btn-sm btn-flat btn-primary">
                                Add Customer Relative
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </nb-card-body>
</nb-card>


