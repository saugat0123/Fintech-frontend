<div class="row summary">
    <div class="col-md-12" *ngIf="!showOnlyProfile">
      <p><strong class="header">Business Information</strong></p>
      <p  class="sub-header"><strong class="sub-header">Business Profile</strong></p>
      <table
          class="table table-condensed table-bordered table-responsive-md table-sm  company-detail summary">
        <tr>
          <td><b>Nature Of business</b></td>
          <td>{{companyJsonData?.majorProductService}}</td>
          <td><b>Relationship Start (with group)</b>: {{companyJsonData?.relationshipSince}}</td>
        </tr>
        <tr>
          <td><b>Sister Concerns</b></td>
          <td>{{companyJsonData?.sisterConcern || 'N/A'}}</td>
          <td><b>Relationship Since (with customer) (AD/BS)</b>: {{companyJsonData?.relationshipSinceWithCustomer | date}}
            ({{companyJsonData?.relationshipSinceWithCustomer |engNepDate: false}})</td>
        </tr>
        <tr>
          <td rowspan="6"><b>RegistrationDetail</b></td>
          <td><b>Dept/office</b></td>
          <td>{{((companyInfo?.legalStatus?.registeredOffice | replace: '_': ' ') | titlecase)}}</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td><b>Date(AD/BS)</b></td>
          <td>{{companyInfo?.legalStatus?.registrationDate | date}} ({{companyInfo?.legalStatus?.registrationDate |engNepDate: false}})</td>
        </tr>
        <tr>
          <td><b>Regd. Number</b></td>
          <td>{{companyInfo?.registrationNumber}}</td>
        </tr>
        <tr>
          <td><b>Regd. District</b></td>
          <td>{{companyInfo?.legalStatus?.registrationDistrict}}</td>
        </tr>
        <tr>
          <td><b>Registered at Udhyog Bibhag?</b></td>
          <td>{{companyInfo?.legalStatus?.udhyogBibhag}}</td>
        </tr>
        <tr *ngIf="client === clientName?.SHINE_RESUNGA">
          <td><b>Address as per legal Document</b></td>
          <td>{{companyJsonData?.addressLegalDocument}}</td>
        </tr>
        <tr>
          <td><b>PAN Number</b></td>
          <td>
            <div class="row">
              <div class="col-md-4">
                {{companyInfo?.panNumber}}
                <span class="float-right">
              |
            </span>
              </div>
              <div class="col-md-4">
                <b>Date(AD/BS)</b>: {{companyInfo?.legalStatus?.panRegistrationDate | date}} ({{companyInfo?.legalStatus?.panRegistrationDate |engNepDate: false}})
                <span class="float-right">
            </span>
              </div>
             <div class="col-md-4">
             </div>
            </div>
          </td>
          <td>
            <b>Registered Office</b>: {{companyInfo?.legalStatus.panRegistrationOffice}}
          </td>
        </tr>
        <tr>

          <td><b>VAT Number</b></td>
          <td>
            <div class="row">
              <div class="col-md-4">
                {{companyInfo?.vatNo}}
                <span class="float-right">
              |
            </span>
              </div>
              <div class="col-md-4">
                <b>Date(AD/BS)</b>: {{companyInfo?.legalStatus?.vatRegistrationDate | date}} ({{companyInfo?.legalStatus?.vatRegistrationDate |engNepDate: false}})
                <span class="float-right">
              |
            </span>
              </div>
            </div>
          </td>
          <td>
              <b>Registered Office</b>: {{companyInfo?.legalStatus.vatRegistrationOffice}}
          </td>
        </tr>
       <!-- <tr>
          <td>
            <b>Tax Clearance Till</b>
          </td>
          <td>{{companyJsonData?.otherCompanyDetail?.taxClearanceTill || 'N/A'}}</td>
          <td><b>Remarks</b> , {{companyJsonData?.otherCompanyDetail.taxClearanceRemark !== undefined ? companyJsonData?.otherCompanyDetail?.taxClearanceRemark
            :'N/A'}}</td>
        </tr>-->

        <tr>
          <td *ngIf="companyInfo?.establishmentDate">
            <b>Business Operation Since(if Other than registration date)(AD/BS)</b>
          </td>
          <td colspan="2">
            {{companyInfo?.establishmentDate | date}} {{companyInfo?.establishmentDate |engNepDate: false}}
          </td>
        </tr>
        <tr>
          <td><b>Issue Place</b></td>
          <td colspan="2">{{companyInfo?.issuePlace}}</td>
        </tr>
        <tr>
          <td><b>Registered Address</b></td>
          <td  colspan="2">
             {{companyLocationData?.address1}}</td>
        </tr>
        <tr>
          <td><b>Project Address</b></td>
          <td  colspan="2">
            {{projectAddress?.address1}}</td>
        </tr>
        <tr>
          <td><b>Correspondence Address</b></td>
          <td  colspan="2">
            {{correspondenceAddress?.address1}} </td>
        </tr>
        <tr>
          <td>
            <div><b> Key Contact Person/Position</b></div>
            <div><b>Name</b></div>
            <div><b>Contact Number</b></div>
            <div><b>E-mail address:</b></div>
            <div><b>Functional Position</b></div>
          </td>
          <td>
            <ng-container *ngIf="contact != undefined || contact != null">
              <div><b>Details</b></div>
              <div>{{contact[0]?.contactName}}</div>
              <div>{{contact[0]?.contactNumber}}</div>
              <div *ngIf="contact[0]?.contactEmail; else noemail">{{contact[0]?.contactEmail}}</div>
              <ng-template #noemail>NA</ng-template>
              <div>{{contact[0]?.functionalPosition}}</div>
            </ng-container>
          </td>
          <td>
           <div> <b>Alternative Contact Person</b></div>
            <ng-container *ngIf="contact?.length > 1">
              <div>{{contact[1]?.contactName}}</div>
              <div>{{contact[1]?.contactNumber}}</div>
              <div>{{contact[1]?.email}}</div>
              <div>{{contact[1]?.functionalPosition}}</div>
            </ng-container>
            <span *ngIf="contact?.length == 1">N/A</span>
          </td>
        </tr>

      <!--
       add in future
        <tr>
          <td>Existing Review Date</td>
          <td>asd</td>
          <td>asdas</td>
        </tr>-->
       <!-- <tr>
          <td><b>Classification as per NRB Directive</b></td>
          <td colspan="2">{{companyJsonData?.otherCompanyDetail?.ClassificationByNRB || 'N/A'}}</td>
        </tr>

        <tr *ngIf="client !== clientName?.SHINE_RESUNGA">
          <td><b>Customer Negative List Checked</b></td>
          <td colspan="2"><span>(<i *ngIf="companyJsonData?.otherCompanyDetail?.negativeList === 'checked'" class="fas fa-check-circle"></i> )Checked</span>
            <span class="ml-2">(<i *ngIf="companyJsonData?.otherCompanyDetail?.negativeList === 'unchecked'" class="fas fa-check-circle"></i> )Not checked</span>
            <span class="ml-5">Remarks , {{companyJsonData?.otherCompanyDetail?.negativeListRemark != undefined ? companyJsonData?.otherCompanyDetail?.negativeListRemark : 'N/A'}}</span></td>
        </tr>-->

        <tr>
          <td><b>Authorized / Issue / Paid Up Capital</b></td>
          <td colspan="3">NPR. {{companyInfo?.capital?.authorizedCapital |currencyFormatter}}
            / NPR. {{companyInfo?.capital?.issuedCapital | currencyFormatter}}
            / NPR. {{companyInfo?.capital?.paidUpCapital | currencyFormatter}} </td>
        </tr>

        <ng-container *ngIf="client === clientName?.ICFC">
          <tr *ngIf="companyInfo?.capital?.fixedCapital > 0">
            <td><b>Fixed Capital</b></td>
            <td colspan="3">NPR. {{companyInfo?.capital?.fixedCapital |currencyFormatter}}</td>
          </tr>
          <tr *ngIf="companyInfo?.capital?.workingCapital > 0">
            <td><b>Working(Current) Capital</b></td>
            <td colspan="3">NPR. {{companyInfo?.capital?.workingCapital |currencyFormatter}}</td>
          </tr>
          <tr *ngIf="companyInfo?.capital?.totalCapital > 0">
            <td><b>Total  Capital</b></td>
            <td colspan="3">NPR. {{companyInfo?.capital?.totalCapital |currencyFormatter}}</td>
          </tr>
        </ng-container>

        <tr>
          <td><b>Business Segment</b></td>
          <td colspan="3">{{loanDataHolder?.loanHolder['clientType'] | clientType}}</td>

        </tr>
        <tr>
          <td><b>SubSector</b></td>
          <td colspan="3">{{loanDataHolder?.loanHolder['subsectorDetail'] || 'N/A'}}</td>
        </tr>
        <tr>
          <td><b>Customer ID</b></td>
          <td colspan="3">{{loanDataHolder?.loanHolder.customerCode}}</td>
        </tr>
        <tr>
          <td><b>Account Number</b></td>
          <td colspan="3">{{getAccountNumber(accountNumberList)}}</td>
        </tr>

<!--        <tr>-->
<!--          <td><b>IRD report obtained and attached</b></td>-->
<!--          <td colspan="3">{{companyJsonData?.irdReport || 'N/A'}}</td>-->
<!--        </tr>-->

<!--        Obligor Code for SRDB only-->
        <tr *ngIf="approveSheet === 'approveSheet' && client === clientName.SHINE_RESUNGA">
          <td><b>Obligor Code</b></td>
          <td colspan="3">{{loanDataHolder?.loanHolder?.obligor}}</td>
        </tr>

      </table>
    </div>
  <ng-container *ngIf="isCorporate">
    <div class="col-md-12">
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
        <tr >
          <td colspan="4" class="text-center font-weight-bold sb-bg-gray"> IRD Submission report</td>
        </tr>
        <tr>
          <td colspan="1"><b>Last obtained for FY</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.lastFYIRD}}</td>
        </tr>
        <tr>
          <td colspan="1"><b>Justification for deviation</b></td>
          <td colspan="3" [innerHTML]="(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.justifyIRD | safeHtml"></td>
        </tr>
      </table>
    </div>
  </ng-container>


  <ng-container *ngIf="isCorporate">
    <div class="col-md-12">
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
        <tr >
          <td colspan="4" class="text-center font-weight-bold sb-bg-gray"> Tax Clearance Report</td>
        </tr>
        <tr>
          <td colspan="1"><b>Last obtained for FY</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.lastFYTax}}</td>
        </tr>
        <tr>
          <td colspan="1"><b>Justification for deviation</b></td>
          <td colspan="3" [innerHTML]="(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.justifyTax | safeHtml"></td>
        </tr>
      </table>
    </div>
  </ng-container>


  <ng-container *ngIf="isCorporate">
    <div class="col-md-12">
      <table class="col-md-12  table-sm table-bordered table-responsive-sm">
        <tr >
          <td colspan="4" class="text-center font-weight-bold sb-bg-gray">Current Assets</td>
        </tr>
        <tr>
          <td><table class="col-md-12  table-sm table-bordered table-responsive-sm" style="width: 100%; border: white"  [innerHTML]="ntaData?.currentAssets ? ntaData?.currentAssets : 'N/A' | safeHtml" >
          </table></td>
        </tr>
      </table>

    </div>
    <div class="col-md-12">
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
        <tr >
          <td colspan="4" class="text-center font-weight-bold sb-bg-gray">External Credit Rating</td>
        </tr>
        <tr>
          <td colspan="1"><b>External Rating Agency Name</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.agencyName}}</td>
        </tr>
        <tr>
          <td colspan="1"><b>Rating Report Date</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.reportDate}}</td>
        </tr>
        <tr>
          <td colspan="1"><b>Long Term Rating</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.longTermRating}}</td>
        </tr>
        <tr>
          <td colspan="1"><b>Short Term Rating</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.shortTermRating}}</td>
        </tr>
      </table>
    </div>
    <div class="col-md-12">
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
        <tr >
          <td colspan="4" class="text-center font-weight-bold sb-bg-gray">MOA/AOA Declaration</td>
        </tr>
        <tr>
          <td colspan="1"><b>Present request is in line with companyâ€™s bylaws/MOA/AOA</b></td>
          <td colspan="3">{{(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.moaAoa}}</td>
        </tr>
      </table>
    </div>
    <div class="col-md-12" *ngIf="(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.meetingDetails?.length > 0">
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
        <tr >
          <td colspan="4" class="text-center font-weight-bold sb-bg-gray">Consortium Meeting Details</td>
        </tr>
      </table>
    </div>
    <div class="col-md-12" *ngIf="(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.meetingDetails?.length > 0">
      <table class="table table-sm sb-small table-bordered text-center">
        <thead>
        <tr class="sb-bg-gray">
          <th>Date</th>
          <th>Purpose</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let data of (loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.meetingDetails">
          <td>{{data?.meetingDate | date}}</td>
          <td>{{data?.meetingPurpose}}</td>
        </tr>
        </tbody>
      </table>
    </div>
    <div class="col-md-12">
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
        <tr *ngIf="checkedData?.waiverChecked" class="sb-bg-gray">
          <th>Waiver </th>
        </tr>
        <tr *ngIf="checkedData?.waiverChecked">
          <td class="text-left pl-1"><span [innerHTML]="(loanDataHolder?.proposal?.data | jsonParse)?.waiverConclusionRecommendation || 'N/A' | safeHtml"></span></td>
        </tr>

        <tr *ngIf="checkedData?.deviationChecked" class="sb-bg-gray">
          <th>Deviation </th>
        </tr>
        <tr *ngIf="checkedData?.deviationChecked">
          <td class="text-left pl-1"><span [innerHTML]="(loanDataHolder?.proposal?.data | jsonParse)?.deviationConclusionRecommendation || 'N/A' | safeHtml"></span></td>
        </tr>
      </table>
    </div>
    <hr class="print-line" >
    <div class="col-md-12" >
      <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary" *ngIf="checkedData?.debtChecked">
        <tr  class="sb-bg-gray">
          <th>Debt Structure and Control </th>
        </tr>
        <tr >
          <td class="text-left pl-1"><span [innerHTML]="(loanDataHolder?.proposal?.data | jsonParse)?.termsAndCondition || 'N/A' | safeHtml"></span></td>
        </tr>
      </table>
      <app-summary-of-environemnt [customerInfo]="loanDataHolder?.loanHolder"></app-summary-of-environemnt>
    </div>
  </ng-container>


  <div class="col-md-12" *ngIf="newGuarantor?.length > 0 && !isCorporate">
    <div class="text-center">
      <p class="float-left sub-header" ><strong  class="sub-header">{{'Shareholder Details'}}</strong></p>
      <ng-container>
              <table
                      class="table table1 table-condensed table-bordered table-sm table-responsive-md text-center table-sm sb-small summary">

                <tbody>
                <tr>
                  <td class="text-left sb-bg-gray pl-2">S.N</td>
                  <td class="text-left sb-bg-gray pl-2">Name</td>
                  <td class="sb-bg-gray text-left pl-2">Designation</td>
                  <td class="text-left sb-bg-gray pl-2">Share holding (%)</td>
                </tr>
                <tr *ngFor="let g of newGuarantor; let i = index;">
                  <td class="text-left pl-2">{{i+1}}</td>
                  <td class="text-left pl-2">{{g?.name || 'N/A'}}</td>
                  <td class="text-left pl-2">{{g?.guarantorType || 'N/A'}}</td>
                  <td class="text-left pl-2">{{(g?.guarantorJson | jsonParse)?.sharePercent || 'N/A'}}</td>
                </tr>
                </tbody>
              </table>
      </ng-container>
    </div>
  </div>

  <div class="col-md-12">
    <div class="text-center">
      <p class="float-left sub-header" ><strong  class="sub-header">{{'Insurance Details'}}</strong></p>
      <ng-container>
        <table
                class="table table1 table-condensed table-bordered table-sm table-responsive-md text-center table-sm sb-small summary">

          <tbody>
          <tr>
            <td class="text-left sb-bg-gray pl-2">S.N</td>
            <td class="text-left sb-bg-gray pl-2">Insured Company</td>
            <td class="text-left sb-bg-gray pl-2">Policy Number</td>
            <td class="sb-bg-gray text-left pl-2">Insured Amount</td>
            <td class="sb-bg-gray text-left pl-2">Premium Amount</td>
            <td class="sb-bg-gray text-left pl-2">Asset Insured</td>
            <td class="sb-bg-gray text-left pl-2">Remark</td>
          </tr>
          <tr *ngFor="let ins of insurance; let i = index;">
            <td class="text-left pl-2">{{i+1}}</td>
            <td class="text-left pl-2">{{ins?.company || 'N/A'}}</td>
            <td class="text-left pl-2">{{ins?.policyNumber || 'N/A'}}</td>
            <td class="text-left pl-2">{{ins?.insuredAmount || 0}}</td>
            <td class="text-left pl-2">{{ins?.premiumAmount || 0}}</td>
            <td class="text-left pl-2">{{ins?.assetInsured || 'N/A'}}</td>
            <td class="text-left pl-2">{{ins?.remark || 'N/A'}}</td>
          </tr>
          </tbody>
        </table>
      </ng-container>
    </div>
  </div>


  <div class="col-md-12" *ngIf="isCorporate && (loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.securityInspection?.length > 0">
    <p class="float-left sub-header" ><strong  class="sub-header">{{'Security Inspection'}}</strong></p>
  </div>
    <div class="col-md-12" *ngIf="isCorporate">
      <table class="table table-sm sb-small table-bordered text-center" *ngIf="(loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.securityInspection?.length > 0">
        <thead>
        <tr class="sb-bg-gray">
          <th>Security Type</th>
          <th>Date of Inspection</th>
          <th>Report Filed</th>
          <th>Approved Frequency</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let data of (loanDataHolder?.loanHolder?.otherDetails | jsonParse)?.securityInspection">
            <td>
              {{data?.securityType}}
            </td>
            <td>
           {{data?.dateOfInspection | date}}
            </td>
            <td>
             {{data?.reportField}}
            </td>
            <td>
             {{data?.approvedFrequency}}
            </td>
        </tr>
        </tbody>
      </table>
    </div>



<div class="col-md-12">
  <hr class="print-line" *ngIf="isCorporate">
  <p class="header" *ngIf="isCorporate"><strong class="header">Customer Background</strong></p>
  <table class="table table-condensed table-bordered table-responsive-md table-sm sb-small company-detail summary">
    <tr *ngIf="isCorporate" class="sb-bg-gray">
      <th>Business Objectives </th>
    </tr>
    <tr *ngIf="isCorporate">
      <td class="text-left pl-1"><span [innerHTML]="companyJsonData?.marketScenario ? companyJsonData?.marketScenario?.BusinessIndustryOutlook : 'N/A' | safeHtml"></span></td>
    </tr>
    <tr class="sb-bg-gray">
      <th>Business Process </th>
    </tr>
    <tr>
      <td class="text-left pl-1"><span [innerHTML]="companyJsonData?.marketScenario ? companyJsonData?.marketScenario?.technicalAspect : 'N/A' | safeHtml"></span></td>
    </tr>
    <tr *ngIf="isCorporate" class="sb-bg-gray">
      <th>Raw Materials</th>
    </tr>
    <tr *ngIf="isCorporate">
      <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['securityRisk'] || 'N/A'"></td>
    </tr>
    <tr class="sb-bg-gray">
      <th>Major Buyers</th>
    </tr>
    <tr>
      <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['KeyBuyers']"></td>
    </tr>
    <tr class="sb-bg-gray">
      <th>Major Suppliers</th>
    </tr>
    <tr>
      <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['keySupplier']"></td>
    </tr>

<ng-container *ngIf="isCorporate">
  <tr class="sb-bg-gray">
    <th>Marketing and distribution Strategies</th>
  </tr>
  <tr>
    <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['marketingStrategies']"></td>
  </tr>


  <tr class="sb-bg-gray">
    <th>Pricing & Competitors Overview</th>
  </tr>
  <tr>
    <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['competitorsOverview']"></td>
  </tr>

  <tr class="sb-bg-gray">
    <th>Future plan</th>
  </tr>
  <tr>
    <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['futurePlan']"></td>
  </tr>


  <tr class="sb-bg-gray">
    <th>Latest Business Updates</th>
  </tr>
  <tr>
    <td class="text-left pl-1" [innerHTML]="companyJsonData?.marketScenario['latestBusinessUpdates']"></td>
  </tr>
</ng-container>
    <tr *ngIf="!isCorporate" class="sb-bg-gray">
      <th>Risk & Mitigants</th>
    </tr>
    <tr *ngIf="!isCorporate">
      <td class="text-left pl-1"><span [innerHTML]="companyJsonData?.businessManagementRisk | safeHtml"></span></td>
    </tr>
  </table>
</div>
</div>
