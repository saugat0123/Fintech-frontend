<section class="enable-print">
    <nb-card>
        <nb-card-body id="print-block">
            <div class="row disable-print">
                <div class="col-md-12">
                    <div *ngIf="loanDataHolder?.documentStatus?.toString() === 'PENDING'||
                    loanDataHolder?.documentStatus?.toString() === 'DISCUSSION' ||
                    loanDataHolder?.documentStatus?.toString() === 'UNDER_REVIEW'">
                        <nb-accordion>
                            <nb-accordion-item>
                                <nb-accordion-item-header>File Under Possession</nb-accordion-item-header>
                                <nb-accordion-item-body>
                                    <app-role-heirarchy-chain [refId]="id" [loanDataHolder]="loanDataHolder"
                                        [branchId]="loanDataHolder?.branch?.id"
                                        [combinedLoanId]="loanDataHolder?.combinedLoan?.id"
                                        [loanFlags]="loanDataHolder?.loanHolder?.loanFlags"></app-role-heirarchy-chain>
                                </nb-accordion-item-body>
                            </nb-accordion-item>
                        </nb-accordion>
                    </div>
                    <div class="mt-2"
                        *ngIf="(loanDataHolder?.documentStatus?.toString() === 'DISCUSSION' ||
                    loanDataHolder?.documentStatus?.toString() === 'UNDER_REVIEW'||
                    loanDataHolder?.documentStatus?.toString() === 'INITIAL' ||
                    loanDataHolder?.documentStatus?.toString() === 'PENDING') && roleType === 'MAKER' && productUtils.LOAN_APPROVAL_HIERARCHY_LEVEL.toString() === 'LOAN'">
                        <button class="btn btn-primary sb-medium text-uppercase" nbButton size="small" status="primary"
                            nbTooltip="Configure Approval Role Hierarchy"
                            (click)="SetRoleHierarchy(loanDataHolder?.id)">
                            <!--                            <i class="fa fa-user-shield"></i>-->
                            Set Role Hierarchy
                        </button>
                    </div>
                    <br>
                    <button nbButton shape="rectangle" status="primary" size="tiny" (click)="goToCustomer()"><em
                            class="fas fa-backward"></em> <span class="px-2">customer Profile</span></button>
                </div>
            </div>
            <div *ngIf="loanDataHolder?.parentId || loanDataHolder?.childId"
                class="row text-success cursor disable-print">
                <div class="col-md-6 text-left">
                    <a (click)="renewedOrCloseFrom(loanDataHolder?.parentId,loanDataHolder?.loan?.id)"
                        *ngIf="loanDataHolder?.parentId !== null"
                        class="text-left">{{loanType[loanDataHolder.loanType]}} From <i class="p-1 fa fa-eye"></i></a>
                </div>
                <div class="col-md-6 text-right">
                    <a (click)="renewedOrCloseFrom(loanDataHolder?.childId,loanDataHolder?.loan?.id)"
                        *ngIf="loanDataHolder?.childId !== null"
                        class="text-right">{{loanType[loanDataHolder.loanType]}} to <i class="p-1 fa fa-eye"></i></a>
                </div>
                <div class="col-md-12">
                    <hr />
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="mt-1 noprint">
                                <strong style="font-size:14px">Loan Status:</strong>
                                <span class="badge badge-info ml-1" style="font-size: 13px">
                                    {{loanDataHolder.documentStatus?.toString() | titlecase}}</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="report-header">
                                <div class="report-header-heading mb-2">{{client}}</div>
                                <div class="report-header-sub-heading">
                                    <span class="sb-small">Credit Facilities Report</span>
                                    <br>
                                    <span class="sb-small"> for </span>
                                </div>
                                <div class="report-header-sub-heading" *ngIf="!isJointInfo"><span
                                        class="sb-medium"><strong>
                                            {{loanCategory === 'INSTITUTION' ?
                                            loanDataHolder?.companyInfo?.companyName
                                            : loanDataHolder?.customerInfo?.customerName}} ({{loanCategory}})
                                        </strong> </span>
                                </div>
                                <div class="report-header-sub-heading" *ngIf="isJointInfo">
                                    <div *ngFor="let jointCustomer of jointInfo">
                                        <ng-container *ngFor="let info of jointCustomer">
                                            <span class="sb-medium">{{loanCategory === 'INSTITUTION' ?
                                                loanDataHolder?.companyInfo?.companyName :
                                                info?.customerName}} ({{loanCategory}})</span><br />
                                        </ng-container>
                                    </div>
                                </div>
                                <div class="report-header-sub-heading mt-2 mb-1">{{loanDataHolder?.branch?.name}} Branch
                                    ,
                                    {{loanDataHolder?.branch?.province?.name}}</div>
                                <div class="badge badge-warning mt-2 p-1">Summary</div>
                            </div>
                        </div>
                        <div class="col-md-3 text-right">
                            <img class="report-log img-thumbnail border-0" alt="logo"
                                src="../../../../../assets/img/logo.png">
                        </div>
                    </div>
                </div>
            </div>
            <!--            <div class="row">-->
            <!--                <div class="col-md-12">-->
            <!--                    <b>TO: {{loanDataHolder?.currentStage?.toUser?.name}} ({{loanDataHolder?.currentStage?.toRole?.roleName}})</b>-->
            <!--                    <br>-->
            <!--                    <b>THROUGH: {{loanDataHolder?.currentStage?.fromUser?.name}} ({{loanDataHolder?.currentStage?.fromRole?.roleName}})</b>-->
            <!--                    <br>-->
            <!--                    <b>FROM: </b> <br>-->
            <!--                    <b>CLIENT NAME: {{loanDataHolder?.loanHolder?.name}}</b> <br>-->
            <!--                    <b>GROUP: </b> <br>-->
            <!--                    <b>ACCOUNT NUMBER:</b> <br>-->
            <!--                    <b>CUSTOMER ID: {{loanDataHolder?.loanHolder?.customerCode || 'NA'}}</b> <br>-->
            <!--                    <b>DATE: {{loanDataHolder?.createdAt ? (loanDataHolder?.createdAt | date) : 'NA'}}</b>-->
            <!--                </div>-->
            <!--            </div>-->

            <div class="row ">
                <div class="col-md-12 sb-small">
                    <hr class="print-line">
                    <div class="clearfix">
                        <div class="float-left">
                            <span><strong>Ref. No: </strong>{{loanDataHolder?.refNo}}</span> <br>
                            <span> <b>Application Received On:</b> {{loanDataHolder?.createdAt | date}}
                                ({{loanDataHolder?.createdAt | engNepDate: false}})</span> <br>
                            <span *ngIf="loanDataHolder?.loanHolder?.customerCategory !== 'AGRICULTURE_UPTO_ZERO_POINT_FIVE_MILLION'">
                                <b>Purpose: {{loanDataHolder?.loan?.name}}</b></span>
                        </div>
                        <div class="float-right" *ngIf="loanDataHolder?.loanHolder?.customerCategory !== 'AGRICULTURE_UPTO_ZERO_POINT_FIVE_MILLION'">
                            <span><b>Loan Under</b>- {{loanDataHolder?.currentStage?.toUser?.name}}
                                ({{loanDataHolder?.currentStage?.toRole?.roleName}})</span><br>
                            <span *ngIf="currentDocAction === 'FORWARD'">Forwarded</span>
                            <span *ngIf="currentDocAction === 'BACKWARD'">Backwarded</span> <b> by:</b> {{loanDataHolder?.currentStage?.fromUser?.name}}
                            ({{loanDataHolder?.currentStage?.fromRole?.roleName}})
                            <b> on:</b> {{loanDataHolder?.lastModifiedAt | date}} ({{loanDataHolder?.lastModifiedAt | engNepDate: false}})
                            <br>
                            <span><strong>Final Approver: </strong>{{loanDataHolder?.solUser?.name
                                ? loanDataHolder?.solUser?.name + ' (' + loanDataHolder?.solUser?.role.roleName+ ')': 'NA'}}</span>
                        </div>
                        <br>
                    </div>
                </div>
            </div>
            <!-- CRG - Gamma-->
            <div *ngIf="crgGammaSummary" class="col-md-12">
                <nb-card class="sb-medium" *ngIf="loanDataHolder?.loanHolder?.customerCategory !== 'AGRICULTURE_UPTO_ZERO_POINT_FIVE_MILLION'">
                    <nb-card-header class="text-center">
                        <h6>Credit Scoring</h6>
                    </nb-card-header>
                    <nb-card-body>
                        <div class="row">
                            <div class="col-md-6 text-right">
                                <app-gauge-chart [chartHeight]="180" [chartWidth]="275" [maxValue]="100"
                                                 [obtainedValue]="crgGammaScore"
                                                 gaugeIdentifier="crg-gamma"></app-gauge-chart>
                            </div>
                            <div class="col-md-6 gauge-label-padding">
                                <div class="vertical-line">
                                    <div class="text-left pl-2">
                                        Credit Risk Grade:
                                        <span [class]="crgGammaGradeStatusBadge">
                                                {{crgGammaGrade | titlecase}}</span>
                                    </div>
                                    <br>
                                    <div class="text-left pl-2">
                                        Credit Risk Score:
                                        <span><strong> {{ crgGammaScore }}</strong></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </nb-card-body>
                </nb-card>
            </div>
            <hr class="print-line mt-2">
            <div class="row">
                <div class="col-md-12">
                    <app-credit-facility-report
                            [loanDataHolder]="loanDataHolder"
                            [customerLoanList]="customerAllLoanList"></app-credit-facility-report>
                </div>
            </div>
<!--            <div class="row">-->
<!--                <div class="col-md-12">-->
<!--                    <app-group-credit-facility-report [loanDataHolder]="loanDataHolder" [mGroupInfo]="mGroupInfo"-->
<!--                        [customerLoanList]="customerAllLoanList"></app-group-credit-facility-report>-->
<!--                </div>-->
<!--            </div>-->
<!--            <app-security-summary class="mt-3" *ngIf="securitySummary" [formData]="securityData"-->
<!--                                  [shareSecurity]="shareSecurityData" [collateralSiteVisitDetail]="collateralSiteVisitDetail"-->
<!--                                  [securityId]="securityId" [siteVisitDocuments]="siteVisitDocuments"-->
<!--                                  [isCollateralSiteVisit]="isCollateralSiteVisit" [collateralData]="loanDataHolder?.collateralSiteVisits"-->
<!--                                  [docStatus]="loanDataHolder?.documentStatus"-->
<!--                                  (downloadSiteVisitDocument)="checkSiteVisitDocument($event)"></app-security-summary>-->


            <!-- DONT-DETELE -->
            <!-- 
            <div class="row">
                <div class="col-md-12">
                    <b>TO: {{loanDataHolder?.currentStage?.toUser?.name}} ({{loanDataHolder?.currentStage?.toRole?.roleName}})</b>
                    <br>
                    <b>THROUGH: {{loanDataHolder?.currentStage?.fromUser?.name}} ({{loanDataHolder?.currentStage?.fromRole?.roleName}})</b>
                    <br>
                    <b>FROM: </b> <br>
                    <b>CLIENT NAME: {{loanDataHolder?.loanHolder?.name}}</b> <br>
                    <b>GROUP: </b> <br>
                    <b>ACCOUNT NUMBER:</b> <br>
                    <b>CUSTOMER ID: {{loanDataHolder?.loanHolder?.customerCode || 'NA'}}</b> <br>
                    <b>DATE: {{loanDataHolder?.createdAt ? (loanDataHolder?.createdAt | date) : 'NA'}}</b>
                </div>
            </div>

             <div class="row" *ngIf="loanCategory === 'INDIVIDUAL' && !isJointInfo"> -->
            <!-- 1.	Date of Association
                2.	Capital Structure
                3.	Proprietor/Promoters/Shareholding Pattern:
                4.	Request of the Client:
                5.	Business activity/customer background:  -->
            <!-- <div class="col-md-12">
                    <p><strong>Details of Borrower</strong></p>
                </div> -->
            <!-- <div class="col-md-12">

                    <div *ngIf="loanCategory === 'INDIVIDUAL'">
                        <p class="mt-2"><strong>Family Details</strong></p>
                        <table
                            class="table table-condensed table-bordered table-responsive-md text-center table-sm sb-small">
                            <thead>
                                <tr class="text-white sb-bg-dark">
                                    <th>Name</th>
                                    <th>Relation Name</th>
                                    <th>Citizenship no.</th>
                                    <th>Citizenship Issued Date (AD/BS)</th>
                                    <th>Net Worth</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let relative of loanDataHolder?.customerInfo?.customerRelatives">
                                    <td class="text-left pl-1">
                                        {{relative.customerRelativeName}}
                                    </td>

                                    <td class="text-left pl-1">
                                        {{relative.customerRelation}}
                                    </td>
                                    <td class="text-right pr-1">
                                        {{relative.citizenshipNumber}}
                                    </td>
                                    <td class="text-left pl-1">
                                        {{relative?.citizenshipIssuedDate ? (relative?.citizenshipIssuedDate | date) : 'NA'}}
                                        ({{ relative?.citizenshipIssuedDate ? (relative.citizenshipIssuedDate | engNepDate: false) : 'NA'}})
                                    </td>
                                    <td class="text-right pr-1">
                                        Rs. {{relative?.relativeNetWorth}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div> -->

            <!--                    <div>-->
            <!--                        <table-->
            <!--                            class="table table-condensed table-bordered table-sm table-responsive-md text-center sb-small">-->
            <!--                            <thead>-->
            <!--                                <tr class="text-white sb-bg-dark">-->
            <!--                                    <th>Name</th>-->
            <!--                                    <th>Date Of Birth(AD/BS)</th>-->
            <!--                                    <th>Age</th>-->
            <!--                                    <th>Citizenship Number</th>-->
            <!--                                    <th>Mobile Number</th>-->
            <!--                                    <th>LandLine Number</th>-->
            <!--                                    <th>Occupation</th>-->
            <!--                                    <th>Income Source</th>-->
            <!--                                </tr>-->
            <!--                            </thead>-->
            <!--                            <tbody>s-->
            <!--                                <tr class="text-left">-->
            <!--                                    <td class="pl-1">{{loanDataHolder?.customerInfo?.customerName}}</td>-->
            <!--                                    <td class="pl-1">{{loanDataHolder?.customerInfo?.dob | date}}-->
            <!--                                        ({{loanDataHolder?.customerInfo?.dob | engNepDate: false}})</td>-->
            <!--                                    <td class="text-left pl-1">{{calculateAge(loanDataHolder?.customerInfo?.dob)}} years-->
            <!--                                    </td>-->
            <!--                                    <td class="text-right pr-1">{{loanDataHolder?.customerInfo?.citizenshipNumber}}</td>-->
            <!--                                    <td class="text-right pr-1">{{loanDataHolder?.customerInfo?.contactNumber}}</td>-->
            <!--                                    <td class="text-right pr-1">{{loanDataHolder?.customerInfo?.landLineNumber}}</td>-->
            <!--                                    <td class="pl-1">-->
            <!--                                        {{(loanDataHolder?.customerInfo?.occupation | jsonParse)?.multipleOccupation || 'NA'}}-->
            <!--                                    </td>-->
            <!--                                    <td class="pl-1">-->
            <!--                                        {{(loanDataHolder?.customerInfo?.incomeSource | jsonParse)?.multipleIncome || 'NA'}}-->
            <!--                                    </td>-->


            <!--                                </tr>-->
            <!--                                <tr class="text-white sb-bg-dark">-->
            <!--                                    <th>Customer Client Type</th>-->
            <!--                                    <th>SubSector</th>-->
            <!--                                    &lt;!&ndash;<td>Address as per Legal Document</td>&ndash;&gt;-->
            <!--                                </tr>-->
            <!--                                <tr>-->
            <!--                                    <td class="text-left pl-1">{{loanDataHolder?.loanHolder['clientType']}}</td>-->
            <!--                                    <td class="text-left pl-1">-->
            <!--                                        {{loanDataHolder?.loanHolder['subsectorDetail'] || 'N/A'}}</td>-->
            <!--                                    &lt;!&ndash;<td>{{loanDataHolder?.customerInfo?.customerLegalDocumentAddress}}</td>&ndash;&gt;-->

            <!--                                </tr>-->
            <!--                            </tbody>-->
            <!--                        </table>-->
            <!--                        &lt;!&ndash;                        <table class="print-only table table-bordered text-center table-sm sb-small"&ndash;&gt;-->
            <!--                        &lt;!&ndash;                               id="print-borrower-table">&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            <thead>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            <tr class="text-white sb-bg-dark">&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <th>Name</th>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <th>Date Of Birth</th>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <th>Citizenship Number</th>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <th>Mobile Number</th>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <th>Occupation</th>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <th>Income Source</th>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            </tr>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            </thead>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            <tbody>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            <tr>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <td>{{loanDataHolder?.customerInfo?.customerName}}</td>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <td>{{loanDataHolder?.customerInfo?.dob | date}}</td>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <td>{{loanDataHolder?.customerInfo?.citizenshipNumber}}</td>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <td>{{loanDataHolder?.customerInfo?.contactNumber}}</td>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <td>{{loanDataHolder?.customerInfo?.occupation}}</td>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                                <td>{{loanDataHolder?.customerInfo?.incomeSource}}</td>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            </tr>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                            </tbody>&ndash;&gt;-->
            <!--                        &lt;!&ndash;                        </table>&ndash;&gt;-->
            <!--                    </div>-->

            <!-- </div>
            </div>
            <div class="row" *ngIf="loanCategory === 'INDIVIDUAL' && isJointInfo">
                <div class="col-md-12">
                    <p><strong>Details of Borrower</strong></p>
                </div>
                <div class="col-md-12">
                    <div>
                        <table
                            class="table table-condensed table-bordered table-sm table-responsive-md text-center sb-small">
                            <thead>
                            </thead>
                            <tbody *ngFor="let jointCustomer of jointInfo">
                                <ng-container *ngFor="let info of jointCustomer">
                                    <tr class="text-white sb-bg-dark">
                                        <th>Name</th>
                                        <th>Date Of Birth(AD/BS)</th>
                                        <th>Age</th>
                                        <th>Citizenship Number</th>
                                        <th>Mobile Number</th>
                                        <th>LandLine Number</th>
                                        <th>Occupation</th>
                                        <th>Income Source</th>
                                    </tr>
                                    <tr class="text-left">
                                        <td class="pl-1">{{info?.customerName}}</td>
                                        <td class="pl-1">{{info?.dob | date}} ({{info?.dob | engNepDate: false}})</td>
                                        <td class="text-left pl-1">{{calculateAge(info?.dob)}} years</td>
                                        <td class="text-right pr-1">{{info?.citizenshipNumber}}</td>
                                        <td class="text-right pr-1">{{info?.contactNumber || 'NA'}}</td>
                                        <td class="text-right pr-1">{{info?.landLineNumber || 'NA'}}</td>
                                        <td class="pl-1">{{info?.occupation || 'NA'}}</td>
                                        <td class="pl-1">{{info?.incomeSource || 'NA'}}</td>
                                    </tr>
                                    <tr>
                                        <th colspan="5">Family Detail</th>
                                    </tr>
                                    <tr class="text-white sb-bg-dark">
                                        <th>Name</th>
                                        <th>Relation Name</th>
                                        <th>Citizenship no.</th>
                                        <th>Citizenship Issued District</th>
                                        <th>Citizenship Issued Date(AD/BS)</th>
                                    </tr>
                                    <tr *ngIf="info?.customerRelativeName1">
                                        <td class="text-left pl-1">{{info?.customerRelativeName1 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.customerRelation1 || 'NA'}}</td>
                                        <td class="text-right pr-1">{{info?.citizenshipNumber1 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.citizenshipIssuedPlace1 || 'NA'}}</td>
                                        <td class="text-left pl-1">
                                            {{info?.citizenshipIssuedDate1 ? (info?.citizenshipIssuedDate1 | date) : 'N/A'}}
                                            ({{info?.citizenshipIssuedDate1 ? (info?.citizenshipIssuedDate1 | engNepDate: false) : 'N/A'}})
                                        </td>
                                    </tr>
                                    <tr *ngIf="info?.customerRelativeName2">
                                        <td class="text-left pl-1">{{info?.customerRelativeName2 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.customerRelation2 || 'NA'}}</td>
                                        <td class="text-right pr-1">{{info?.citizenshipNumber2 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.citizenshipIssuedPlace2 || 'NA'}}</td>
                                        <td class="text-left pl-1">
                                            {{info?.citizenshipIssuedDate2 ? (info?.citizenshipIssuedDate2 | date) : 'N/A'}}
                                            ({{info?.citizenshipIssuedDate2 ? (info?.citizenshipIssuedDate2 | engNepDate: false) : 'N/A'}})
                                        </td>
                                    </tr>
                                    <tr *ngIf="info?.customerRelativeName3">
                                        <td class="text-left pl-1">{{info?.customerRelativeName3 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.customerRelation3 || 'NA'}}</td>
                                        <td class="text-right pr-1">{{info?.citizenshipNumber3 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.citizenshipIssuedPlace3 || 'NA'}}</td>
                                        <td class="text-left pl-1">
                                            {{info?.citizenshipIssuedDate3 ? (info?.citizenshipIssuedDate3 | date) : 'N/A'}}
                                            ({{info?.citizenshipIssuedDate3 ? (info?.citizenshipIssuedDate3 | engNepDate: false) : 'N/A'}})
                                        </td>
                                    </tr>
                                    <tr *ngIf="info?.customerRelativeName4">
                                        <td class="text-left pl-1">{{info?.customerRelativeName4 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.customerRelation4 || 'NA'}}</td>
                                        <td class="text-right pr-1">{{info?.citizenshipNumber4 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.citizenshipIssuedPlace4 || 'NA'}}</td>
                                        <td class="text-left pl-1">
                                            {{info?.citizenshipIssuedDate4 ? (info?.citizenshipIssuedDate4 | date) : 'N/A'}}
                                            ({{info?.citizenshipIssuedDate4 ? (info?.citizenshipIssuedDate4 | engNepDate: false) : 'N/A'}})
                                        </td>
                                    </tr>
                                    <tr *ngIf="info?.customerRelativeName5">
                                        <td class="text-left pl-1">{{info?.customerRelativeName5 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.customerRelation5 || 'NA'}}</td>
                                        <td class="text-right pr-1">{{info?.citizenshipNumber5 || 'NA'}}</td>
                                        <td class="text-left pl-1">{{info?.citizenshipIssuedPlace5 || 'NA'}}</td>
                                        <td class="text-left pl-1">
                                            {{info?.citizenshipIssuedDate5 ? (info?.citizenshipIssuedDate5 | date) : 'N/A'}}
                                            ({{info?.citizenshipIssuedDate5 ? (info?.citizenshipIssuedDate5 | engNepDate: false) : 'N/A'}})
                                        </td>
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


            <app-financial-summary *ngIf="financialSummary" [formData]="financialData"
                [loanType]="loanDataHolder?.loanCategory"></app-financial-summary>

            <div *ngIf="!productUtils.CBS_ENABLE">
                <app-proposal-justification-summary *ngIf="proposalSummary" [customerAllLoanList]="customerAllLoanList"
                    [proposalData]="proposalData"></app-proposal-justification-summary>
            </div>
            <div>
                <app-home-loan-checklist [customerAllLoanList]="customerAllLoanList"></app-home-loan-checklist>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <p class="mt-2"><strong>Source of Income</strong></p>
                    <table class="table table-bordered text-right table-sm sb-small text-center">
                        <thead>
                        <tr>
                            <th class="text-center" colspan="6">Monthly Income</th>
                        </tr>
                        <tr class="text-white sb-bg-dark">
                            <th>S.N</th>
                            <th>Source of Income</th>
                            <th>Organization</th>
                            <th>Amount</th>
                            <th>Age Of Income Generated</th>
                            <th>Remarks</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let incomeOfBorrower of incomeDataOnly?.initialForm?.incomeOfBorrower; let i = index;">
                            <td>{{i + 1}}</td>
                            <td class="text-left pl-1">{{incomeOfBorrower.incomeSource}}</td>
                            <td class="text-left pl-1">{{incomeOfBorrower.organization}}</td>
                            <td class="text-right pr-1">Rs. {{incomeOfBorrower.amount | currencyFormatter}}</td>
                            <td>{{incomeOfBorrower.ageOfIncomeGenerated|| '0'}} months</td>
                            <td class="text-left pl-1">{{incomeOfBorrower.remarks}}</td>
                        </tr>
                        <tr>
                            <td class="text-left pl-1" colspan="3"><strong>Total Income</strong></td>
                            <td colspan="3" class="text-right pr-1">
                                <strong>Rs. {{incomeDataOnly?.initialForm?.totalIncome | currencyFormatter}}</strong>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div *ngIf="!productUtils.CBS_ENABLE">
                <app-collateral-summary *ngIf="customerAllLoanList?.length > 0 && loanDataHolder?.security"
                                        [customerAllLoanList]="customerAllLoanList" [security]="loanDataHolder?.security">
                </app-collateral-summary>

            </div>
            <div class="mt-3">
                <app-income-from-account-summery *ngIf="incomeFromAccountSummary" [formData]="incomeFromAccountData">
                </app-income-from-account-summery>
            </div> -->

            <!-- FOR GROUP EXPOSURE AND COMPANIES UNDER THE GROUP -->
            <!-- <section>
            <div *ngIf="megaGroupEnabled">
                <app-m-group-summary [mGroup]="loanDataHolder?.loanHolder.mgroupInfo"></app-m-group-summary>
            </div>

            <div *ngIf="sbsGroupEnabled">
                <app-customer-group-summary *ngIf="loanDataHolder?.loanHolder?.customerGroup"
                    [groupDto]="loanDataHolder?.groupSummaryDto" [customerInfoData]="loanDataHolder.loanHolder">
                </app-customer-group-summary>
            </div>
            <div *ngIf="productUtils.CBS_ENABLE">
                <div class="row mt-5">
                    <div class="col-md-12">
                        <p><strong>Group Details</strong>
                        </p>
                    </div>
                    <div class="col-md-12">
                        <app-cbs-table [customerInfo]="loanDataHolder.loanHolder" *ngIf="loanDataHolder">
                        </app-cbs-table>
                    </div>
                </div>
            </div>
        </section>
            <div class="row">
                <div class="col-md-12">
                    <p class="mt-2"><strong>Repayment</strong></p>
                    <ol>
                        <li><b>{{proposalView?.installmentAmount}}</b> equal monthly installments commencing from the 10th of every Gregorian calendar from the next month of initial drawdown.
                            The client shall serve interest on the loan outstanding during the first month, calculated on the daily debit outstanding fron the date of disbursement.</li>
                        <li>The above mentioned loan when repaid in the part or full shall not be reinstated by the extend of the amount repaid/settled.</li>
                    </ol>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12" *ngFor="let cal of customerAllLoanList">
                    <p class="mt-2"><strong>Mode of Disbursement of {{cal?.loan?.name}}</strong></p>
                    <p>This loan shall be disbursed as under:</p>
                    <ul>
                        <li>We shall disburse loan amount of NRP <b>{{cal?.proposal.proposedLimit}}</b> Mio or .... % of FMV of the real estate collateral whichever is lowered by crediting the current account of
                            Mr. <b>{{cal?.loanHolder?.name}}</b> maintained at <b>{{cal?.branch?.name}}</b> Branch or issued Managers Cheque in the name of Seller or as per request of the
                            application upon the completion of security documents.</li>
                        <li>Execution of all the security documents including mortgaged of proposed collateral.</li>
                        <li>Letter of undertaking to the seller shall be issued at the request of buyer.</li>
                        <li>Completion of security documentations.</li>
                    </ul>
                </div>
            </div>

            <div class="mt-3">
                <app-cicl-view *ngIf="loanDataHolder?.loanHolder?.cicl" [ciclValue]="loanDataHolder?.loanHolder?.cicl"></app-cicl-view>
            </div> -->


            <!-- <div *ngIf="loanDataHolder?.dmsLoanFile !== null" class="row mt-3">
                <div class="col-md-12">
                    <p><strong>Waiver/Deviation </strong></p>
                    <p class="border text-justify p-1">
                        {{dmsLoanFile?.waiver}}
                    </p>
                </div>
            </div>

            <div *ngIf="loanDataHolder?.dmsLoanFile !== null" class="row mt-3">
                <div class="col-md-12">
                    <p><strong>Recommendation</strong></p>
                    <p class="border text-justify p-1">
                        {{dmsLoanFile?.recommendationConclusion}}
                    </p>
                </div>
            </div> -->

            <!-- PROPOSAL VIEW WAIVER AND RECOMMENDATION -->
            <!-- <div class="row">
                <div class="col-md-12">
                    <p class="mt-3"><strong>Waiver/Deviation: </strong></p>
                    <p class="border text-justify p-1">
                        {{proposalView?.waiverConclusionRecommendation}}
                    </p> -->

            <!-- <span [innerHTML]="proposalView?.waiverConclusionRecommendation || 'N/A' | safeHtml"></span>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <p><strong>Recommendation: </strong></p>
                    <table class="table table-bordered table-responsive-md table-sm sb-small text-center">
                        <thead>
                        <tr>
                            <th class="text-left" colspan="6">Recommend as Follows</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>
                                <p>Proposal:</p>
                                <p>The client has requested us to provide Rs. <b>{{proposalView?.proposedLimit}}</b></p>
                            </td>
                        </tr>
                        <tr *ngFor="let cl of customerAllLoanList" class="text-left pl-1">
                            <td>
                                <span>Pricing: {{cl?.loan?.name}}</span> <br>
                                <span>Interest: <b>{{(cl?.proposal?.data | jsonParse)?.interestRate}}</b> % p.a (BR + 0.59%)</span> <br>
                                Loan Administrative Fee: <b>{{(cl?.proposal?.data | jsonParse)?.serviceCharge}}</b> % of the approve limit
                                <br>
                                CIC charge: <b>{{(cl?.loanHolder?.cicl?.data | jsonParse)?.cibCharge}}</b> <br>
                                Prepayment Charge: <b>{{(cl?.proposal?.data | jsonParse)?.prepaymentCharge}}</b> <br>
                                Swap Charge: <b>{{(cl?.proposal?.data | jsonParse)?.swapCharge}}</b>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <span [innerHTML]="proposalView?.summeryRecommendation || 'N/A' | safeHtml"></span>
                </div>
            </div>



            <div *ngIf="loanDataHolder?.dmsLoanFile !== null" class="row mt-3">
                <div class="col-md-12">
                    <p><strong>Security Offered</strong></p>
                    <p><label *ngFor="let security of securities; let i = index">{{i + 1}}
                            . {{Security[security]}}&nbsp;&nbsp;</label>
                    </p>
                </div>
            </div>

            <app-previous-security-summary *ngIf="previousSecuritySummary" [formData]="dataFromPreviousSecurity">
            </app-previous-security-summary>

            <app-proposal-summary class="mt-3" *ngIf="proposalSummary" [customerAllLoanList]="customerAllLoanList"
                [proposalData]="proposalData" [loanDataHolder]="loanDataHolder"></app-proposal-summary>

            <div *ngIf="loanDataHolder?.dmsLoanFile !== null" class="row">
                <div class="col-md-12">
                    <p><strong>Detail of Present Proposal of the Facility</strong></p>
                    <table class="table table-bordered text-center table-sm sb-small">
                        <tbody>
                            <tr>
                                <th>Credit Facility</th>
                                <td>{{loanDataHolder?.loan?.name}}</td>

                                <th>Loan Category</th>
                                <td>{{loanDataHolder?.loanCategory === 'INDIVIDUAL' ? 'PERSONAL'
                                : 'BUSINESS'}}</td>

                                <th>Proposed Limit</th>
                                <td>{{dmsLoanFile?.proposedAmount
                            || loanDataHolder?.proposal?.proposedLimit | currencyFormatter}}</td>

                                <th>Interest Rate</th>
                                <td>{{dmsLoanFile?.interestRate || loanDataHolder?.proposal?.interestRate}} %</td>

                                <th>Tenure Duration In Month</th>
                                <td>{{(dmsLoanFile?.tenureDuration
                                || loanDataHolder?.proposal?.tenureDurationInMonths)}}</td>

                            </tr>
                            <tr>
                                <th>Service Charge</th>
                                <td>{{dmsLoanFile?.serviceChargeType === 'Flat' ? ' NRs. ' : ''}}
                                    {{dmsLoanFile?.serviceChargeAmount || loanDataHolder?.proposal?.serviceCharge}}
                                    {{dmsLoanFile?.serviceChargeType === 'Percentage' ? ' %' : ''}}
                                </td>

                                <th>FMV Funding Percentage</th>
                                <td>{{dmsLoanFile?.fmvFundingPercent}} %</td>

                                <th>Total FMV</th>
                                <td>{{dmsLoanFile?.fmvTotal | currencyFormatter}}</td>

                                <th>Total DV</th>
                                <td>{{dmsLoanFile?.distressValue | currencyFormatter}}</td>

                                <th>Total Loan Limit</th>
                                <td>{{dmsLoanFile?.totalLoanLimit | currencyFormatter}}</td>
                            </tr>
                            <tr>
                                <th *ngIf="loanDataHolder.loanCategory === 'INDIVIDUAL'">Individual Exposure</th>
                                <td *ngIf="loanDataHolder.loanCategory === 'INDIVIDUAL'">
                                    {{dmsLoanFile?.individualExposure | currencyFormatter}}</td>

                                <th *ngIf="loanDataHolder.loanCategory === 'INSTITUTION'">Institution Exposure</th>
                                <td *ngIf="loanDataHolder.loanCategory === 'INSTITUTION'">
                                    {{dmsLoanFile?.institutionExposure | currencyFormatter}}</td>

                                <th>Group Exposure</th>
                                <td>{{dmsLoanFile?.groupExpo | currencyFormatter}}</td>

                                <th *ngIf="loanDataHolder.loanCategory === 'INDIVIDUAL'">Interest Coverage Ratio
                                </th>
                                <td *ngIf="loanDataHolder.loanCategory === 'INDIVIDUAL'">
                                    {{dmsLoanFile?.incomeCoverageRatio}}</td>

                                <th *ngIf="loanDataHolder.loanCategory === 'INSTITUTION'">Debt Service Coverage
                                    Ratio
                                </th>
                                <td *ngIf="loanDataHolder.loanCategory === 'INSTITUTION'">
                                    {{dmsLoanFile?.debtServiceCoverageRatio}}</td>

                                <th *ngIf="loanDataHolder.loanCategory === 'INSTITUTION'">Dealing Product Name</th>
                                <td *ngIf="loanDataHolder.loanCategory === 'INSTITUTION'">
                                    {{dmsLoanFile?.dealingProductName}}</td>
                            </tr>
                            <tr>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div> -->

            <!--<div class="row mt-3">
                <div class="col-md-6">
                    <p style="font-size: 15px"><strong>Service Charge Type</strong></p>
                    <table class="table table-condensed table-bordered">
                        <tbody>
                        <tr>
                            <td>{{dmsLoanFile?.serviceChargeType}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6">
                    <p style="font-size: 15px"><strong>Service Charge Amount</strong></p>
                    <table class="table table-condensed table-bordered">
                        <tbody>
                        <tr>
                            <td>{{dmsLoanFile?.serviceChargeAmount}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>-->

            <!-- <div *ngIf="loanDataHolder?.customerInfo?.withinLimitRemarks">
                <table class="table table-condensed table-bordered table-responsive-md text-center table-sm sb-small">
                    <tr class="sb-bg-dark text-white">
                        <th>Within Limit Remarks (if any)</th>
                    </tr>
                    <tr>
                        <td class="text-left pl-1"> {{loanDataHolder?.customerInfo?.withinLimitRemarks}}</td>
                    </tr>
                </table>
            </div>

            <div *ngIf="loanDataHolder?.companyInfo?.withinLimitRemarks">
                <table class="table table-condensed table-bordered table-responsive-md text-center table-sm sb-small">
                    <tr class="sb-bg-dark text-white">
                        <th>Within Limit Remarks (if any)</th>
                    </tr>
                    <tr>
                        <td class="text-left pl-1"> {{loanDataHolder?.companyInfo?.withinLimitRemarks}}</td>
                    </tr>
                </table>
            </div> -->

            <!-- FOR GROUP DETAILS IN RETAIL-CA -->
            <!-- <section>
            <div *ngIf="megaGroupEnabled">
                <app-m-group-summary [mGroup]="loanDataHolder?.loanHolder.mgroupInfo"></app-m-group-summary>
            </div>

            <div *ngIf="sbsGroupEnabled">
                <app-customer-group-summary *ngIf="loanDataHolder?.loanHolder?.customerGroup"
                    [groupDto]="loanDataHolder?.groupSummaryDto" [customerInfoData]="loanDataHolder.loanHolder">
                </app-customer-group-summary>
            </div>
            <div *ngIf="productUtils.CBS_ENABLE">
                <div class="row mt-5">
                    <div class="col-md-12">
                        <p><strong>Group Details</strong>
                        </p>
                    </div>
                    <div class="col-md-12">
                        <app-cbs-table [customerInfo]="loanDataHolder.loanHolder" *ngIf="loanDataHolder">
                        </app-cbs-table>
                    </div>
                </div>
            </div>
        </section> -->
            <!-- 
            <hr>


            <ng-template #otherBank>
                <app-nta-summary *ngIf="netTradingAssetsSummary && fiscalYearArray?.length > 0"
                    [fiscalYears]="fiscalYearArray" [netTradingAssetsData]="netTradingAssetsData"></app-nta-summary>
            </ng-template>
            <br>
            <div>
                <app-comments-summary *ngIf="commentsSummary" [formData]="dataFromComments"></app-comments-summary>
            </div>

            <br>
            <div>
                <app-guarantor-view *ngIf="loanDataHolder?.taggedGuarantors?.length > 0"
                    [guarantorData]="loanDataHolder?.taggedGuarantors"></app-guarantor-view>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <app-sitevist-summary-component *ngIf="siteVisitSummary" [formData]="siteVisitData"
                        [loanType]="loanDataHolder?.loanCategory"></app-sitevist-summary-component>
                </div>
            </div>

            <div *ngIf="loanDataHolder?.documentStatus?.toString()==='APPROVED'">

                <app-report-summary [approved]="true" *ngIf="loanDataHolder?.reportingInfoLog"
                    [reportingInfoLevelLog]="loanDataHolder?.reportingInfoLog">
                </app-report-summary>
            </div>
            <div *ngIf="loanDataHolder?.documentStatus?.toString() !=='APPROVED'">
                <span><strong>Loan Reporting Information</strong></span>
                <app-report-summary [approved]="false"
                    *ngIf="loanDataHolder?.reportingInfoLevels && loanDataHolder?.reportingInfoLevels?.length > 0; else noinfo"
                    [reportingInfoLevels]="loanDataHolder?.reportingInfoLevels"></app-report-summary>
                <ng-template #noinfo>
                    <p>No any information tagged</p>
                </ng-template>
            </div>
            <div
                *ngIf="loanDataHolder?.loanHolder?.reportingInfoLevels && loanDataHolder?.loanHolder?.reportingInfoLevels?.length > 0 ">
                <span><strong>Customer Reporting Information</strong></span>
                <app-report-summary [approved]="false"
                    [reportingInfoLevels]="loanDataHolder?.loanHolder?.reportingInfoLevels"></app-report-summary>
            </div> -->

            <!-- <app-insurance-summary *ngIf="loanDataHolder?.insurance" [insurance]="loanDataHolder?.insurance">
            </app-insurance-summary> -->
            <!-- <div class="row">
                <div class="col-md-12 disable-print">
                    <span>
                        <b>All Documents</b>
                        <button class="float-right sb-small sb-bg-dark text-white"
                            *ngIf="!hidePreviewButton || !loanDataHolder?.zipPath"
                            (click)=getDocPath()> Download All Document</button>
                        <button class="float-right sb-small sb-bg-dark text-white"
                            *ngIf="hidePreviewButton || loanDataHolder?.zipPath"
                            (click)="downloadCustomerDocument(loanDataHolder?.zipPath, loanDataHolder?.id + zipDocumentName)">
                            Download All Document</button>
                    </span>
                </div>
            </div>
            <hr>
            <div *ngIf="loanDataHolder?.customerDocument?.length > 0" class="row disable-print">
                <div class="col-md-12">
                    <p><strong>Loan Documents</strong></p>
                </div>
                <div class="col-md-12">
                    <table class="table table-condensed table-bordered table-sm sb-small text-center">
                        <thead>
                            <tr class="text-white sb-bg-dark">
                                <th>S.N</th>
                                <th>Document</th>
                                <th>Preview</th>
                                <th>Download</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let singleDoc of loanDataHolder?.customerDocument; let i = index">
                                <td>{{i + 1}}</td>
                                <td class="text-left pl-1">{{singleDoc?.document?.name}}</td>
                                <td>
                                    <i (click)="previewOfferLetterDocument(singleDoc?.documentPath,singleDoc?.document?.displayName)"
                                        class="fas fa-eye"></i>
                                </td>
                                <td>
                                    <i (click)="downloadCustomerDocument(singleDoc?.documentPath, singleDoc?.document?.name)"
                                        aria-hidden="true" class="fa fa-download" style="cursor: pointer"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div *ngIf="loanDataHolder?.loanHolder?.customerGeneralDocuments?.length > 0 " class="row disable-print">
                <div class="col-md-12">
                    <table class="table table-condensed table-bordered table-sm sb-small text-center">

                        <tr class="text-white sb-bg-dark">
                            <th colspan="4"> Customer General Document
                            </th>
                        </tr>
                        <tr class="text-white sb-bg-dark">
                            <th>S.N</th>
                            <th>Document</th>
                            <th *ngIf="!hidePreviewButton">Preview</th>
                            <th *ngIf="!hidePreviewButton">Download</th>
                        </tr>
                        <tr
                            *ngFor="let generalDoc of loanDataHolder?.loanHolder?.customerGeneralDocuments; let i=index">
                            <td>{{i + 1}}</td>
                            <td class="text-left pl-1">
                                {{generalDoc.docPath.substring(generalDoc?.docPath.lastIndexOf('/') + 1, generalDoc.docPath.length)}}
                            </td>
                            <td *ngIf="!hidePreviewButton">
                                <i (click)="previewOfferLetterDocument(generalDoc?.docPath,generalDoc?.document?.displayName)"
                                    class="fas fa-eye"></i>
                            </td>
                            <td *ngIf="!hidePreviewButton">
                                <i (click)="downloadCustomerDocument(generalDoc?.docPath,generalDoc?.document?.displayName)"
                                   class="fas fa-download" style="cursor: pointer"></i>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div *ngIf="minOneGuarantorDoc" class="row disable-print">
                <div class="col-md-12">
                    <p><strong>Guarantor Documents</strong></p>
                    <table class="table table-condensed table-bordered table-sm sb-small text-center">
                        <thead>
                            <tr class="text-white sb-bg-dark">
                                <th>S.N</th>
                                <th>Guarantor</th>
                                <th>Document</th>
                                <th *ngIf="!hidePreviewButton">Preview</th>
                                <th *ngIf="!hidePreviewButton">Download</th>
                            </tr>
                        </thead>
                        <ng-container *ngFor="let singleGuarantor of taggedGuarantorWithDoc; let i = index">
                            <tbody *ngFor="let singleDoc of singleGuarantor.docPath.split(','); let j = index">
                                <tr *ngIf="singleDoc">
                                    <td>{{i + 1}}.{{j + 1}}</td>
                                    <td class="text-left pl-1">{{singleGuarantor?.name}}</td>
                                    <td>{{singleDoc.substring(singleDoc.lastIndexOf('/') + 1, singleDoc.length)}}</td> -->

            <!-- Preview Document -->
            <!-- <td *ngIf="!hidePreviewButton">
                                        <i (click)="previewOfferLetterDocument(singleDoc,singleGuarantor?.name + 'Net Worth Doc')"
                                            class="fas fa-eye"></i>
                                    </td> -->

            <!-- Download Document -->
            <!-- <td *ngIf="!hidePreviewButton">
                                        <i (click)="downloadCustomerDocument(singleDoc, singleGuarantor?.name+' Net Worth Doc')"
                                           aria-hidden="true" class="fa fa-download" style="cursor: pointer"></i>
                                    </td>
                                </tr>
                            </tbody>
                        </ng-container>
                    </table>
                </div>
            </div>
            <div *ngIf="minOneInsuranceDoc" class="row disable-print">
                <div class="col-md-12">
                    <p><strong>Insurance Documents</strong></p>
                    <table class="table table-condensed table-bordered table-sm sb-small text-center">
                        <thead>
                            <tr class="text-white sb-bg-dark">
                                <th>S.N</th>
                                <th>Policy Number</th>
                                <th>Company</th>
                                <th>Document</th>
                                <th *ngIf="!hidePreviewButton">Preview</th>
                                <th *ngIf="!hidePreviewButton">Download</th>
                            </tr>
                        </thead>
                        <ng-container *ngFor="let singleInsurance of insuranceWithDoc; let i = index">
                            <tbody
                                *ngFor="let singleDoc of singleInsurance.policyDocumentPath.split(','); let j = index">
                                <tr *ngIf="singleDoc">
                                    <td>{{i + 1}}.{{j + 1}}</td>
                                    <td class="text-left pr-1">{{singleInsurance?.policyNumber}}</td>
                                    <td class="text-left pl-1">{{singleInsurance?.company}}</td>
                                    <td class="text-left pl-1">
                                        {{singleDoc.substring(singleDoc.lastIndexOf('/') + 1, singleDoc.length)}}</td> -->

            <!-- Preview Document -->
            <!-- <td *ngIf="!hidePreviewButton">
                                        <i (click)="previewOfferLetterDocument(singleDoc,singleInsurance?.policyNumber+' Insurance Policy Document')"
                                            class="fas fa-eye"></i>
                                    </td> -->

            <!-- Download Document -->
            <!-- <td *ngIf="!hidePreviewButton">
                                        <i (click)="downloadCustomerDocument(singleDoc, singleInsurance?.policyNumber+' Insurance Policy Document')"
                                           aria-hidden="true" class="fa fa-download" style="cursor: pointer"></i>
                                    </td>
                                </tr>
                            </tbody>
                        </ng-container>
                    </table>
                </div>
            </div> -->

            <!-- <div class="print-only">
                <div *ngIf="loanDataHolder?.customerDocument?.length > 0" class="row ">
                    <div class="col-md-12">
                        <p><strong>Loan Documents</strong></p>
                    </div>
                    <div class="col-md-12">
                        <table class="table table-condensed table-bordered table-sm sb-small text-center">
                            <thead>
                                <tr class="text-white sb-bg-dark">
                                    <th>S.N</th>
                                    <th>Document</th>
                                    <th>Checked</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let singleDoc of loanDataHolder?.customerDocument; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td class="text-left pl-1">{{singleDoc?.document?.name}}</td>
                                    <td>
                                        <i class="fas fa-check" *ngIf="singleDoc?.documentPath"></i>
                                        <i class="fas fa-times" *ngIf="!singleDoc?.documentPath"></i>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div *ngIf="loanDataHolder?.loanHolder?.customerGeneralDocuments?.length > 0 " class="row ">
                    <div class="col-md-12">
                        <table class="table table-condensed table-bordered table-sm sb-small text-center">

                            <tr class="text-white sb-bg-dark">
                                <th colspan="4"> Customer General Document</th>
                            </tr>
                            <tr class="text-white sb-bg-dark">
                                <th>S.N</th>
                                <th>Document</th>
                                <th>Checked</th>
                            </tr>
                            <tr
                                *ngFor="let generalDoc of loanDataHolder?.loanHolder?.customerGeneralDocuments; let i=index">
                                <td>{{i + 1}}</td>
                                <td class="text-left pl-1">{{generalDoc?.document?.displayName}}</td>
                                <td>
                                    <i class="fas fa-check" *ngIf="generalDoc?.docPath"></i>
                                    <i class="fas fa-times" *ngIf="!generalDoc?.docPath"></i>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div *ngIf="minOneGuarantorDoc" class="row">
                    <div class="col-md-12">
                        <p><strong>Guarantor Documents</strong></p>
                        <table class="table table-condensed table-bordered table-sm sb-small text-center">
                            <thead>
                                <tr class="text-white sb-bg-dark">
                                    <th>S.N</th>
                                    <th>Guarantor</th>
                                    <th>Document</th>
                                    <th>Checked</th>
                                </tr>
                            </thead>
                            <tbody *ngFor="let singleDoc of taggedGuarantorWithDoc; let i = index">
                                <tr *ngIf="singleDoc?.docPath">
                                    <td>{{i + 1}}</td>
                                    <td class="text-left pl-1">{{singleDoc?.name}}</td>
                                    <td class="text-left pl-1">Net Worth Document</td>
                                    <td>
                                        <i class="fa fa-check" *ngIf="singleDoc?.docPath"></i>
                                        <i class="fa fa-times" *ngIf="!singleDoc?.docPath"></i>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div *ngIf="minOneInsuranceDoc" class="row ">
                    <div class="col-md-12">
                        <p><strong>Insurance Documents</strong></p>
                        <table class="table table-condensed table-bordered table-sm sb-small text-center">
                            <thead>
                                <tr class="text-white sb-bg-dark">
                                    <th>S.N</th>
                                    <th>Policy Number</th>
                                    <th>Company</th>
                                    <th>Document</th>
                                    <th>Checked</th>
                                </tr>
                            </thead>
                            <tbody *ngFor="let singleDoc of insuranceWithDoc; let i = index">
                                <tr *ngIf="singleDoc.policyDocumentPath">
                                    <td>{{i + 1}}</td>
                                    <td class="text-left pr-1">{{singleDoc?.policyNumber}}</td>
                                    <td class="text-left pl-1">{{singleDoc?.company}}</td>
                                    <td class="text-left pl-1">Insurance Policy</td>
                                    <td>
                                        <i class="fa fa-check" *ngIf="singleDoc?.policyDocumentPath"></i>
                                        <i class="fa fa-times" *ngIf="!singleDoc?.policyDocumentPath"></i>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngIf="loanDataHolder?.cadDocument?.length > 0  && showCadDoc" class="row disable-print">
                <div class="col-md-12">
                    <p><strong>Cad Documents</strong></p>
                    <table class="table table-condensed table-bordered table-sm sb-small text-center">
                        <thead class="text-white sb-bg-dark">
                            <tr>
                                <th>S.N</th>
                                <th>Document</th>
                                <th>Preview</th>
                                <th>Download</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let singleDoc of loanDataHolder?.cadDocument; let i = index">
                                <td>{{i + 1}}</td>
                                <td class="text-left pl-1">{{singleDoc?.document?.name}}</td>
                                <td>
                                    <i (click)="previewOfferLetterDocument(singleDoc?.documentPath, singleDoc?.document?.name)"
                                        class="fas fa-eye"></i>
                                </td>
                                <td>
                                    <i (click)="downloadCustomerDocument(singleDoc?.documentPath, singleDoc?.document?.name)"
                                        aria-hidden="true" class="fa fa-download" style="cursor: pointer"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <div class="row justify-content-end px-3 disable-print">{{docMsg}}</div>
            <app-proposal-terms-and-condition-summery *ngIf="loanDataHolder && customerAllLoanList"
                [customerAllLoanList]="customerAllLoanList" [loanDataHolder]="loanDataHolder">
            </app-proposal-terms-and-condition-summery>

            <div class="row mt-3">
                <div class="col-md-12">
                    <p><strong>Authority Section</strong></p>
                    <table
                        class="table table-condensed table-bordered table-responsive-md text-center table-sm sb-small">
                        <thead>
                            <tr class="sb-bg-dark text-white">
                                <th>S.N</th>
                                <th>Date</th>
                                <th>From User</th>

                                <th>To User</th>

                                <th>Status</th>
                                <th class="cmt-width">Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let previousList of loanDataHolder?.previousList ; let i = index">
                                <td>{{i + 1}}</td>
                                <td class="text-left pl-1">
                                    {{previousList?.lastModifiedAt | date}}
                                    ({{previousList?.lastModifiedAt | engNepDate: false}})
                                </td>
                                <td class="text-left">
                                    <div class="pl-1">
                                        {{previousList?.fromUser?.name}}</div>
                                    <div class="pl-1">
                                        <span>({{previousList?.fromRole?.roleName}})</span>
                                    </div>
                                </td>

                                <td class="text-left">
                                    <div class="pl-1">
                                        {{previousList?.toUser?.name}}</div>
                                    <div class="pl-1">
                                        ({{previousList?.toRole?.roleName}})
                                    </div>
                                </td>

                                <td class="text-left pl-1">{{previousList?.docAction | loanStatusPipe }}</td>
                                <td class="text-left">
                                    <div class="pl-1 disable-print" [innerHTML]="customSafePipe(
                                    previousList?.comment?.length > 50 ?
                                    previousList?.comment?.substring(0, 49) :
                                    previousList?.comment)">
                                    </div>
                                    <a (click)="open(previousList?.comment)" *ngIf="previousList?.comment?.length > 50"
                                        class="text-left pl-1 disable-print">read more ....</a>
                                    <div>
                                        <span class="pl-1 print-only justify-content"
                                            [innerHTML]="previousList?.comment | safeHtml"></span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>{{currentIndex + 1}}</td>
                                <td class="text-left pl-1">{{loanDataHolder?.currentStage?.lastModifiedAt | date}}
                                    ({{loanDataHolder?.currentStage?.lastModifiedAt | engNepDate: false}})</td>
                                <td class="text-left">
                                    <div class="pl-1">
                                        {{loanDataHolder?.currentStage?.fromUser?.name}}</div>
                                    <div class="pl-1">
                                        <span>({{loanDataHolder?.currentStage?.fromRole?.roleName}})</span>
                                    </div>
                                </td>

                                <td class="text-left">
                                    <div class="pl-1">
                                        {{loanDataHolder?.currentStage?.toUser?.name}}</div>
                                    <div class="pl-1">
                                        <span>({{loanDataHolder?.currentStage?.toRole?.roleName}})</span>
                                    </div>
                                </td>

                                <td class="text-left pl-1">{{loanDataHolder?.currentStage?.docAction | loanStatusPipe }}
                                </td>
                                <td class="text-left">
                                    <div class="pl-1 disable-print">
                                        <span [innerHTML]="customSafePipe(loanDataHolder?.currentStage?.comment?.length > 50 ?
                                    loanDataHolder?.currentStage?.comment?.substring(0, 49) :
                                    loanDataHolder?.currentStage?.comment)"></span>
                                    </div>
                                    <a (click)="open(loanDataHolder.currentStage.comment)"
                                        *ngIf="loanDataHolder?.currentStage?.comment?.length > 50"
                                        class="text-left pl-1 disable-print">read more ....</a>
                                    <div>
                                        <span class="pl-1 print-only text-justify pr-1"
                                            [innerHTML]="loanDataHolder?.currentStage?.comment | safeHtml"></span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <app-signature-section [loanDataHolder]="loanDataHolder"></app-signature-section>

            <div *ngIf="loanDataHolder?.customerOfferLetter" class="row justify-content-between pt-5 disable-print"
                id="offerLetterDiv">
                <div class="col-md-12">
                    <p><strong>Offer Letter Authority Section</strong></p>
                </div>
                <div class="col-md-12">
                    <table
                        class="table table-condensed table-bordered table-responsive-md text-center sb-small table-sm">
                        <thead>
                            <tr class="text-white sb-bg-dark">
                                <th>S.N</th>
                                <th>From User</th>
                                <th>From Position</th>
                                <th>To User</th>
                                <th>To Position</th>
                                <th>Status</th>
                                <th class="cmt-width">Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr
                                *ngFor="let previousList of loanDataHolder?.customerOfferLetter?.previousList ; let i = index">
                                <td>{{i + 1}}</td>
                                <td class="text-left pl-1">{{previousList?.fromUser?.name}}</td>
                                <td class="text-left pl-1">{{previousList?.fromRole?.roleName}}</td>
                                <td class="text-left pl-1">{{previousList?.toUser?.name}}</td>
                                <td class="text-left pl-1">{{previousList?.toRole?.roleName}}</td>
                                <td class="text-left pl-1">{{previousList?.docAction}}</td>
                                <td class="text-left">
                                    <div class="pl-1">
                                        <span [innerHTML]="customSafePipe(previousList?.comment?.length > 50 ?
                                    previousList?.comment?.substring(0, 49) :
                                    previousList?.comment)"></span>
                                    </div>
                                    <a (click)="open(previousList?.comment)" *ngIf="previousList?.comment?.length > 50"
                                        class="text-left pl-1 read-margin">read more ....</a>
                                </td>
                            </tr>
                            <tr>
                                <td>{{loanDataHolder?.customerOfferLetter?.previousList?.length + 1}}</td>
                                <td class="text-left pl-1">
                                    {{loanDataHolder?.customerOfferLetter?.offerLetterStage?.fromUser?.name}}</td>
                                <td class="text-left pl-1">
                                    {{loanDataHolder?.customerOfferLetter?.offerLetterStage?.fromRole?.roleName}}</td>
                                <td class="text-left pl-1">
                                    {{loanDataHolder?.customerOfferLetter?.offerLetterStage?.toUser?.name}}</td>
                                <td class="text-left pl-1">
                                    {{loanDataHolder?.customerOfferLetter?.offerLetterStage?.toRole?.roleName}}</td>
                                <td class="text-left pl-1">
                                    {{loanDataHolder?.customerOfferLetter?.offerLetterStage?.docAction}}</td>
                                <td class="text-left">
                                    <div class="pl-1">
                                        {{loanDataHolder?.customerOfferLetter?.offerLetterStage?.comment?.length > 50 ?
                                    loanDataHolder?.customerOfferLetter?.offerLetterStage?.comment?.substring(0, 49)
                                    :
                                    loanDataHolder?.customerOfferLetter?.offerLetterStage?.comment}}
                                    </div>
                                    <a (click)="open(loanDataHolder.customerOfferLetter?.offerLetterStage.comment)"
                                        *ngIf="loanDataHolder?.customerOfferLetter?.offerLetterStage?.comment?.length > 50"
                                        class="text-left pl-1 read-margin">read more ....</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div *ngIf="offerLetterDocuments.length>0" class="row disable-print">
                <div class="col-md-12">
                    <p><strong>Offer Letter Documents</strong></p>
                    <table
                        class="table table-condensed table-bordered table-responsive-md table-sm sb-small text-center">
                        <thead>
                            <tr class="text-white sb-bg-dark">
                                <th>S.N</th>
                                <th>Document</th>
                                <th>Preview</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let offerLetterDocument of offerLetterDocuments; let i = index">
                                <td>{{i + 1}}</td>
                                <td class="text-left pl-1">{{offerLetterDocument?.name}}</td>
                                <td><i (click)="previewOfferLetterDocument(offerLetterDocument.url, offerLetterDocument.name)"
                                        aria-hidden="true" class="fa fa-eye" style="cursor: pointer"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div> -->
        </nb-card-body>
    </nb-card>
</section>
