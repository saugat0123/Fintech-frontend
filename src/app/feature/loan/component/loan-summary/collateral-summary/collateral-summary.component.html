<div class="row mt-1">
    <div class="col-md-12 sb-small">
        <p><strong>Collateral Details</strong></p>
    </div>
</div>
<div class="row mb-2">
    <div class="col-md-12">
        <table
                class="table table-bordered table-responsive-md table-sm sb-small text-center">
            <thead>
            <tr class="sb-bg-dark text-white">
                <th>S.N</th>
                <th>Loan Facility</th>
                <th>Proposed Limit</th>
                <th>Type</th>
                <th>Created On</th>
                <th>Collateral Req%</th>
                <th>Required Collateral</th>
            </tr>
            </thead>
            <tbody>
            <tr class="sb-bg-secondary text-white">
                <td></td>
                <td>Funded</td>
                <td>{{proposalUtil.calculateTotalFromProposalList(loanDataKey.PROPOSE_LIMIT, fundedList) | currencyFormatter}}</td>
                <td colspan="3">
                <td>{{calculateRequiredCollateral(fundedList) | currencyFormatter}}</td>
            </tr>
            <ng-container *ngFor="let model of fundedList; let i=index">
                <tr class="cursor">
                    <td>{{i + 1}}</td>
                    <td>{{model?.loan?.name}}</td>
                    <td class="text-right">{{(model?.proposal?.proposedLimit | number)
                    || 0}}</td>
                    <td>{{loanType[model?.loanType] || model?.loanType}}</td>
                    <td>{{model?.createdAt | date}}</td>
                    <td>{{model?.proposal?.collateralRequirement}}</td>
                    <td> {{(model?.loan?.collateralRequirement * model?.proposal?.proposedLimit) / 100 |currencyFormatter}}
                    </td>
                </tr>
            </ng-container>
            <tr class="sb-bg-secondary text-white">
                <td></td>
                <td>Non Funded</td>
                <td>{{proposalUtil.calculateTotalFromProposalList(loanDataKey.PROPOSE_LIMIT, nonFundedList) | currencyFormatter}}</td>
                <td colspan="3"></td>
                <td>{{calculateRequiredCollateral(nonFundedList) | currencyFormatter}}</td>
            </tr>
            <ng-container *ngFor="let model of nonFundedList; let i=index">
                <tr class="cursor">
                    <td>{{i + 1}}</td>
                    <td>{{model?.loan?.name}}</td>
                    <td class="text-right">{{(model?.proposal?.proposedLimit | number)
                    || 0}}</td>
                    <td>{{loanType[model?.loanType] || model?.loanType}}</td>
                    <td>{{model?.createdAt | date}}</td>
                    <td>{{model?.loan?.collateralRequirement}}</td>
                    <td>
                        {{(model?.loan?.collateralRequirement * model?.proposal?.proposedLimit) / 100 |currencyFormatter}}
                    </td>
                </tr>
            </ng-container>
            <tr class="sb-bg-secondary text-white">
                <td></td>
                <td>Total</td>
                <td>{{setField('totalProposedAmount' , proposalUtil.calculateTotalFromProposalList(loanDataKey.PROPOSE_LIMIT, customerAllLoanList)) | currencyFormatter}}</td>
                <td colspan="3"></td>
                <td>{{setField('totalRequiredCollateral' , calculateRequiredCollateral(customerAllLoanList)) | currencyFormatter}}</td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="col-md-2 sb-small">
        <mark class="alert-warning">Total Required Collateral:</mark>
        <strong>Rs.{{totalRequiredCollateral| currencyFormatter}}</strong>
    </div>
    <div class="col-md-2 sb-small">
        <mark class="alert-warning">Total FMV/Considered Value:</mark>
        <strong>Rs.{{security?.totalSecurityAmount |currencyFormatter}}</strong>
    </div>
    <div class="col-md-2 sb-small">
        <mark class="alert-warning">Deficit/(Surplus):</mark>
        <strong> Rs. {{security?.totalSecurityAmount - totalRequiredCollateral |currencyFormatter}}</strong>
    </div>
    <div  class="col-md-2 sb-small">
        <mark class="alert-warning">Coverage%:</mark>
        <strong>{{(security?.totalSecurityAmount/totalRequiredCollateral)*100 |roundvalue |currencyFormatter}}%</strong>
    </div>
</div>
