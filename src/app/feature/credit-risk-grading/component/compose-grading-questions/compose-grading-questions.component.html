<nb-card>
    <nb-card-header>
        <nb-select (selectedChange)="onChangeLoan($event)" placeholder="Please select a loan scheme">
            <nb-option *ngFor="let scheme of schemeList; "
                       [value]="scheme?.id">{{scheme?.name}}</nb-option>
            <nb-option>GENERAL LOAN</nb-option>
        </nb-select>
    </nb-card-header>
    <nb-card-body>
        <form [formGroup]="questionAnswerForm">
            <div *ngIf="loanConfigId != null && newQuestionList" class="box-body">
                <div formArrayName="questionForm">
                    <div *ngFor="let qsn of questionAnswerForm.get('questionForm')['controls']; let i = index;"
                         class="form-group">

                        <fieldset class="border border-primary rounded p-2">
                            <legend class="w-auto"><h4>Question {{i + 1}}:</h4></legend>
                            <div [formGroupName]="i">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label>Question Description:</label>
                                        <input nbInput fullWidth formControlName="description" placeholder="Question description"
                                               type="text">
                                    </div>
                                    <div class="col-md-3">
                                        <label>Risk Group</label>
                                        <nb-select fullWidth formControlName="riskGroup" placeholder="Risk Group">
                                            <nb-option *ngFor="let risk of riskGroupArray" [value]="risk"> {{risk}} </nb-option>
                                        </nb-select>
                                    </div>
                                    <div class="col-md-2">
                                        <label>Appearance order:</label>
                                            <input nbInput fullWidth formControlName="appearanceOrder" placeholder="Appearance order"
                                                   type="number">
                                    </div>
                                    <div class="col-md-1">
                                        <button (click)="deleteQuestionField(i)" class="btn btn-danger mt-4">
                                            <em class="fa fa-trash" style="color:white;"></em>
                                        </button>
                                    </div>
                                </div>
                                <div formArrayName="answers">
                                    <div *ngFor="let ans of qsn.get('answers')['controls']; let j = index;"
                                         class="form-group">

                                        <fieldset class="border border-info rounded p-2 bg-light">
                                            <legend class="w-auto"><h4>Answer {{j + 1}}:</h4></legend>
                                            <div [formGroupName]="j">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <label>Answer:</label>
                                                        <input class="form-control"
                                                               formControlName="description">
                                                    </div>

                                                    <div class="col-md-6">
                                                        <label>Points:</label>
                                                        <div class="input-group mb-3">
                                                            <input class="form-control" formControlName="points"
                                                                   type="number">
                                                            <div class="input-group-append">
                                                                <button (click)="deleteAnswerField(qsn.controls.answers, j)"
                                                                        class="btn btn-danger btn-sm">
                                                                    Delete answer field
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </fieldset>


                                    </div>
                                    <div class="row mt-2 mb-3 pr-3">
                                        <div class="col-md-6 float-left">
                                            <button (click)="addAnswerField(qsn.controls.answers)"
                                                    class="btn btn-info btn-sm float-left">
                                                Add Answer field
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </fieldset>

                    </div>
                </div>

                <div class="row mt-2">
                    <div class="col-md-12 float-right">
                        <button (click)="addQuestionField()" class="btn btn-info float-right">
                            Add Question field
                        </button>
                    </div>
                </div>

                <hr>

                <div class="row">
                    <div class="col-md-12 text-center">
                        <button (click)="onSave()" class="btn btn-success" type="submit">
                            Save
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </nb-card-body>
</nb-card>
