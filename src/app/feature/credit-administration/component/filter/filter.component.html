<div class="row pt-2">
  <div class="col-md-6">
    <div class="btn-group">
      <button
          (click)="isFilterCollapsed = !isFilterCollapsed"
          [attr.aria-expanded]="!isFilterCollapsed" aria-controls="searchModel"
          nbButton
          shape="rectangle"
          size="small"
          status="primary">
        <em class="fa fa-filter"> Filter</em>
      </button>

    </div>
  </div>

  <div class="col-md-6 d-flex justify-content-end">
    <!--      <button (click)="openReport()" nbButton outline-->
    <!--              status="success" size="small" *ngIf="fromCadDashboard">-->
    <!--        <i aria-hidden="true" class="fas fa-file"></i></button>&nbsp;-->
    <div>
      <button *ngIf="role[currentRoleType] === role.CAS_MAKER && !loanpull && docStatus ==='OFFER_PENDING'" nbButton size="tiny"
              nbTooltip="Add new customer"
              (click)="openTemplate(chooseCusType)"><em
          class="fa fa-plus"></em></button>
    </div>
    <button (click)="getReport()" nbButton outline
            status="info" size="small">
      <i aria-hidden="true" class="fa fa-download"></i></button>
  </div>

  <div [ngbCollapse]="isFilterCollapsed" class="col-md-12" id="searchModel">
    <form [formGroup]="filterForm">
      <div class="row py-3">
        <div class="col-md-3 mb-3">
          <label class="form-group">From Date</label>
          <input class="form-control rounded" formControlName="fromDate" type="Date" placeholder="From Date">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-group">To Date</label>
          <input class="form-control rounded" formControlName="toDate" type="Date" placeholder="To Date">
        </div>
        <div class="col-md-3 mb-3" *ngIf="isAdminRole">
          <label class="form-group">Province</label>
          <ng-select formControlName="provinceIds" placeholder="Select Province">
            <ng-option *ngFor="let province of provinceList"
                       [value]="province.id">{{province.name}}</ng-option>
          </ng-select>
        </div>
        <div class="col-md-3 mb-3" *ngIf="!branchAccessIsOwn">
          <label class="form-group">Branch</label>
          <ng-select formControlName="branchIds" placeholder="Select Branches">
            <ng-option *ngFor="let branch of branchList"
                       [value]="branch.id">{{branch.name}}</ng-option>
          </ng-select>
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-group">Customer Name</label>
          <input class="form-control rounded" formControlName="name" id="customerName"
                 placeholder="Enter Customer Name">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-group">Loan Type</label>
          <ng-select formControlName="customerType" placeholder="Loan Type">
            <ng-option value="INSTITUTION">INSTITUTION</ng-option>
            <ng-option value="INDIVIDUAL">INDIVIDUAL</ng-option>
          </ng-select>
        </div>
        <div class="col-md-3 mb-3" *ngIf="showPossessionUnder">
          <label class="form-group">Current Possession Under</label>
          <select class="form-control rounded" formControlName="toRole" id="toRole">
            <option [ngValue]="null">Select Role</option>
            <option [ngValue]="role.id"
                    *ngFor="let role of possessionRoleList">{{role?.roleName}}</option>
          </select>
        </div>
        <div class="col-md-3 mb-3" *ngIf="fromCadDashboard">
          <label class="form-group">Document Status</label>
          <select class="form-control rounded" formControlName="docStatus" id="docStatus">
            <option [ngValue]="null" hidden>Select Document Status</option>
            <option ngValue="OFFER_AND_LEGAL_PENDING">Offer and Legal Pending</option>
            <option ngValue="OFFER_AND_LEGAL_APPROVED">Offer and Legal Approved</option>
            <!--<option *ngFor="let status of cadDocStatus"
                    [ngValue]="status">{{status | replace:'_':' ' | titlecase}}
            </option>-->
          </select>
        </div>


      </div>
      <div class="col-md-12 p-0">
        <button (click)="onSearch()" class="mr-2" nbButton
                shape="rectangle"
                size="small"
                status="info">Search
        </button>
        <button (click)="clear()" nbButton shape="rectangle" size="small" status="danger"
                type="button">Clear
        </button>
      </div>
    </form>
  </div>
</div>

<ng-template #chooseCusType>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Choose Customer Type</h4>
    <a (click)="onClose()" aria-label="Close" class="close pull-right cursor">
      <span aria-hidden="true">&times;</span>
    </a>
  </div>
  <div class="modal-body">

    <div class="row">
      <div class="col-md-12">
        <div class="form-group">
          <ng-select [(ngModel)]="createClientType" placeholder="Select Customer Type" required>
            <ng-option [value]="customerType.INSTITUTION">INSTITUTION</ng-option>
            <ng-option [value]="customerType.INDIVIDUAL">PERSONAL</ng-option>
          </ng-select>
        </div>
        <div class="form-group" *ngIf="createClientType === customerType.INDIVIDUAL">
          <ng-select [(ngModel)]="createSubClientType"
                     placeholder="Select Personal Customer Type" required>
            <ng-option [value]="subCustomerType.JOINT">JOINT</ng-option>
            <ng-option [value]="subCustomerType.PERSONAL">INDIVIDUAL</ng-option>
          </ng-select>
        </div>
        <div class="form-group"
             *ngIf="createClientType === customerType.INDIVIDUAL && createSubClientType === subCustomerType.JOINT">
          <input [(ngModel)]="jointCustomerNum"
                 class="form-control"
                 min="2"
                 type="number"
                 placeholder="Number of joint customer"
                 required>
        </div>

        <div class="form-group"
             *ngIf="createClientType === customerType.INSTITUTION">
          <ng-select
                  [(ngModel)]="createSubInstituteType"
                     placeholder="Select Institution Customer Type"
                  required>
            <ng-option [value]="subCustomerType.PRIVATE_PUBLIC">PVT LTD OR PUBLIC</ng-option>
            <ng-option [value]="subCustomerType.PROPRIETORSHIP">PROPRIETORSHIP</ng-option>
            <ng-option [value]="subCustomerType.PARTNERSHIP">PARTNERSHIP</ng-option>
          </ng-select>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-success float-right" nbButton size="small"
            (click)="getForm();onClose()">Next
    </button>
  </div>
</ng-template>

<app-overlay-spinner></app-overlay-spinner>
