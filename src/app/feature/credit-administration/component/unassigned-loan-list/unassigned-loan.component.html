<nb-card [nbSpinner]="spinner" accent="primary">
    <nb-card-header>
        <div class="row">
            <div class="col-md-12">
                <app-filter (eventEmitter)="setSearchValue($event)"></app-filter>
            </div>
        </div>
        <h6 class="text-center">Approved Loan List</h6>
    </nb-card-header>
    <nb-card-body>
        <table id="unassign-loan"
               class="table table-bordered table-hover table-sm sb-small text-center ">
            <thead>
            <tr class="text-white sb-bg-dark">
                <th>S.N</th>
                <th>Branch</th>
                <th>Customer Name</th>
                <th>Type</th>
                <th>ID Number</th>
                <th>ID Reg Place</th>
                <th>Approved Loan</th>

                <th>Action</th>


            </tr>
            </thead>
            <tbody>
            <ng-container *ngFor="let model of loanList;let i=index">
                <tr class="cursor">
                    <td>{{(pageable.number - 1) * pageable.size + i + 1}}</td>
                    <td>{{model?.branch?.name}}</td>
                    <td>{{model?.name}}</td>
                    <td>{{model?.customerType}}</td>
                    <td>{{model?.idNumber}}</td>
                    <td>{{model?.idRegPlace}}</td>
                    <td>{{model?.totalLoan}}</td>
                    <td>
                        <a class="px-2" (click)="model?.id ? toggleArray[i].toggled = !toggleArray[i].toggled:''"
                           nbTooltip="click to view detail Loan ">
                            <em class="fa fa-eye"></em>
                        </a>
                        <a (click)="openAssignPopUp(model)" *ngIf="model?.totalLoan > 0"
                           nbTooltip="click to assign"><em
                                class="fa fa-user"></em></a>
                    </td>


                </tr>
                <ng-container *ngIf="toggleArray[i].toggled">

                    <tr class="text-white sb-bg-dark"
                        *ngIf="model?.customerLoanDtoList?.length > 1 ">
                        <td colspan="1">SN</td>
                        <td>Loan Facility</td>
                        <td>Proposed Amount</td>

                    </tr>
                    <tr class=" text-center"
                        *ngFor="let data of model?.customerLoanDtoList;let j=index">
                        <td>{{j + 1}}</td>
                        <td>{{data?.loan?.name}}</td>
                        <td>{{data?.proposal?.proposedLimit}}</td>
                    </tr>
                    <tr class="sb-bg-dark">
                        <td colspan="9">.</td>
                    </tr>

                </ng-container>

            </ng-container>
            </tbody>
        </table>
        <!-- ===================table-pagination==================== -->
        <app-paging *ngIf="!spinner" [pageable]="pageable" (changePage)="changePage($event)"></app-paging>
        <!-- ===================table-pagination==================== -->

    </nb-card-body>
</nb-card>
