<nb-card [nbSpinner]="spinner" class="px-3">
    <nb-card-header class="px-2 cursor">
        <h3>Edit Personal Loan Data</h3>
        <a class="d-flex justify-content-end font-weight-bold text-dark" (click)="ngDialogRef.close()" style="margin-top:-2em">x</a>
    </nb-card-header>
    <div>
        <form [formGroup]="form">
            <div class="row pt-3 pl-2">
                <div class="col-md-12 pt-3 pl-2">
                    <nb-checkbox #limitCheck (change)="loanChecked(limitCheck.checked)" [checked]="loanLimit"><i>Customer has total loan amount above One Crore</i></nb-checkbox>
                </div>
            </div>
            <div class="row mt-5 px-5">
                <table class="table table-borderless text-center sb-small table-sm">
                    <tr>
                        <th></th>
                        <th>Loan Data</th>
                        <th>Nepali Translation</th>
                        <th>Correct Translation</th>
                    </tr>
                    <tr>
                        <td>Date Of Approval</td>
                        <td>
                            <div class="row" style="margin-left: 5px; margin-top: -8px;">
                                <nb-radio-group name="dateOfApproval" formControlName="dateOfApprovalType">
                                    <nb-radio (click)="setDateTypeBS()" value="BS"><span style="margin-left:-60px">BS</span></nb-radio>
                                    <nb-radio (click)="setDateTypeAD()" value="AD" style="margin-left: 60px;margin-top: -35px;">AD</nb-radio>
                                </nb-radio-group>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        </td>
                        <td>
                            <nepali-patro *ngIf="dateTypeBS" formControlName="dateOfApprovalNepali" [responseType]="2"
                                          [displayNepali]="true">
                            </nepali-patro>
                            <input [nbDatepicker]="doa"
                                   *ngIf="dateTypeAD"
                                   class="form-control form-control-sm-error rounded"
                                   formControlName="dateOfApproval"
                                   id="dateOfApproval"
                                   name="dateOfApproval"
                                   placeholder="Date of Approval"
                                   type="text">
                            <nb-datepicker #doa></nb-datepicker>
                        </td>
                    </tr>
<!--                    <tr>-->
<!--                        <td>Reference Number</td>-->
<!--                        <td><input type="text" class="form-control" formControlName="refNumber"/></td>-->
<!--                        <td class="abc">{{translatedData ? translatedData?.refNumber : initialInformation?.refNumber?.ct}}</td>-->
<!--                        <td>-->
<!--                            <input type="text" class="form-control"-->
<!--                                   [ngClass]="{ 'is-invalid':submitted && Form.refNumberTransVal.errors }"-->
<!--                                   formControlName="refNumberTransVal"/>-->
<!--                            <div *ngIf="submitted && Form.refNumberTransVal.errors"-->
<!--                                 class="invalid-feedback">-->
<!--                                <div *ngIf="Form.refNumberTransVal.errors.required">Reference number is required</div>-->
<!--                            </div>-->
<!--                        </td>-->
<!--                    </tr>-->
                    <tr style="padding: 12px">
                        <td>Date Of Application</td>
                        <td>
                            <div class="row" style="margin-left: 5px; margin-top: -8px;">
                                <nb-radio-group name="dateofApplication" formControlName="dateofApplicationType">
                                    <nb-radio (click)="setDateTypeBS1()" value="BS"><span style="margin-left:-60px">BS</span></nb-radio>
                                    <nb-radio (click)="setDateTypeAD1()" value="AD" style="margin-left: 60px;margin-top: -35px;">
                                        AD
                                    </nb-radio>
                                </nb-radio-group>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        </td>
                        <td>
                            <nepali-patro *ngIf="dateTypeBS1" formControlName="dateofApplicationNepali" [responseType]="2"
                                          [displayNepali]="true">
                            </nepali-patro>
                            <input [nbDatepicker]="doap"
                                   *ngIf="dateTypeAD1"
                                   class="form-control form-control-sm-error rounded"
                                   formControlName="dateofApplication"
                                   id="dateofApplication"
                                   name="dateofApplication"
                                   placeholder="Date of Application"
                                   type="text">
                            <nb-datepicker #doap></nb-datepicker>
                        </td>
                    </tr>
                    <tr>
                        <td>Purpose Of Loan</td>
                        <td><input type="text" class="form-control" formControlName="purposeOfLoan"/></td>
                        <td class="abc">{{translatedData ? translatedData?.purposeOfLoan : initialInformation?.purposeOfLoan?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.purposeOfLoanTransVal.errors }"
                                   formControlName="purposeOfLoanTransVal"/>
                            <div *ngIf="submitted && Form.purposeOfLoanTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.purposeOfLoanTransVal.errors.required">Purpose of loan is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Base Rate</td>
                        <td><input type="text" class="form-control" formControlName="baseRate" (input)="calInterestRate()"/></td>
                        <td class="abc">{{translatedData ? translatedData?.baseRate : initialInformation?.baseRate?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.baseRateTransVal.errors }"
                                   formControlName="baseRateTransVal"/>
                            <div *ngIf="submitted && Form.baseRateTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.baseRateTransVal.errors.required">Base rate is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Premium Rate</td>
                        <td><input type="text" class="form-control" formControlName="premiumRate" (input)="calInterestRate()"/></td>
                        <td class="abc">{{translatedData ? translatedData?.premiumRate : initialInformation?.premiumRate?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.premiumRateTransVal.errors }"
                                   formControlName="premiumRateTransVal"/>
                            <div *ngIf="submitted && Form.premiumRateTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.premiumRateTransVal.errors.required">Premium rate is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Interest Rate</td>
                        <td><input type="text" class="form-control" formControlName="yearlyFloatingInterestRate"/></td>
                        <td class="abc">{{translatedData ? translatedData?.yearlyFloatingInterestRate : initialInformation?.yearlyFloatingInterestRate?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.yearlyFloatingInterestRateTransVal.errors }"
                                   formControlName="yearlyFloatingInterestRateTransVal"/>
                            <div *ngIf="submitted && Form.yearlyFloatingInterestRateTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.yearlyFloatingInterestRateTransVal.errors.required">Interest rate is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Loan Admin Fee in Figures</td>
                        <td>
                            <input type="number" class="form-control"
                                   formControlName="loanAdminFee"
                                   (input)="getNumAmountWord('loanAdminFee', 'loanAdminFeeinWords')"/>
                        </td>
                        <td class="abc">{{translatedData?.loanAdminFee}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.loanAdminFeeTransVal.errors }"
                                   formControlName="loanAdminFeeTransVal"/>
                            <div *ngIf="submitted && Form.loanAdminFeeTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.loanAdminFeeTransVal.errors.required">Loan admin fee in Figures is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Loan Admin Fee in Words</td>
                        <td><input type="text" class="form-control" formControlName="loanAdminFeeinWords"></td>
                        <td class="abc">{{translatedData?.loanAdminFeeinWords}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.loanAdminFeeinWordsTransVal.errors }"
                                   formControlName="loanAdminFeeinWordsTransVal"/>
                            <div *ngIf="submitted && Form.loanAdminFeeinWordsTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.loanAdminFeeinWordsTransVal.errors.required">Loan Admin Fee in words is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Emi Amount Figure</td>
                        <td><input type="text" class="form-control"
                                   formControlName="emiAmount"
                                   (input)="getNumAmountWord('emiAmount', 'emiAmountWords');translateNumber('emiAmount', 'emiAmountTransVal')"/></td>
                        <td class="abc">{{translatedData ? translatedData?.emiAmount : initialInformation?.emiAmount?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.emiAmountTransVal.errors }"
                                   formControlName="emiAmountTransVal"/>
                            <div *ngIf="submitted && Form.emiAmountTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.emiAmountTransVal.errors.required">EMI amount is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Emi Amount Words</td>
                        <td><input type="text" class="form-control" formControlName="emiAmountWords"/></td>
                        <td class="abc">{{translatedData ? translatedData?.emiAmountWords : initialInformation?.emiAmountWords?.ct}}</td>
                        <td>
                            <input type="text" class="form-control" formControlName="emiAmountWordsTransVal"/>
                        </td>
                    </tr>
                    <tr>
                        <td>Loan Period in Months</td>
                        <td><input type="text" class="form-control"
                                   formControlName="loanPeriodInMonth"/></td>
                        <td class="abc">{{translatedData ? translatedData?.loanPeriodInMonth : initialInformation?.loanPeriodInMonth?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.loanPeriodInMonthTransVal.errors }"
                                   formControlName="loanPeriodInMonthTransVal"/>
                            <div *ngIf="submitted && Form.loanPeriodInMonthTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.loanPeriodInMonthTransVal.errors.required">EMI amount is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Name of Company</td>
                        <td><input type="text" class="form-control" formControlName="companyName"/></td>
                        <td class="abc">{{translatedData ? translatedData?.companyName : initialInformation?.companyName?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.companyNameTransVal.errors }"
                                   formControlName="companyNameTransVal"/>
                            <div *ngIf="submitted && Form.companyNameTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.companyNameTransVal.errors.required">Name of Company is required</div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td>Account Number</td>
                        <td><input type="text" class="form-control" formControlName="accountNumber"
                                   (input)="translateNumber('accountNumber', 'accountNumberTransVal')"/></td>
                        <td class="abc">{{translatedData ? translatedData?.accountNumber : initialInformation?.accountNumber?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.accountNumberTransVal.errors }"
                                   formControlName="accountNumberTransVal"/>
                            <div *ngIf="submitted && Form.accountNumberTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.accountNumberTransVal.errors.required">Account Number is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Relationship Officer Name</td>
                        <td><input type="text" class="form-control" formControlName="relationshipOfficer"/></td>
                        <td class="abc">{{translatedData ? translatedData?.relationshipOfficer : initialInformation?.relationshipOfficer?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.relationshipOfficerTransVal.errors }"
                                   formControlName="relationshipOfficerTransVal"/>
                            <div *ngIf="submitted && Form.relationshipOfficerTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.relationshipOfficerTransVal.errors.required">Relationship Officer name is required</div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Branch Manager</td>
                        <td><input type="text" class="form-control" formControlName="managerName"/></td>
                        <td class="abc">{{translatedData ? translatedData?.managerName : initialInformation?.managerName?.ct}}</td>
                        <td>
                            <input type="text" class="form-control"
                                   [ngClass]="{ 'is-invalid':submitted && Form.managerNameTransVal.errors }"
                                   formControlName="managerNameTransVal"/>
                            <div *ngIf="submitted && Form.managerNameTransVal.errors"
                                 class="invalid-feedback">
                                <div *ngIf="Form.managerNameTransVal.errors.required">Branch Manager name is required</div>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </form>
    </div>
    <nb-card-footer>
        <button [disabled]="previewBtn" size="tiny" class="float-right" nbButton (click)="openModel()" status="primary">Preview
        </button>
        <button nbButton size="tiny" status="info" (click)="submit()" class="float-right" [disabled]="btnDisable">Save</button>
        <button nbButton size="tiny" class="float-right" (click)="translate()">
            Translate
        </button>
    </nb-card-footer>
</nb-card>
