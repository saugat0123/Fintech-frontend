<div>
    <form [formGroup]="preExportForm">
        <div *ngFor="let val of termLoanNumber; let i = index" formArrayName="termLoanDetails">
            <ng-container [formGroupName]="i">
                <div class="row">
                    <div class="col-md-12 pb-2">
                        <h5 *ngIf="termLoanNumber.length === 1">PRE EXPORT LOAN </h5>
                        <h5 *ngIf="termLoanNumber.length > 1">PRE EXPORT LOAN - {{i + 1}}</h5>
                    </div>
                    <div class="col-md-4">
                        <label><strong>Drawing Power Basis</strong></label>
                        <nb-select (selectedChange)="setDrawingBasis($event)"
                                   formControlName="drawingBasis"
                                   fullWidth
                                   placeholder="Drawing Power Basis">
                            <nb-option value="MARKET_VALUE">On Basis of Market Value</nb-option>
                            <nb-option value="LETTER_OF_CREDIT">On Basis of Letter of Credit</nb-option>
                        </nb-select>
                    </div>
                    <div class="col-md-12 mt-2">
                        <nb-checkbox #complementaryOther formControlName="complementaryOther"
                                     (change)="checkComplementaryOtherLoan($event.target.checked, i)">
                            <i> Is complimentary of other loan ? </i></nb-checkbox>
                    </div>
                    <div class="col-md-4 mt-3" *ngIf="preExportForm.get(['termLoanDetails', i, 'complementaryOther']).value">
                        <label class="font-weight-bold" for="complementaryLoanSelected"><strong>Complimentary Loan
                            Selection</strong></label><br>
                        <nb-select placeholder="Select Complimentary Loan"
                                   fullWidth
                                   formControlName="complementaryLoanSelected" id="complementaryLoanSelected"
                                   status="success">
                            <nb-option *ngFor="let loanName of loanDetails" [value]="loanName?.name">
                                {{loanName?.name === 'TOTAL LIMIT' ? loanName?.name : loanName?.name + ' - ' + loanName?.loanAmount}}
                            </nb-option>
                        </nb-select>
                    </div>
                </div>
                <div class="row pt-4">
                    <div class="col-md-4">
                        <label class="font-weight-bold" for="loanAmount">Loan Amount</label>
                        <input class="form-control" formControlName="loanAmount" fullWidth id="loanAmount"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="number">
                    </div>
                    <div class="col-md-4 form-group fieldMargin">
                        <input class="form-control" formControlName="loanAmountTrans" fullWidth id="loanAmountTrans"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                    <div class="col-md-4 form-group fieldMargin">
                        <input class="form-control" formControlName="loanAmountCT" fullWidth id="loanAmountCT"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 form-group">
                        <label class="font-weight-bold" for="loanAmountWords">Loan Amount Words</label>
                        <input class="form-control" formControlName="loanAmountWords" fullWidth id="loanAmountWords"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                    <div class="col-md-4 form-group fieldMargin">
                        <input class="form-control" formControlName="loanAmountWordsTrans" fullWidth
                               id="loanAmountWordsTrans"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                    <div class="col-md-4 form-group fieldMargin">
                        <input class="form-control" formControlName="loanAmountWordsCT" fullWidth id="loanAmountWordsCT"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 form-group">
                        <label class="font-weight-bold" for="drawingPower">Drawing Power (in %)</label>
                        <input class="form-control" formControlName="drawingPower" fullWidth id="drawingPower"
                               nbInput
                               shape="semi-round"
                               status="success" type="number">
                    </div>
                    <div class="col-md-4 form-group fieldMargin">
                        <input class="form-control" formControlName="drawingPowerTrans" fullWidth id="drawingPowerTrans"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                    <div class="col-md-4 form-group fieldMargin">
                        <input class="form-control" formControlName="drawingPowerCT" fullWidth id="drawingPowerCT"
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 form-group">
                        <label class="font-weight-bold" for="dateOfExpiryType"> Loan Expiry Date/Next Review
                            Date</label><br>
                        <nb-radio-group (valueChange)="checkDateOfExpiry($event)" class="d-inline-flex"
                                        formControlName="dateOfExpiryType" id="dateOfExpiryType"
                                        name="dateOfExpiryType" status="success">
                            <nb-radio *ngFor="let dType of dateType" [value]="dType.value">{{dType.key}}</nb-radio>
                        </nb-radio-group>
                        <div *ngIf="BSExpiry" style="margin-bottom: -50px;">
                            <nepali-patro [displayNepali]="true" [responseType]="2"
                                          formControlName="dateOfExpiryNepali">
                            </nepali-patro>
                        </div>
                        <input *ngIf="ADExpiry" [nbDatepicker]="previousDate" formControlName="dateOfExpiry"
                               fullWidth
                               id="dateOfExpiry"
                               nbInput
                               shape="semi-round"
                               placeholder="Select Date" status="success">
                        <nb-datepicker #previousDate></nb-datepicker>
                    </div>
                    <div class="col-md-4 form-group dateTranslationCustom">
                        <input class="form-control" formControlName="dateOfExpiryTrans" fullWidth id="dateOfExpiryTrans"
                               readonly
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                    <div class="col-md-4 form-group dateTranslationCustom">
                        <input class="form-control" formControlName="dateOfExpiryCT" fullWidth id="dateOfExpiryCT"
                               nbInput
                               shape="semi-round"
                               status="success" type="text">
                    </div>
                </div>
                <!-- For Translation -->
                <div class="row pt-5 pb-2 pr-4">
                    <div class="col-md-12 text-right">
                        <button (click)="translateAndSetVal(i)" nbButton outline size="small" status="info">
                            Translate Pre Export Loan Details
                        </button>
                    </div>
                </div>
            </ng-container>
        </div>
    </form>
</div>
