<nb-card>
    <nb-card-header class="container-fluid">
        <h3>Edit Kisan Loan Data </h3>
        <div class="row d-flex justify-content-end px-2 cursor text-dark font-weight-bold">
            <a (click)="close()" style="margin-top:-2em">x</a>
        </div>
    </nb-card-header>
    <nb-card-body>
        <form [nbSpinner]="spinner" [formGroup]="kisanKarjaSubsidy">
            <div class="row p-4">
                <div class="col-md-4">
                    <label><strong>Loan Options</strong></label>
                    <ng-select (ngModelChange)="transferValue($event)"
                               [multiple]="false"
                               formControlName="loanOption"
                               placeholder="Select Case Type">
                        <ng-option *ngFor="let customerLoanOption of customerLoanOptions"
                                   [value]="customerLoanOption.value">{{customerLoanOption.value}}</ng-option>
                    </ng-select>
                </div>
                <div *ngIf="isLoanOptionSelected" class="col-md-4">
                    <label><strong>Repayment Type</strong></label>
                    <ng-select
                            formControlName="repaymentType"
                            fullWidth
                            placeholder="Repayment Type">
                        <ng-option value="EMI_BASIS">EMI BASIS</ng-option>
                        <ng-option value="OTHERS">OTHERS</ng-option>
                    </ng-select>
                </div>
                <div class="col-md-12 mt-3" *ngIf="isLoanOptionSelected">
                    <nb-checkbox #interestSubsidy (checkedChange)="interestSubsidyCheck(interestSubsidy.checked)"
                                 [checked]="isInterestSubsidy">
                        <i>Is Interest Subsidy ?</i></nb-checkbox>
                </div>
                <div class="col-md-12 mt-3" *ngIf="isLoanOptionSelected">
                    <nb-checkbox #collateral (checkedChange)="collateralCheck(collateral.checked)"
                                 [checked]="isCollateral">
                        <i>With Collateral?</i></nb-checkbox>
                </div>
            </div>
            <div class="row pt-3 pl-4 pr-4">
                <div class="col-md-4">
                    <div class="col-md-12 mb-2 text-center">
                        <h5>LOAN DATA</h5>
                    </div>
                    <div class="form-group">
                        <label for="dateOfApprovalType">Date of Approval</label><br>
                        <nb-radio-group (valueChange)="dateOfApproval($event)" class="d-inline-flex"
                                        formControlName="dateOfApprovalType" id="dateOfApprovalType"
                                        name="dateOfApprovalType" status="success">
                            <nb-radio *ngFor="let dateTy of dateType" [value]="dateTy.value">{{dateTy.key}}</nb-radio>
                        </nb-radio-group>
                        <div *ngIf="BSApproval" style="margin-bottom: -50px;">
                            <nepali-patro *ngIf="BSApproval" [displayNepali]="true" [responseType]="2"
                                          formControlName="dateOfApprovalNepali">
                            </nepali-patro>
                        </div>
                        <input *ngIf="ADApproval" [nbDatepicker]="approvalDate" formControlName="dateOfApproval"
                               fullWidth
                               id="dateOfApproval"
                               nbInput
                               placeholder="Select Date" status="success">
                        <nb-datepicker #approvalDate></nb-datepicker>
                    </div>

                    <div class="form-group">
                        <label for="dateOfApplicationType">Date of Application</label><br>
                        <nb-radio-group (valueChange)="dateOfApplication($event)" class="d-inline-flex"
                                        formControlName="dateOfApplicationType" id="dateOfApplicationType"
                                        name="dateOfApplicationType" status="success">
                            <nb-radio *ngFor="let dateTy of dateType"
                                      [value]="dateTy.value">{{dateTy.key}}</nb-radio>
                        </nb-radio-group>
                        <div *ngIf="BSApplication" style="margin-bottom: -50px;">
                            <nepali-patro *ngIf="BSApplication" [displayNepali]="true"
                                          [responseType]="2"
                                          formControlName="dateOfApplicationNepali">
                            </nepali-patro>
                        </div>
                        <input *ngIf="ADApplication" [nbDatepicker]="applicationDate"
                               formControlName="dateOfApplication" fullWidth
                               id="dateOfApplication"
                               nbInput
                               placeholder="Select Application Date" status="success">
                        <nb-datepicker #applicationDate></nb-datepicker>
                    </div>

                    <div class="form-group">
                        <label for="nextReviewDateType">Next Review Date</label><br>
                        <nb-radio-group (valueChange)="nextReviewDate($event)" class="d-inline-flex"
                                        formControlName="nextReviewDateType" id="nextReviewDateType"
                                        name="nextReviewDateType" status="success">
                            <nb-radio *ngFor="let dateTy of dateType" [value]="dateTy.value">{{dateTy.key}}</nb-radio>
                        </nb-radio-group>
                        <div *ngIf="BSReview" style="margin-bottom: -50px;">
                            <nepali-patro *ngIf="BSReview" [displayNepali]="true"
                                          [responseType]="2"
                                          formControlName="nextReviewDateNepali">
                            </nepali-patro>
                        </div>
                        <input *ngIf="ADReview" [nbDatepicker]="nextReviewDatePicker" formControlName="nextReviewDate"
                               fullWidth
                               id="nextReviewDate"
                               nbInput
                               placeholder="Select Review Date" status="success">
                        <nb-datepicker #nextReviewDatePicker></nb-datepicker>
                    </div>

                    <div class="form-group" *ngIf="!isCustomerNew">
                        <label for="previousSanctionType">Previous Sanction Letter Date</label><br>
                        <nb-radio-group (valueChange)="previousSanctionDate($event)" class="d-inline-flex"
                                        formControlName="previousSanctionType" id="previousSanctionType"
                                        name="previousSanctionType" status="success">
                            <nb-radio *ngFor="let previousType of dateType" [checked]="previousType.checked"
                                      [value]="previousType.value">{{previousType.key}}</nb-radio>
                        </nb-radio-group>
                        <div *ngIf="BSPrevious" style="margin-bottom: -50px;">
                            <nepali-patro *ngIf="BSPrevious" [displayNepali]="true"
                                          [responseType]="2"
                                          formControlName="previousSanctionDateNepali">
                            </nepali-patro>
                        </div>
                        <input *ngIf="ADPrevious" [nbDatepicker]="previousDate" formControlName="previousSanctionDate"
                               fullWidth
                               id="previousSanctionDate"
                               nbInput
                               placeholder="Select Previous Date" status="success">
                        <nb-datepicker #previousDate></nb-datepicker>
                    </div>

                    <div class="form-group">
                        <label for="purposeOfLoan">Purpose of Loan</label>
                        <input class="form-control" formControlName="purposeOfLoan" fullWidth id="purposeOfLoan"
                               nbInput status="success" type="text">
                    </div>

                    <!--<div class="form-group">
                        <label for="loanAmountFigure">Loan Amount Figure</label>
                        <input (input)="getNumAmountWord('loanAmountFigure', 'loanAmountFigureWords')" class="form-control" formControlName="loanAmountFigure" fullWidth
                               id="loanAmountFigure"
                               nbInput status="success" type="text">
                    </div>

                    <div class="form-group">
                        <label for="loanAmountFigureWords">Loan Amount In Words</label>
                        <input class="form-control" formControlName="loanAmountFigureWords" fullWidth id="loanAmountFigureWords"
                               nbInput status="success" type="text">
                    </div>-->

                    <div class="form-group">
                        <label for="marginInPercentage">Margin In Percentage</label>
                        <input class="form-control" formControlName="marginInPercentage" fullWidth
                               id="marginInPercentage"
                               nbInput status="success" type="number">
                    </div>

                    <div class="form-group">
                        <label for="baseRate">Base Rate</label>
                        <input (input)="calInterestRate()" class="form-control" formControlName="baseRate" fullWidth
                               id="baseRate" nbInput status="success" type="number">
                    </div>

                    <div class="form-group">
                        <label for="premiumRate">Premium Rate</label>
                        <input (input)="calInterestRate()" class="form-control" formControlName="premiumRate" fullWidth
                               id="premiumRate" nbInput status="success" type="number">
                    </div>

                    <div class="form-group">
                        <label for="interestRate">Interest Rate (%)</label>
                        <input class="form-control" formControlName="interestRate" fullWidth id="interestRate"
                               nbInput status="success" type="number">
                    </div>

                    <div *ngIf="!isInterestSubsidy" class="form-group">
                        <label for="serviceCharge">Service Charge</label>
                        <input class="form-control" formControlName="serviceCharge" fullWidth id="serviceCharge"
                               nbInput status="success" type="number">
                    </div>

                    <div class="form-group">
                        <label for="totalTenureOfLoan">Total Tenure Of Loan</label>
                        <input class="form-control" formControlName="totalTenureOfLoan" fullWidth id="totalTenureOfLoan"
                               nbInput status="success" type="number">
                    </div>

                    <div class="form-group" *ngIf="!isInterestSubsidy">
                        <label for="commitmentFee">Total Commitment Fee (%)</label>
                        <input class="form-control" formControlName="commitmentFee" fullWidth id="commitmentFee"
                               nbInput status="success" type="number">
                    </div>

                    <div class="form-group" *ngIf="isInterestSubsidy">
                        <label for="circularRate">Rate As Per NRB Circular</label>
                        <input class="form-control" formControlName="circularRate" fullWidth id="circularRate"
                               nbInput status="success" type="number">
                    </div>

                    <div class="form-group">
                        <label for="nameOfStaff">Name of ARO/RO/RM/ARM</label>
                        <input class="form-control" formControlName="nameOfStaff" fullWidth id="nameOfStaff"
                               nbInput status="success" type="text">
                    </div>

                    <div class="form-group">
                        <label for="nameOfBranchManager">Name Of Branch Manager</label>
                        <input class="form-control" formControlName="nameOfBranchManager" fullWidth
                               id="nameOfBranchManager"
                               nbInput status="success" type="text">
                    </div>
                </div>
                <!--FOR TRANSLATION FIELD-->
                <div class="col-md-4">
                    <div class="col-md-12 mb-2 text-center">
                        <h5>TRANSLATED DATA</h5>
                    </div>

                    <div class="form-group" *ngIf="BSApproval; else dateOfApprovalField">
                        <label for="dateOfApprovalNepaliTrans">Date of Approval Translation </label>
                        <input class="form-control dateTranslationCustom" formControlName="dateOfApprovalNepaliTrans"
                               fullWidth id="dateOfApprovalNepaliTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <ng-template #dateOfApprovalField>
                        <div class="form-group">
                            <label for="dateOfApprovalTrans">Date of Approval Translation </label>
                            <input class="form-control dateTranslationCustom" formControlName="dateOfApprovalTrans"
                                   fullWidth id="dateOfApprovalTrans"
                                   nbInput status="success" type="text" readonly>
                        </div>
                    </ng-template>

                    <div class="form-group">
                        <label for="dateOfApplicationTrans">Date of Application Translation </label>
                        <ng-container *ngIf="BSApplication; else dateOfAppEnglish">
                            <input class="form-control dateTranslationCustom"
                                   formControlName="dateOfApplicationNepaliTrans" fullWidth
                                   id="dateOfApplicationNepaliTrans"
                                   nbInput status="success" type="text" readonly>
                        </ng-container>
                        <ng-template #dateOfAppEnglish>
                            <input class="form-control dateTranslationCustom" formControlName="dateOfApplicationTrans"
                                   fullWidth id="dateOfApplicationTrans"
                                   nbInput status="success" type="text" readonly>
                        </ng-template>
                    </div>

                    <div class="form-group">
                        <label for="dateOfApplicationTrans">Next Review Date Translation </label>
                        <ng-container *ngIf="BSReview; else reviewDateEnglish">
                            <input class="form-control dateTranslationCustom"
                                   formControlName="nextReviewDateNepaliTrans" fullWidth id="nextReviewDateNepaliTrans"
                                   nbInput status="success" type="text" readonly>
                        </ng-container>
                        <ng-template #reviewDateEnglish>
                            <input class="form-control dateTranslationCustom" formControlName="nextReviewDateTrans"
                                   fullWidth id="nextReviewDateTrans"
                                   nbInput status="success" type="text" readonly>
                        </ng-template>
                    </div>

                    <div class="form-group" *ngIf="!isCustomerNew">
                        <label for="previousSanctionDateTrans">Previous Sanction Letter Date Translation </label>
                        <ng-container *ngIf="BSPrevious; else previousLetterEnglish">
                            <input class="form-control dateTranslationCustom"
                                   formControlName="previousSanctionDateNepaliTrans" fullWidth
                                   id="previousSanctionDateNepaliTrans"
                                   nbInput status="success" type="text" readonly>
                        </ng-container>
                        <ng-template #previousLetterEnglish>
                            <input class="form-control dateTranslationCustom"
                                   formControlName="previousSanctionDateTrans" fullWidth id="previousSanctionDateTrans"
                                   nbInput status="success" type="text" readonly>
                        </ng-template>
                    </div>

                    <div class="form-group">
                        <label for="purposeOfLoanTrans">Purpose of Loan Translation </label>
                        <input class="form-control" formControlName="purposeOfLoanTrans" fullWidth
                               id="purposeOfLoanTrans"
                               nbInput status="success" type="text" readonly>
                    </div>
                    <!--
                                        <div class="form-group">
                                            <label for="loanAmountFigureTrans">Loan Amount Figure Translation </label>
                                            <input (input)="getNumAmountWord('loanAmountFigure', 'loanAmountFigureWords')" class="form-control" formControlName="loanAmountFigureTrans" fullWidth
                                                   id="loanAmountFigureTrans"
                                                   nbInput status="success" type="text" readonly>
                                        </div>

                                        <div class="form-group">
                                            <label for="loanAmountFigureWordsTrans">Loan Amount In Words Translation </label>
                                            <input class="form-control" formControlName="loanAmountFigureWordsTrans" fullWidth id="loanAmountFigureWordsTrans"
                                                   nbInput status="success" type="text" readonly>
                                        </div>-->

                    <div class="form-group">
                        <label for="marginInPercentageTrans">Margin In Percentage Translation </label>
                        <input class="form-control" formControlName="marginInPercentageTrans" fullWidth
                               id="marginInPercentageTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div class="form-group">
                        <label for="baseRateTrans">Base Rate Translation </label>
                        <input class="form-control" formControlName="baseRateTrans" fullWidth id="baseRateTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div class="form-group">
                        <label for="premiumRateTrans">Premium Rate Translation </label>
                        <input class="form-control" formControlName="premiumRateTrans" fullWidth id="premiumRateTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div class="form-group">
                        <label for="interestRateTrans">Interest Rate (%) Translation </label>
                        <input class="form-control" formControlName="interestRateTrans" fullWidth id="interestRateTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div *ngIf="!isInterestSubsidy" class="form-group">
                        <label for="serviceChargeTrans">Service Charge Translation </label>
                        <input class="form-control" formControlName="serviceChargeTrans" fullWidth
                               id="serviceChargeTrans"
                               nbInput readonly status="success" type="text">
                    </div>

                    <div class="form-group">
                        <label for="totalTenureOfLoanTrans">Total Tenure Of Loan Translation </label>
                        <input class="form-control" formControlName="totalTenureOfLoanTrans" fullWidth
                               id="totalTenureOfLoanTrans"
                               nbInput readonly status="success" type="text">
                    </div>

                    <div class="form-group" *ngIf="!isInterestSubsidy">
                        <label for="commitmentFeeTrans">Total Commitment Fee (%) Translation </label>
                        <input class="form-control" formControlName="commitmentFeeTrans" fullWidth
                               id="commitmentFeeTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div class="form-group" *ngIf="isInterestSubsidy">
                        <label for="circularRateTrans">Rate As Per NRB Circular Translation </label>
                        <input class="form-control" formControlName="circularRateTrans" fullWidth id="circularRateTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div class="form-group">
                        <label for="nameOfStaffTrans">Name of ARO/RO/RM/ARM Translation </label>
                        <input class="form-control" formControlName="nameOfStaffTrans" fullWidth id="nameOfStaffTrans"
                               nbInput status="success" type="text" readonly>
                    </div>

                    <div class="form-group">
                        <label for="nameOfBranchManagerTrans">Name Of Branch Manager Translation </label>
                        <input class="form-control" formControlName="nameOfBranchManagerTrans" fullWidth
                               id="nameOfBranchManagerTrans"
                               nbInput status="success" type="text" readonly>
                    </div>
                </div>
                <!-- END OF THE TRANSLATION FIELDS -->

                <!-- CORRECTION TRANSLATION OF MAIN FIELDS -->
                <div class="col-md-4">
                    <div class="col-md-12 mb-2 text-center">
                        <h5>CORRECTION TRANSLATION</h5>
                    </div>
                    <div class="form-group" *ngIf="BSApproval; else approvalDateCT">
                        <label for="dateOfApprovalNepaliCT">Date of Approval CT</label>
                        <input class="form-control dateTranslationCustom" formControlName="dateOfApprovalNepaliCT"
                               fullWidth id="dateOfApprovalNepaliCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.dateOfApprovalNepaliCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.dateOfApprovalNepaliCT.invalid" class="text-danger">
                            Date of Approval is required
                        </span>
                    </div>

                    <ng-template #approvalDateCT>
                        <div class="form-group">
                            <label for="dateOfApprovalCT">Date of Approval CT</label>
                            <input class="form-control dateTranslationCustom" formControlName="dateOfApprovalCT"
                                   fullWidth id="dateOfApprovalCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.dateOfApprovalCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.dateOfApprovalCT.invalid" class="text-danger">
                                Date of Approval is required
                            </span>
                        </div>
                    </ng-template>

                    <div class="form-group">
                        <label for="dateOfApplicationCT">Date of Application CT</label>
                        <ng-container *ngIf="BSApplication ; else appDateCT">
                            <input class="form-control dateTranslationCustom"
                                   formControlName="dateOfApplicationNepaliCT" fullWidth id="dateOfApplicationNepaliCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.dateOfApplicationNepaliCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.dateOfApplicationNepaliCT.invalid"
                                  class="text-danger">
                                Date of Application is required
                            </span>
                        </ng-container>
                        <ng-template #appDateCT>
                            <input class="form-control dateTranslationCustom" formControlName="dateOfApplicationCT"
                                   fullWidth id="dateOfApplicationCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.dateOfApplicationCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.dateOfApplicationCT.invalid" class="text-danger">
                               Date of Application is required
                            </span>
                        </ng-template>
                    </div>

                    <div class="form-group">
                        <label for="nextReviewDateCT">Next Review Date CT</label>
                        <ng-container *ngIf="BSReview ; else nextReviewDateCT">
                            <input class="form-control dateTranslationCustom" formControlName="nextReviewDateNepaliCT"
                                   fullWidth id="nextReviewDateNepaliCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.nextReviewDateNepaliCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.nextReviewDateNepaliCT.invalid" class="text-danger">
                                Next Review Date is required
                            </span>
                        </ng-container>
                        <ng-template #nextReviewDateCT>
                            <input class="form-control dateTranslationCustom" formControlName="nextReviewDateCT"
                                   fullWidth id="nextReviewDateCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.nextReviewDateCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.nextReviewDateCT.invalid" class="text-danger">
                               Next Review Date is Required
                            </span>
                        </ng-template>
                    </div>

                    <div class="form-group" *ngIf="!isCustomerNew">
                        <label for="previousSanctionDateCT">Previous Sanction Letter Date CT</label>
                        <ng-container *ngIf="BSPrevious; else previousDateCT">
                            <input class="form-control dateTranslationCustom"
                                   formControlName="previousSanctionDateNepaliCT" fullWidth
                                   id="previousSanctionDateNepaliCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.previousSanctionDateNepaliCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.previousSanctionDateNepaliCT.invalid"
                                  class="text-danger">
                                Previous Sanction Letter Date is required
                            </span>
                        </ng-container>
                        <ng-template #previousDateCT>
                            <input class="form-control dateTranslationCustom" formControlName="previousSanctionDateCT"
                                   fullWidth id="previousSanctionDateCT"
                                   nbInput status="success"
                                   [ngClass]="{ 'is-invalid':submitted && FormControls.previousSanctionDateCT.errors }"
                                   type="text">
                            <span *ngIf="submitted && FormControls.previousSanctionDateCT.invalid" class="text-danger">
                                Previous Sanction Letter Date is required
                            </span>
                        </ng-template>
                    </div>

                    <div class="form-group">
                        <label for="purposeOfLoanCT">Purpose of Loan CT</label>
                        <input class="form-control" formControlName="purposeOfLoanCT" fullWidth id="purposeOfLoanCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.purposeOfLoanCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.purposeOfLoanCT.invalid" class="text-danger">
                            Purpose of Loan is required
                        </span>
                    </div>

                    <!--<div class="form-group">
                        <label for="loanAmountFigureCT">Loan Amount Figure CT</label>
                        <input (input)="getNumAmountWord('loanAmountFigure', 'loanAmountFigureWords')" class="form-control" formControlName="loanAmountFigureCT" fullWidth
                               id="loanAmountFigureCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.loanAmountFigureCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.loanAmountFigureCT.invalid" class="text-danger">
                            Loan Amount Figure is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="loanAmountFigureWordsCT">Loan Amount In Words CT</label>
                        <input class="form-control" formControlName="loanAmountFigureWordsCT" fullWidth id="loanAmountFigureWordsCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.loanAmountFigureWordsCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.loanAmountFigureWordsCT.invalid" class="text-danger">
                            Loan Amount In Words is required
                        </span>
                    </div>-->

                    <div class="form-group">
                        <label for="marginInPercentageCT">Margin In Percentage CT</label>
                        <input class="form-control" formControlName="marginInPercentageCT" fullWidth
                               id="marginInPercentageCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.marginInPercentageCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.marginInPercentageCT.invalid" class="text-danger">
                            Margin In Percentage is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="baseRateCT">Base Rate CT</label>
                        <input class="form-control" formControlName="baseRateCT" fullWidth id="baseRateCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.baseRateCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.baseRateCT.invalid" class="text-danger">
                            Base Rate is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="premiumRateCT">Premium Rate CT</label>
                        <input class="form-control" formControlName="premiumRateCT" fullWidth id="premiumRateCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.premiumRateCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.premiumRateCT.invalid" class="text-danger">
                            Premium Rate is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="interestRateCT">Interest Rate (%) CT</label>
                        <input class="form-control" formControlName="interestRateCT" fullWidth id="interestRateCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.interestRateCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.interestRateCT.invalid" class="text-danger">
                            Interest Rate is required
                        </span>
                    </div>

                    <div *ngIf="!isInterestSubsidy" class="form-group">
                        <label for="serviceChargeCT">Service Charge CT</label>
                        <input [ngClass]="{ 'is-invalid':submitted && FormControls.serviceChargeCT.errors }"
                               class="form-control" formControlName="serviceChargeCT" fullWidth
                               id="serviceChargeCT" nbInput
                               status="success"
                               type="text">
                        <span *ngIf="submitted && FormControls.serviceChargeCT.invalid" class="text-danger">
                            Service Charge is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="totalTenureOfLoanCT">Total Tenure Of Loan CT</label>
                        <input class="form-control" formControlName="totalTenureOfLoanCT" fullWidth
                               id="totalTenureOfLoanCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.totalTenureOfLoanCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.totalTenureOfLoanCT.invalid" class="text-danger">
                            Total Tenure Of Loan is required
                        </span>
                    </div>

                    <div class="form-group" *ngIf="!isInterestSubsidy">
                        <label for="commitmentFeeCT">Total Commitment Fee (%) CT</label>
                        <input class="form-control" formControlName="commitmentFeeCT" fullWidth id="commitmentFeeCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.commitmentFeeCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.commitmentFeeCT.invalid" class="text-danger">
                            Total Commitment Fee is required
                        </span>
                    </div>

                    <div class="form-group" *ngIf="isInterestSubsidy">
                        <label for="circularRateCT">Rate As Per NRB Circular CT</label>
                        <input class="form-control" formControlName="circularRateCT" fullWidth id="circularRateCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.circularRateCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.circularRateCT.invalid" class="text-danger">
                            Rate As Per NRB Circular is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="nameOfStaffCT">Name of ARO/RO/RM/ARM CT</label>
                        <input class="form-control" formControlName="nameOfStaffCT" fullWidth id="nameOfStaffCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.nameOfStaffCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.nameOfStaffCT.invalid" class="text-danger">
                            >Name of ARO is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label for="nameOfBranchManagerCT">Name Of Branch Manager CT</label>
                        <input class="form-control" formControlName="nameOfBranchManagerCT" fullWidth
                               id="nameOfBranchManagerCT"
                               nbInput status="success"
                               [ngClass]="{ 'is-invalid':submitted && FormControls.nameOfBranchManagerCT.errors }"
                               type="text">
                        <span *ngIf="submitted && FormControls.nameOfBranchManagerCT.invalid" class="text-danger">
                            Name Of Branch Manager is required
                        </span>
                    </div>
                </div>
                <!-- END OF CORRECTION TRANSLATION SECTION-->
            </div>
            <div class="row pt-5 pb-2 pr-4">
                <div class="col-md-12 text-right">
                    <button nbButton outline size="small" status="info" (click)="translateAndSetVal()">
                        Translate Template Details
                    </button>
                </div>
            </div>
            <hr>
            <ng-container *ngIf="isCollateral">
                <div class="row">
                    <div class="col-md-12 pr-4">
                        <button (click)="addDefaultSecurity()" class="float-right" nbButton size="tiny"
                                status="primary">Add
                            Securities
                        </button>
                    </div>
                </div>
                <div *ngFor="let securityData of kisanKarjaSubsidy.get('securities')['controls']; let i = index; "
                     class="row p-4" formArrayName="securities">
                    <ng-container [formGroupName]="i">
                        <div class="col-md-12">
                            <h5>{{i + 1}}. Security Details</h5>
                        </div>
                        <div class="col-md-4 mt-3">
                            <div class="form-group mt-4">
                                <label for="securityOwnersName">Property Owner Name</label>
                                <input class="form-control" formControlName="securityOwnersName" fullWidth
                                       (input)="onChangeTranslateSecurity('securities', 'securityOwnersName', i, 'securityOwnersNameTrans')"
                                       id="securityOwnersName"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersDistrict{{i}}">District (जिल्ला)</label>
                                <select (change)="getMunicipalityByDistrict(kisanKarjaSubsidy.get(['securities', i, 'securityOwnersDistrict'])?.value?.id, $event, i); setDefaultNepaliResponse('securities', 'securityOwnersDistrict', i, 'securityOwnersDistrictTrans')"
                                        class="custom-select"
                                        formControlName="securityOwnersDistrict" id="securityOwnersDistrict{{i}}"
                                        name="securityOwnersDistrict{{i}}">
                                    <option [ngValue]="null" hidden>District</option>
                                    <option *ngFor="let district of allDistrictList"
                                            [ngValue]="district">{{district.name}} || {{district.nepaliName}}</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersMunicipality{{i}}">Municipality (नगर/गा.वि.स.)</label>
                                <div class="row">
                                    <div class="col-md-4">
                                        <select class="form-control" formControlName="securityOwnersMunicipalityOrVdc"
                                                (ngModelChange)="clearSecurityMunType('securityOwnersMunicipality', i, 'securities')"
                                                name="securityOwnersMunicipalityOrVdc">
                                            <option hidden value="null">Municipality or VDC</option>
                                            <option value="Municipality">Municipality</option>
                                            <option value="VDC">VDC</option>
                                            <option value="Rural">Rural</option>
                                        </select>
                                    </div>

                                    <div class="col-md-8" *ngIf="kisanKarjaSubsidy.get(['securities', i, 'securityOwnersMunicipalityOrVdc']).value  &&
                                    kisanKarjaSubsidy.get(['securities', i, 'securityOwnersMunicipalityOrVdc']).value === 'VDC'">
                                        <input (input)="onChangeTranslateSecurity('securities', 'securityOwnersMunicipality', i, 'securityOwnersMunicipalityTrans')"
                                               class="form-control" formControlName="securityOwnersMunicipality"
                                               fullWidth
                                               id="securityOwnersMunicipality"
                                               nbInput status="success" type="text">
                                    </div>

                                    <div *ngIf="kisanKarjaSubsidy.get(['securities', i, 'securityOwnersMunicipalityOrVdc']).value && kisanKarjaSubsidy.get(['securities', i, 'securityOwnersMunicipalityOrVdc']).value !== 'VDC'"
                                         class="col-md-8">
                                        <select (change)="setDefaultNepaliResponse('securities', 'securityOwnersMunicipality', i, 'securityOwnersMunicipalityTrans')"
                                                class="custom-select"
                                                formControlName="securityOwnersMunicipality"
                                                [compareWith]="compareFn"
                                                id="securityOwnersMunicipality{{i}}"
                                                name="securityOwnersMunicipality{{i}}">
                                            <option [ngValue]="null" hidden>Municipality</option>
                                            <option *ngFor="let municipalityVal of municipalityListForSecurities[i]"
                                                    [ngValue]="municipalityVal">
                                                {{municipalityVal.name}} || {{municipalityVal.nepaliName}}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>


                            <div class="form-group">
                                <label for="securityOwnersWardNo">Ward No</label>
                                <input class="form-control" formControlName="securityOwnersWardNo" fullWidth
                                       id="securityOwnersWardNo"
                                       (input)="translateSecurityDetailsNumberFields('securities', 'securityOwnersWardNo', i, 'securityOwnersWardNoTrans')"
                                       nbInput status="success" type="number">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersPlotNo">Plot Number</label>
                                <input class="form-control" formControlName="securityOwnersPlotNo" fullWidth
                                       id="securityOwnersPlotNo"
                                       (input)="onChangeTranslateSecurity('securities', 'securityOwnersPlotNo', i, 'securityOwnersPlotNoTrans')"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersLandArea">Area with Units</label>
                                <input class="form-control" formControlName="securityOwnersLandArea" fullWidth
                                       id="securityOwnersLandArea"
                                       (input)="onChangeTranslateSecurity('securities', 'securityOwnersLandArea', i, 'securityOwnersLandAreaTrans')"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersSheetNo">Sheet Number</label>
                                <input class="form-control" formControlName="securityOwnersSheetNo" fullWidth
                                       id="securityOwnersSheetNo"
                                       (input)="translateSecurityDetailsNumberFields('securities', 'securityOwnersSheetNo', i, 'securityOwnersSheetNoTrans')"
                                       nbInput status="success" type="text">
                            </div>
                        </div>
                        <!-- TRANSLATION FIELD FOR SECURITY -->
                        <div class="col-md-4 mt-3">
                            <div class="form-group mt-4">
                                <label for="securityOwnersNameTrans">Property Owner Name</label>
                                <input class="form-control" formControlName="securityOwnersNameTrans" fullWidth
                                       id="securityOwnersNameTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersDistrictTrans">District (जिल्ला)</label>
                                <input class="form-control" formControlName="securityOwnersDistrictTrans" fullWidth
                                       id="securityOwnersDistrictTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersMunicipalityTrans">Municipality (नगर/गा.वि.स.)</label>
                                <input class="form-control" formControlName="securityOwnersMunicipalityTrans" fullWidth
                                       id="securityOwnersMunicipalityTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>


                            <div class="form-group">
                                <label for="securityOwnersWardNoTrans">Ward No</label>
                                <input class="form-control" formControlName="securityOwnersWardNoTrans" fullWidth
                                       id="securityOwnersWardNoTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersPlotNoTrans">Plot Number</label>
                                <input class="form-control" formControlName="securityOwnersPlotNoTrans" fullWidth
                                       id="securityOwnersPlotNoTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersLandAreaTrans">Area with Units</label>
                                <input class="form-control" formControlName="securityOwnersLandAreaTrans" fullWidth
                                       id="securityOwnersLandAreaTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersSheetNoTrans">Sheet Number</label>
                                <input class="form-control" formControlName="securityOwnersSheetNoTrans" fullWidth
                                       id="securityOwnersSheetNoTrans"
                                       nbInput status="success" type="text" readonly>
                            </div>
                        </div>
                        <!-- END OF TRANSLATION FIELD FOR SECURITY -->

                        <!-- START OF CT FIELDS SECTION -->
                        <div class="col-md-4 mt-3">
                            <div class="form-group mt-4">
                                <label for="securityOwnersNameCT">Property Owner Name</label>
                                <input class="form-control" formControlName="securityOwnersNameCT" fullWidth
                                       id="securityOwnersNameCT"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersDistrictCT">District (जिल्ला)</label>
                                <input class="form-control" formControlName="securityOwnersDistrictCT" fullWidth
                                       id="securityOwnersDistrictCT"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersMunicipalityCT">Municipality (नगर/गा.वि.स.)</label>
                                <input class="form-control" formControlName="securityOwnersMunicipalityCT" fullWidth
                                       id="securityOwnersMunicipalityCT"
                                       nbInput status="success" type="text">
                            </div>


                            <div class="form-group">
                                <label for="securityOwnersWardNoCT">Ward No</label>
                                <input class="form-control" formControlName="securityOwnersWardNoCT" fullWidth
                                       id="securityOwnersWardNoCT"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersPlotNoCT">Plot Number</label>
                                <input class="form-control" formControlName="securityOwnersPlotNoCT" fullWidth
                                       id="securityOwnersPlotNoCT"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersLandAreaCT">Area with Units</label>
                                <input class="form-control" formControlName="securityOwnersLandAreaCT" fullWidth
                                       id="securityOwnersLandAreaCT"
                                       nbInput status="success" type="text">
                            </div>

                            <div class="form-group">
                                <label for="securityOwnersSheetNoCT">Sheet Number</label>
                                <input class="form-control" formControlName="securityOwnersSheetNoCT" fullWidth
                                       id="securityOwnersSheetNoCT"
                                       nbInput status="success" type="text">
                            </div>
                        </div>
                        <!-- END OF CT FIELDS SECTION-->
                        <div *ngIf="kisanKarjaSubsidy.get('securities')['length'] > 1" class="col-md-12 text-right">
                            <button (click)="removeSecurityDetails(i)" nbButton size="small" status="danger"
                                    style="position: static">
                                <em class="fa fa-trash" style="color: white;"></em>
                            </button>
                        </div>
                    </ng-container>
                    <hr *ngIf="kisanKarjaSubsidy.get('securities')['length'] > 1">
                </div>
            </ng-container>
        </form>
        <app-required-legal-document-section #requiredLegalDocument [initialInformation]="initialInformation"></app-required-legal-document-section>
    </nb-card-body>
    <nb-card-footer>
        <div class="row d-flex justify-content-end">
            <div class="col-md-12 text-right pr-4">
                <button (click)="openCloseTemplate(confirm)" [disabled]="!closeEnable" class="float-right" nbButton
                        size="small"
                        status="info" style="margin-right: 0.5em">
                    Close
                </button>
                <button (click)="openModal()" [disabled]="!isPreview" class="float-right" nbButton size="small"
                        status="primary">
                    Preview
                </button>
                <button (click)="submit()" [disabled]="!saveEnable" nbButton size="small" status="success"
                        type="submit">
                    Save
                </button>
            </div>
        </div>
    </nb-card-footer>
</nb-card>
<ng-template #confirm>
    <div class="modal-header" style="padding-left: 90%">
        <a (click)="dismiss(confirm)" aria-label="Close" class="close pull-right cursor">
            <span aria-hidden="true">&times;</span>
        </a>
    </div>
    <div class="modal-body" style="text-align:center; font-size: 18px">
        Are you sure you want to close ?
    </div>
    <div class="modal-footer">
        <button (click)="dismiss(confirm)" class="btn btn-danger" type="button">No</button>
        <button (click)="accept()" class="btn btn-primary" type="button">Yes</button>
    </div>
</ng-template>
